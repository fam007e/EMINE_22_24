/*
 text 2.0.15 Copyright jQuery Foundation and other contributors.
 Released under MIT license, http://github.com/requirejs/text/LICENSE
 RequireJS i18n 2.0.6 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/requirejs/i18n for details
*/
(function(){function b(a,b,c,d,X,A){b[a]&&(c.push(a),!0!==b[a]&&1!==b[a]||d.push(X+a+"/"+A))}function c(a,b,c,d,X){b=d+b+"/"+X;require._fileExists(a.toUrl(b+".js"))&&c.push(b)}function a(b,c,d){for(var l in c)!c.hasOwnProperty(l)||b.hasOwnProperty(l)&&!d?"object"===typeof c[l]&&(!b[l]&&c[l]&&(b[l]={}),a(b[l],c[l],d)):b[l]=c[l]}var d=/(^.*(^|\/)nls(\/|$))([^\/]*)\/?([^\/]*)/;define("i18n",["module"],function(g){var n=g.config?g.config():{};return{version:"2.0.6",load:function(p,l,g,A){A=A||{};A.locale&&
(n.locale=A.locale);var f=d.exec(p),q=f[1],e=f[4],t=f[5],k=e.split("-"),v=[],Y={},P,T="";f[5]?(q=f[1],p=q+t):(t=f[4],e=n.locale,e||(e=n.locale="undefined"===typeof navigator?"root":(navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage||"root").toLowerCase()),k=e.split("-"));if(A.isBuild){v.push(p);c(l,"root",v,q,t);for(P=0;P<k.length;P++)A=k[P],T+=(T?"-":"")+A,c(l,T,v,q,t);l(v,function(){g()})}else l([p],function(c){var d=[],e;b("root",c,d,v,q,t);for(P=0;P<k.length;P++)e=
k[P],T+=(T?"-":"")+e,b(T,c,d,v,q,t);l(v,function(){var b,e,p;for(b=d.length-1;-1<b&&d[b];b--){p=d[b];e=c[p];if(!0===e||1===e)e=l(q+p+"/"+t);a(Y,e)}g(Y)})})}}})})();define("assignments/js/nls/strings",{root:!0,"zh-cn":!0,ja:!0,es:!0});
define("assignments/js/nls/root/strings",{assignmentNavigation:{alertTitle:"Page Loading",alertBody:"This page appears to be taking longer than expected to finish loading. Sorry for the inconvenience. This dialog will close automatically once loading is complete.",alertDone:"Keep Waiting"},advancedPolicyEnabledShowLaunchPage:"The launch page must be displayed when an activity has Advanced Policies. ",proctoredSignInEnabledShowLaunchPage:"The launch page must be displayed when an activity requires a proctor to sign-in to start.",
proctoredBrowserEnabledShowLaunchPage:"The launch page must be displayed when an activity requires Proctored Browser Mode.",advancedPolicyEnabledMaxAttempts:"This activity has Advanced Policies that may override the Maximum Attempts property."});
define("text",["module"],function(b){function c(a,b){return void 0===a||""===a?b:a}var a,d,g,n,p,l=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],X=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,A=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,f="undefined"!==typeof location&&location.href,q=f&&location.protocol&&location.protocol.replace(/\:/,""),e=f&&location.hostname,t=f&&(location.port||void 0),k={},v=b.config&&b.config()||{};a={version:"2.0.15",strip:function(a){if(a){a=a.replace(X,
"");var b=a.match(A);b&&(a=b[1])}else a="";return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:v.createXhr||function(){var a,b,c;if("undefined"!==typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!==typeof ActiveXObject)for(b=0;3>b;b+=1){c=l[b];try{a=new ActiveXObject(c)}catch(d){}if(a){l=
[c];break}}return a},parseName:function(a){var b,c,d=!1,e=a.lastIndexOf(".");b=0===a.indexOf("./")||0===a.indexOf("../");-1!==e&&(!b||1<e)?(b=a.substring(0,e),c=a.substring(e+1)):b=a;a=c||b;e=a.indexOf("!");-1!==e&&(d="strip"===a.substring(e+1),a=a.substring(0,e),c?c=a:b=a);return{moduleName:b,ext:c,strip:d}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(b,e,d,p){var f,l;l=a.xdRegExp.exec(b);if(!l)return!0;b=l[2];f=l[3];f=f.split(":");l=f[1];f=f[0];if((d=(!b||b===e)&&(!f||f.toLowerCase()===
d.toLowerCase()))&&!(d=!l&&!f))a:if(l===p)d=!0;else{if(b===e)if("http"===b){d=c(l,"80")===c(p,"80");break a}else if("https"===b){d=c(l,"443")===c(p,"443");break a}d=!1}return d},finishLoad:function(b,c,d,e){d=c?a.strip(d):d;v.isBuild&&(k[b]=d);e(d)},load:function(b,c,d,p){if(p&&p.isBuild&&!p.inlineText)d();else{v.isBuild=p&&p.isBuild;var l=a.parseName(b);p=l.moduleName+(l.ext?"."+l.ext:"");var n=c.toUrl(p),g=v.useXhr||a.useXhr;0===n.indexOf("empty:")?d():!f||g(n,q,e,t)?a.get(n,function(c){a.finishLoad(b,
l.strip,c,d)},function(a){d.error&&d.error(a)}):c([p],function(b){a.finishLoad(l.moduleName+"."+l.ext,l.strip,b,d)})}},write:function(b,c,d,e){k.hasOwnProperty(c)&&(e=a.jsEscape(k[c]),d.asModule(b+"!"+c,"define(function () { return '"+e+"';});\n"))},writeFile:function(b,c,d,e,p){c=a.parseName(c);var l=c.ext?"."+c.ext:"",f=c.moduleName+l,n=d.toUrl(c.moduleName+l)+".js";a.load(f,d,function(c){c=function(a){return e(n,a)};c.asModule=function(a,b){return e.asModule(a,n,b)};a.write(b,f,c,p)},p)}};if("node"===
v.env||!v.env&&"undefined"!==typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"])d=require.nodeRequire("fs"),a.get=function(a,b,c){try{var e=d.readFileSync(a,"utf8");"\ufeff"===e[0]&&(e=e.substring(1));b(e)}catch(p){c&&c(p)}};else if("xhr"===v.env||!v.env&&a.createXhr())a.get=function(b,c,d,e){var p=a.createXhr(),l;p.open("GET",b,!0);if(e)for(l in e)e.hasOwnProperty(l)&&p.setRequestHeader(l.toLowerCase(),e[l]);if(v.onXhr)v.onXhr(p,
b);p.onreadystatechange=function(a){if(4===p.readyState&&(a=p.status||0,399<a&&600>a?(a=Error(b+" HTTP status: "+a),a.xhr=p,d&&d(a)):c(p.responseText),v.onXhrComplete))v.onXhrComplete(p,b)};p.send(null)};else if("rhino"===v.env||!v.env&&"undefined"!==typeof Packages&&"undefined"!==typeof java)a.get=function(a,b){var c,d,e=new java.io.File(a),p=java.lang.System.getProperty("line.separator"),e=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(e),"utf-8")),l="";try{c=
new java.lang.StringBuffer;(d=e.readLine())&&d.length()&&65279===d.charAt(0)&&(d=d.substring(1));for(null!==d&&c.append(d);null!==(d=e.readLine());)c.append(p),c.append(d);l=String(c.toString())}finally{e.close()}b(l)};else if("xpconnect"===v.env||!v.env&&"undefined"!==typeof Components&&Components.classes&&Components.interfaces)g=Components.classes,n=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),p="@mozilla.org/windows-registry-key;1"in g,a.get=function(a,
b){var c,d,e,l={};p&&(a=a.replace(/\//g,"\\"));e=new FileUtils.File(a);try{c=g["@mozilla.org/network/file-input-stream;1"].createInstance(n.nsIFileInputStream),c.init(e,1,0,!1),d=g["@mozilla.org/intl/converter-input-stream;1"].createInstance(n.nsIConverterInputStream),d.init(c,"utf-8",c.available(),n.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),d.readString(c.available(),l),d.close(),c.close(),b(l.value)}catch(f){throw Error((e&&e.path||"")+": "+f);}};return a});
define("text!common/templates/loadingOverlay/loadingOverlay.html",[],function(){return'\x3cdiv class\x3d"loadingOverlay\x3c% if( fullscreen ) { %\x3e loadingOverlay-fullscreen\x3c% } %\x3e"\x3e\n\t\x3cdiv class\x3d"loadingOverlay-inner"\x3e\n\t\t\x3c% if( showSpinner ) { %\x3e\n\t\t\t\x3cdiv class\x3d"loadingOverlay-spinner"\x3e\x3c/div\x3e\n\t\t\x3c% } %\x3e\n\t\t\x3c% if( showLabel ) { %\x3e\n\t\t\t\x3cdiv class\x3d"loadingOverlay-label"\x3e\n\t\t\t\t\x3c%\x3d label %\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c% } %\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e'});
define("common/js/views/loadingOverlay/loadingOverlay",["text!common/templates/loadingOverlay/loadingOverlay.html"],function(b){return Backbone.View.extend({model:{showLabel:!1,showSpinner:!0,fullscreen:!1},initialize:function(c){this.template=_.template(b);this.model=_.defaults(c||{},this.model)},render:function(){this.$el.hasClass("loadingOverlay-parent")||(this.$el.append(this.template({showLabel:this.model.showLabel,showSpinner:this.model.showSpinner,label:this.model.label,fullscreen:this.model.fullscreen})),
this.$el.addClass("loadingOverlay-parent"))},remove:function(){$(".loadingOverlay",this.$el).remove();this.$el.removeClass("loadingOverlay-parent")}})});define("common/js/nls/strings",{root:!0,"zh-cn":!0,ja:!0,es:!0});
define("common/js/nls/root/strings",{alertDialog:{title:"Alert",done:"Ok"},confirmDialog:{title:"Confirm",ok:"Ok",cancel:"Cancel"},errorDialog:{title:"Error",message:"Unfortunately, an error was encountered.  If the problem persists, please contact your instructor or an administrator.",additionalInfoHeader:"Additional Information"},ajaxErrorDialog:{title:"Communication Error",message:"Unfortunately, an error was encountered while communicating with the server.  Please try again.  If the problem persists, please contact your instructor or an administrator."},
userTourTemplate:{previous:"Prev",next:"Next",opt_out:"Disable All Tours",end_tour:"End Tour",label:"Tour Step"},systemHomepage:{toggleToStudent:"Toggle to student view",toggleToInstructor:"Toggle to instructor view"}});define("text!common/templates/dialogs/alertDialog.html",[],function(){return'\x3cdiv class\x3d"modal fade" tabindex\x3d"-1" role\x3d"alertdialog"\n\taria-labelledby\x3d"alertDialogTitle" aria-describedby\x3d"alertDialogBody" aria-hidden\x3d"true"\n\tstyle\x3d"z-index: \x3c%\x3d model.priority %\x3e;"\x3e\n\t\x3cdiv class\x3d"modal-dialog"\x3e\n\t\t\x3cdiv class\x3d"modal-content"\x3e\n\t\t\t\x3cdiv class\x3d"modal-header"\x3e\n\t\t\t\t\x3cbutton type\x3d"button" class\x3d"close" data-dismiss\x3d"modal"\x3e\n\t\t\t\t\t\x3cspan aria-hidden\x3d"true"\x3e\x26times;\x3c/span\x3e\n\t\t\t\t\x3c/button\x3e\n\t\t\t\t\x3ch4 id\x3d"alertDialogTitle" class\x3d"modal-title"\x3e\x3c%\x3d model.title %\x3e\x3c/h4\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv id\x3d"alertDialogBody" class\x3d"modal-body"\x3e\n        \t\t\x3c%\x3d model.body %\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"modal-footer"\x3e\n\t\t\t\t\x3cbutton name\x3d"done" type\x3d"button" class\x3d"btn btn-primary" data-dismiss\x3d"modal"\x3e\n\t\t\t\t\t\x3c%\x3d model.done %\x3e\n\t\t\t\t\x3c/button\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e'});
define("common/js/views/dialogs/dialogButton",[],function(){return Backbone.View.extend({initialize:function(b){this.setElement(b.el);this.callback=b.callback;this.callbackScope=b.callbackScope},events:{click:"doAction"},doAction:function(){"function"==typeof this.callback&&this.callback.call(this.callbackScope)}})});
define("common/js/views/dialogs/alertDialog",["i18n!common/js/nls/strings","text!common/templates/dialogs/alertDialog.html","common/js/views/dialogs/dialogButton"],function(b,c,a){return Backbone.View.extend({tagName:"div",attributes:{"class":"dialogArea"},initialize:function(a){this.template=_.template(c);this.allowDrag=a.allowDrag?a.allowDrag:!1;"undefined"===typeof this.model.title&&(this.model.title=b.alertDialog.title);"undefined"===typeof this.model.done&&(this.model.done=b.alertDialog.done);
"undefined"===typeof this.model.priority&&(this.model.priority=9003);this.doneAction=a.doneAction;this.doneActionScope=a.doneActionScope||this},render:function(){var b=this;this.previousFocus=$(document.activeElement);$("body").append(this.el);this.$el.html(this.template({model:this.model}));var c=$(".modal",this.el).modal({backdrop:"static"}).modal("show");this.allowDrag&&($(".modal-dialog",this.el).draggable({handle:".modal-header"}),$(".modal-header",this.el).addClass("draggable"));$(c).on("hide.bs.modal",
function(){b.unrender()});MathJax.Hub.Queue(["Typeset",MathJax.Hub,$(this.el)[0]]);$(c).on("shown.bs.modal",function(){$(".btn-primary",this.el).trigger("focus")});this.doneButton=new a({el:$("button[name\x3ddone]",this.el),callback:this.doneAction,callbackScope:this.doneActionScope||this});return this},unrender:function(){this.remove();if("function"==typeof this.options.onClose)this.options.onClose();$(this.previousFocus).length&&$(this.previousFocus).trigger("focus")},setTitle:function(a){$(".modal-title",
this.el).html(a)},setBody:function(a){$(".modal-body",this.el).html(a)},setDone:function(a){$(".btn-primary",this.el).html(a)}})});
define("assignments/js/views/assignmentNavigation",["i18n!assignments/js/nls/strings","common/js/views/loadingOverlay/loadingOverlay","common/js/views/dialogs/alertDialog"],function(b,c,a){return Backbone.View.extend({model:{overlay:null,startTime:null,dialogVisible:!1,dialog:null,retryInterval:100,promptInterval:3E4,overlayInterval:5E3},render:function(){this.model.startTime=Date.now();this.checkPageLoaded()},checkPageLoaded:function(){if(pageFullyLoaded())return this.enableButtons(),null!==this.model.overlay&&
this.model.overlay.remove(),null!==this.model.dialog&&this.model.dialog.unrender(),!0;!this.model.dialogVisible&&Date.now()-this.model.startTime>this.model.promptInterval&&(this.model.dialogVisible=!0,this.model.dialog=new a({model:{title:b.assignmentNavigation.alertTitle,body:b.assignmentNavigation.alertBody,done:b.assignmentNavigation.alertDone},doneAction:function(){this.model.dialogVisible=!1;this.model.startTime=Date.now()},doneActionScope:this}),this.model.dialog.render());null===this.model.overlay&&
Date.now()-this.model.startTime>this.model.overlayInterval&&(this.model.overlay=new c({el:$("body"),fullscreen:!0}),this.model.overlay.render());setTimeout(_.bind(this.checkPageLoaded,this),this.model.retryInterval)},enableButtons:function(){$(".waitToEnable").removeClass("waitToEnable disabled");$("[data-href]").attr("href",function(){return $(this).data("href")})}})});
define("questions/slideshow/run/js/views/jplayerView",[],function(){return Backbone.View.extend({initialize:function(){this.paused=!0;this.playing=!1},render:function(){if(null==this.jplayer){this.jplayer=$('\x3cdiv class\x3d"jp-jplayer"/\x3e');$(this.el).append(this.jplayer);var b="#"+$(this.options.parent.options.parent.el).attr("id");$(this.jplayer).jPlayer({solution:"html, flash",wmode:"window",supplied:"mp3",swfPath:"lib/js/jplayer",cssSelectorAncestor:b,globalVolume:!0});var c=this;$(this.jplayer).on($.jPlayer.event.timeupdate,
function(a){if(!c.paused){var b=a.jPlayer.status.currentTime,g=c.model.get("duration");a=a.jPlayer.status.duration;if(0<a&&0<g){var n=c.model.get("offset");a<g&&console.error("Duration too long",g,n);b-=n;b<=g?c.options.parent.showTime(b):(c.pause(),c.endOfTime())}}});$(this.jplayer).on($.jPlayer.event.ended,function(){c.endOfTime()});$(this.jplayer).on($.jPlayer.event.playing,function(a){c.playing=!a.jPlayer.status.paused});this.loadSlideAudio(0,!1)}},pause:function(){this.paused=!0;$(this.jplayer).jPlayer("pause")},
play:function(){this.paused=!1;$(this.jplayer).jPlayer("pauseOthers");$(this.jplayer).jPlayer("play")},playTime:function(b,c){var a=this.model.get("offset"),d=this;d.playing=!1;b<=this.model.get("duration")?(this.paused=!1,$(this.jplayer).jPlayer("play",b+a),c?this.pause():setTimeout(function(){d.playing||d.options.parent.showPaused()},400)):(this.pause(),this.endOfTime())},loadSlideAudio:function(){var b=this.model.get("audio"),c=this.model.get("duration");null!=b&&0<c&&($(this.jplayer).jPlayer("clearMedia"),
$(this.jplayer).jPlayer("setMedia",b))},endOfTime:function(){this.options.parent.endOfTime()}})});
define("questions/slideshow/run/js/views/noAudioTimerView",[],function(){return Backbone.View.extend({initialize:function(){this.currentTime=0;this.tickTime=null!=this.options&&null!=this.options.tick?this.options.tickTime:.25},pause:function(){window.clearTimeout(this.timeout);this.timeout=null},play:function(){var b=this;null==this.timeout&&(this.timeout=setInterval(function(){b.currentTime+=b.tickTime;b.currentTime<b.model.get("duration")?b.options.parent.showTimeFromTimer(b.currentTime):(b.pause(),
b.options.parent.endOfTime())},1E3*b.tickTime))},playTime:function(b,c){this.currentTime=b;c||this.play()}})});
define("questions/slideshow/run/js/views/timedElementView",[],function(){return Backbone.View.extend({initialize:function(){this.el=this.model.el},render:function(){},showTransition:function(b,c){if(null!=b){var a=this.model.get("transitionClasses"),a=_.findWhere(a,{transition:b.get("id")});null!=a&&this.applyTransitionClasses(a,c)}},applyTransitionClasses:function(b,c){$(this.el).attr("class",b.classes)},pause:function(){},play:function(){}})});
define("questions/slideshow/run/js/views/timedVideoElementView",["./timedElementView"],function(b){return b.extend({initialize:function(c){b.prototype.initialize.call(this,c);this.paused=!1},applyTransitionClasses:function(c,a){b.prototype.applyTransitionClasses.call(this,c,a);void 0===a&&(a=0);void 0===c.playTime&&(c.playTime=0);var d=c.playTime;c.playing?(d+=a,this.options.scrubberView.isPaused()||(!this.el.loop&&d>this.el.duration?this.el.pause():this.options.scrubberView.isPlayVisible()||this.el.play())):
this.el.pause();var g=1;this.options.scrubberView.isScrubbing()&&(g=0);(this.el.loop||d<this.el.duration)&&Math.abs(this.el.currentTime-d%this.el.duration)>g?this.el.currentTime=d%this.el.duration:!this.el.loop&&d>this.el.duration&&(this.el.currentTime=this.el.duration);this.lastTransitionClasses=c},pause:function(){b.prototype.pause.call(this);this.el.pause()},play:function(){b.prototype.play.call(this);this.lastTransitionClasses.playing&&!this.paused&&this.el.play()}})});
define("questions/slideshow/common/js/models/transition",[],function(){return Backbone.Model.extend({initialize:function(b){}})});define("questions/slideshow/common/js/collections/transitions",["../models/transition"],function(b){return Backbone.Collection.extend({model:b})});
define("questions/slideshow/common/js/models/timing",[],function(){return Backbone.Model.extend({initialize:function(b){},addAddClass:function(b){this.addToAttribute("addClass",b)},addRemoveClass:function(b){this.addToAttribute("removeClass",b)},addToAttribute:function(b,c){var a=this.get(b);null==a||""==a?this.set(b,c):this.set(b,a+" "+c)}})});define("questions/slideshow/common/js/collections/timings",["../models/timing"],function(b){return Backbone.Collection.extend({model:b})});
define("questions/slideshow/common/js/models/timedElement",["../collections/timings","../models/timing"],function(b,c){return Backbone.Model.extend({initialize:function(a){this.el=a.el;var d=$(this.el).data("timing");this.timings=new b(d);d=this.getInOut();if(0<d.markerIn){$(this.el).addClass("hidden");var g=this.findTiming(d.markerIn);if(null!=g){var n=g.get("removeClass");0>n.indexOf("hidden")&&g.set("removeClass",n+" hidden")}else g=new c({marker:d.markerIn,removeClass:"hidden"}),this.timings.push(g)}-1<
d.markerOut&&(g=this.findTiming(d.markerOut),null!=g?(d=g.get("addClass"),0>d.indexOf("hidden")&&g.set("addClass",d+" hidden")):(g=new c({marker:d.markerOut,addClass:"hidden"}),this.timings.push(g)));this.findCssTimings();var p=this.findTiming(0);this.applyTiming(p,null);d=$(this.el).attr("class");g=[this.getCurTransitionClasses(null)];for(n=1;n<a.transitions.size();n++){var l=a.transitions.at(n),p=this.findTiming(l.id);this.applyTiming(p,l);p=this.getCurTransitionClasses(l);g.push(p)}$(this.el).attr("class",
d);this.set("transitionClasses",g)},getCurTransitionClasses:function(a){return{transition:null!=a?a.id:0,classes:$(this.el).attr("class")}},applyTiming:function(a){null!=a&&($(this.el).addClass(a.get("addClass")),$(this.el).removeClass(a.get("removeClass")))},findTiming:function(a){var b=this.timings.findWhere({marker:Number(a)});null==b&&(b=this.timings.findWhere({marker:a}));return b},getInOut:function(a){a=/(in|out)([0-9]*)/g;for(var b=$(this.el).attr("class"),b=a.exec(b),c=$(this.el).data("in"),
n=$(this.el).data("out");null!=b;)"in"==b[1]?c=b[2]:"out"==b[1]&&(n=b[2]),b=a.exec($(this.el).attr("class"));if(void 0===c||null==c)c=-1;if(void 0===n||null==n)n=-1;return{markerIn:Number(c),markerOut:Number(n)}},findCssTimings:function(){var a=this,b=/(add|remove)([0-9]*)-(.*)/,g=$(this.el).attr("class").split(" ");_.each(g,function(n){n=b.exec(n);if(null!=n){var p=n[2],l=a.findTiming(p),g=!1;null==l&&(g=!0,l=new c({marker:p}));"add"==n[1]?l.addAddClass(n[3]):l.addRemoveClass(n[3]);g&&a.timings.push(l)}})}})});
define("questions/slideshow/common/js/models/timedVideoElement",["./timedElement"],function(b){return b.extend({initialize:function(c){this.playing=!1;this.lastTransitionTime=this.playTime=0;b.prototype.initialize.call(this,c)},getCurTransitionClasses:function(c){c=b.prototype.getCurTransitionClasses.call(this,c);c.playing=this.playing;c.playTime=this.playTime;return c},applyTiming:function(c,a){b.prototype.applyTiming.call(this,c,a);this.playing&&null!=a&&this.movePlayTime(a);if(null!=c){this.getPlay(c)&&
(this.playing=!0);this.getPause(c)&&(this.playing=!1);var d=this.getSkip(c);null!=d&&(this.playTime=d)}this.lastTransitionTime=null!=a?a.get("time"):0},movePlayTime:function(b){b=b.get("time")-this.lastTransitionTime;this.playTime+=b},getPause:function(b){return(b=b.get("videoPause"))||"true"===b},getPlay:function(b){return(b=b.get("videoPlay"))||"true"===b},getSkip:function(b){return b.get("videoSkip")}})});
define("questions/slideshow/common/js/collections/timedElements",["../models/timedElement","../models/timedVideoElement"],function(b,c){return Backbone.Collection.extend({initialize:function(a,d){var g=this;_.each(d.elements,function(a){a=new ("video"===$(a).prop("tagName").toLowerCase()?c:b)({el:a,transitions:d.transitions});g.models.push(a)})}})});
define("questions/slideshow/common/js/models/slide",["../collections/transitions","../collections/timedElements"],function(b,c){return Backbone.Model.extend({initialize:function(a){this.el=a.el;var d=$(a.el).data("marker");null===d||"undefined"===typeof d?d=[]:"string"===typeof d&&(d=[d]);d.splice(0,0,{time:0,id:0});d=_.sortBy(d,function(a){return a.time});d=new b(d);this.set("transitions",d);this.set("timedElements",new c(null,{elements:$(".timed",a.el),transitions:d}));this.set("duration",Number($(this.el).data("duration")));
this.set("offset",Number($(this.el).data("offset")));this.set("audio",this.getAudio());this.set("name",this.getName());a=$(this.el).data("preview");-2<a&&this.set("preview",a);this.set("notes",decodeURIComponent($(this.el).data("notes")));a=$(this.el).data("pause");var g=parseFloat($(this.el).data("offset"));null!=a&&0<a.toString().length?(a=a.toString().split(","),this.set("pauses",_.map(a,function(a){return parseFloat(a)-g}))):this.set("pauses",{});this.set("insessiongradable",$(this.el).data("insessiongradable"))},
getAudio:function(){var a;try{a=$(this.el).data("audio")}catch(b){try{a=JSON.parse(decodeURIComponent($(this.el).data("audio")))}catch(c){a=null}}return a},getName:function(){var a=decodeURIComponent($(this.el).data("name"));if(null==a||0==a.length)a=$("h1,h2,h3",this.el).first().text();return a}})});
define("questions/slideshow/run/js/views/slideView","require ./jplayerView ./noAudioTimerView ./timedElementView ./timedVideoElementView ../../../common/js/models/slide".split(" "),function(b,c,a,d,g){var n=b("../../../common/js/models/slide");return Backbone.View.extend({initialize:function(){this.curTransitionIndex=-1;this.lastTime=this.lastPause=0;this.finished=!1},render:function(){var b=this;this.bindChangeMathMode();this.slideNoteEl=$("\x3cdiv class\x3d'slideNote'\x3e"+this.model.get("notes")+
"\x3c/div\x3e");$(this.el).after(this.slideNoteEl);_.each($(".glossaryTermHighlight",this.el),function(a){var c=$(a).data("term");if(null!=b.options.glossary.findWhere({term:c}))$(a).on("click",function(){b.options.parent.showGlossaryTerm(c);return!1});else $(a).removeClass(".glossaryTermHighlight")});this.createTimedElementViews();if(!this.options.manualMode){var d=this.model.get("audio");null==d||"object"!=typeof d||null==d.mp3&&null==d.wav&&null==d.ogg?0<this.model.get("duration")&&(this.timer=
new a({el:this.el,model:this.model,parent:this}),this.timer.render()):(this.timer=new c({el:this.options.parent.el,model:this.model,parent:this}),this.timer.render())}},createTimedElementViews:function(){this.timedElementViews=[];var a=this;this.model.get("timedElements").each(function(b){b=new ("video"===$(b.el).prop("tagName").toLowerCase()?g:d)({model:b,scrubberView:a.options.scrubberView});b.render();a.timedElementViews.push(b)})},bindChangeMathMode:function(){var a=this;$(".changeMathMode",this.el).off("click").on("click",
function(b){return a.changeMathMode(b)})},showFirstTransition:function(){this.showTransition(0,0)},showLastTransition:function(){var a=this.getNumTransitions()-1;this.showTransition(a);0<this.model.get("duration")&&this.pause({pauseMarker:!0});return!1},showNextTransition:function(){var a=this.curTransitionIndex+1;return a<this.getNumTransitions()?(this.showTransition(a),a<this.getNumTransitions()-1||!this.model.get("lastSlide")):this.model.get("lastSlide")?!1:this.options.parent.showNextSlide()},
showPreviousTransition:function(){var a=this.curTransitionIndex-1;return 0<=a?(this.showTransition(a),0<a||!this.model.get("firstSlide")):this.model.get("firstSlide")?!1:this.options.parent.showPreviousSlide()},showTransition:function(a,b){-1==a&&(a=this.model.get("transitions").length-1);this.curTransitionIndex=a;this.clearHowDidIDoPopover();var c=this.model.get("transitions").at(a);_.each(this.timedElementViews,function(a){a.showTransition(c,b)});null!=this.options.parent&&(0!=this.model.get("duration")||
a!=this.model.get("transitions").length-1||this.options.parent.isNextTransitionAvailable()?this.autoShowPauseBar(!1,!1):this.finish())},autoShowPauseBar:function(a,b){var c=this.options.parent.pauseBarView,d=this.model.get("insessiongradable")&&$("[id^\x3dresponse\\.]",this.el).is(":visible"),f=0<$(".algorithmicVariables",this.el).length;if(0==this.model.get("duration")&&d||a||b){var n=0<this.model.get("duration")&&!b;c.show({howDidIDo:d,tryAnother:f,startOver:b,pauseMarker:n})}else c.hide()},getNumTransitions:function(){return this.model.get("transitions").length},
showTimeFromTimer:function(a){this.options.parent.scrubberView.isScrubbing()||this.showTime(a)},showTime:function(a){for(var b=this.model.get("transitions"),c=null,d=-1,f=this.model.get("offset"),n,e=0;e<b.length;e++){var g=b.at(e);a+f>=g.get("time")&&(c=g,d=e,n=a+f-g.get("time"))}null!=c&&this.showTransition(d,n);a<this.lastTime&&a<this.lastPause&&(this.lastPause=0);this.lastTime=a;this.options.parent.scrubberView.isScrubbing()||(this.options.parent.updateScrubber(a),this.handlePauses(a))},handlePauses:function(a){var b=
this;if(a>this.lastPause){var c=_.filter(this.model.get("pauses"),function(c){return c>b.lastPause&&c<=a&&c>a-.5});null!=c&&0<c.length&&(this.pause(),this.lastPause=a,setTimeout(function(){b.autoShowPauseBar(!0,!1)},100))}},show:function(){$(this.el).show();0==this.model.get("duration")?(this.options.parent.scrubberView.hide(),this.showNoAudioView()):(this.options.parent.scrubberView.show(),this.options.parent.noAudioView.hide());this.options.parent.setNotes(this.model.get("notes"))},hide:function(){$(this.el).hide();
$(this.slideNoteEl).hide();null!=this.timer&&this.timer.pause();this.pauseTimedElements()},showExpanded:function(){this.show();$(".slideNotes",this.el).show();this.beforeExpandedTransitionIndex=this.curTransitionIndex;this.showLastTransition();$(this.slideNoteEl).show()},resumeFromExpanded:function(){this.show();$(".slideNotes",this.el).hide();this.showTransition(this.beforeExpandedTransitionIndex);$(this.slideNoteEl).hide()},showNoAudioView:function(){this.options.parent.noAudioView.show(this.model.get("firstSlide"))},
playTime:function(a,b){this.show();this.showTime(a);0<this.model.get("duration")&&!this.options.parent.scrubberView.isScrubbing()&&this.timer.playTime(a,b)},pause:function(a){null!=this.timer&&(this.timer.pause(),this.options.parent.scrubberView.setPaused(!0));this.pauseTimedElements();null!=a&&(a.howDidIDo=this.model.get("insessiongradable"),this.options.parent.pauseBarView.show(a))},showPaused:function(){this.options.parent.showPaused();this.options.parent.pauseBarView.show({pauseMarker:!0})},pauseTimedElements:function(){_.each(this.timedElementViews,
function(a){a.pause()})},play:function(){null==this.timer||this.options.parent.scrubberView.isScrubbing()||this.timer.play();0<this.timedElementViews.length&&this.options.parent.pauseBarView.hide();this.options.parent.scrubberView.setPaused(!1);_.each(this.timedElementViews,function(a){a.play()})},renderMath:function(){var a=$(this.el)[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,a]);MathJax.Hub.Queue(["Rerender",MathJax.Hub,a]);mapleCloudOnLoad()},clearHowDidIDoPopover:function(){$(".insession:visible",
this.el).trigger("click")},doInSessionFeedback:function(a){var b=this.options.parent;a.target.id=$(b.el).data("slideshowid");var b=b.createSlideshowEvent("CHECKWORK").getSlideshowEventParameters(),c=this;if($(c.el).is(":visible")){$(c.el).addClass("slide-scroll");var d=function(){$(c.el).is(":visible")&&($(c.el).scrollTop(0),$(c.el).removeClass("slide-scroll"),$(c.el).find(".slide-feedback").hide())};doInSessionFeedback(a,d,b);var f=$(c.el).find(".slide-feedback");$(f).on("click",null,a.target.id,
function(a){clearHowDidIDo(a,d)});$(f).addClass("pointer");$(f).show()}doInSessionFeedback(a,function(){},b);return!1},tryAnother:function(a){this.callSlideshowRefresh(a,!1,function(a){0<$(a).filter("input[name\x3dnewVersion]").length&&$("input[name\x3dversion]").val($(a).filter("input[name\x3dnewVersion]").val())});return!1},getFormData:function(a){a=a.serializeArray();var b={};$.map(a,function(a,c){b[a.name]=a.value});return b},callSlideshowRefresh:function(a,b,c){var d=this,f=this.options.parent;
this.clearHowDidIDoPopover();readAppletItems();a=null==a?$(document.forms.edu_form):$($(a.target).parents("form")[0]);var g=this.getFormData(a);g.refreshSingleSlide=f.curSlideIndex+1;g.slideshowId=$(this.options.parent.el).data("slideshowid");g.keepRandVariableValue=b;g.indexId=$("#indexId",$(this.el).parents(".questionstyle")).val();b=f.createSlideshowEvent("TRYANOTHER").getSlideshowEventParameters();null!=b&&_.each(b,function(a,b){g[b]=a});$.ajax({type:"POST",url:getBaseURL()+"contentmanager/SlideshowRefresh.do",
data:g,dataType:"html",sync:!0,success:function(a){var b=$($(a).filter(".slide:first"));$(d.el).replaceWith(b);d.el=b;$(d.el).show();d.model=new n({el:b});d.createTimedElementViews();d.showTransition(d.curTransitionIndex);d.bindChangeMathMode();d.renderMath();MathJax.Hub.Queue(window.initQuestions);d.finished?d.finish():d.autoShowPauseBar(!0,!1);"function"===typeof c&&c(a)}})},changeMathMode:function(a){"true"!=readCookie("useMathEditor")?document.cookie="useMathEditor\x3dtrue; path\x3d"+getBaseContext()+
"/":document.cookie="useMathEditor\x3dfalse; path\x3d"+getBaseContext()+"/";destroyEditors();this.clearHowDidIDoPopover();this.callSlideshowRefresh(a,!0,null);return!1},endOfTime:function(){$(this.el).is(":visible")&&this.options.parent.showNextSlide()},finish:function(){this.finished=!0;this.pauseTimedElements();0<this.model.get("duration")&&(this.timer.pause(),this.options.parent.scrubberView.setPaused(!0),this.options.parent.updateScrubber(this.model.get("duration")),$(".finishedMessage",this.el).show());
this.autoShowPauseBar(!1,!0)},isPreviousTransitionAvailable:function(){return 0<this.curTransitionIndex},isNextTransitionAvailable:function(){return this.curTransitionIndex<this.getNumTransitions()-1}})});
define("questions/slideshow/run/js/views/scrubberView",[],function(){return Backbone.View.extend({initialize:function(){this.scrubbing=!1;this.lastPercentage=0;this.minPercentageChange=.02;this.totalTime=this.calculateTotalTime()},events:{"click .play":"play","click .pause":"pause"},render:function(){this.bindEvents();$(".duration",this.el).text(this.toMinutesSeconds(this.totalTime));this.createScrubberMarkers()},isScrubbing:function(){return this.scrubbing},bindEvents:function(){var b=this;$(".seek-bar",
this.el).on("touchstart touchmove touchend touchcancel",this.touchHandler);$(".seek-bar",this.el).on("mousedown",function(){b.startScrubbing();b.scrubberSeek(event)});$(".seek-bar",b.el).on("mousemove",function(c){b.mouseDown&&(b.startScrubbing(),b.scrubbing&&b.scrubberSeek(c,!0))});$(document).on("mousedown",function(){b.mouseDown=!0});$(document).on("mouseup",function(c){b.mouseDown=!1;b.scrubbing&&(b.scrubbing=!1,b.scrubberSeek(c,!0),b.options.parent.sendSlideshowEvent("SCRUB_END"));return!1})},
startScrubbing:function(){if(!this.scrubbing){var b=this.options.parent;this.scrubbing=!0;b.pause();b.sendSlideshowEvent("SCRUB_START")}},calculateTotalTime:function(){var b=0;_.each(this.model.models,function(c){b+=c.get("duration")});return b},hide:function(){$(this.el).fadeOut()},show:function(){$(this.el).fadeIn()},createScrubberMarkers:function(){var b=this,c=0;_.each(this.model.models,function(a){if(0<c){var d=c/b.totalTime*100,g=$("\x3ci class\x3d'marker'\x3e\x3c/i\x3e");$(g).css("left",d+
"%");$(".seek-bar",b.el).append(g)}c+=a.get("duration")})},touchHandler:function(b){var c=b.changedTouches[0],a=document.createEvent("MouseEvent");a.initMouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[b.type],!0,!0,window,1,c.screenX,c.screenY,c.clientX,c.clientY,!1,!1,!1,!1,0,null);c.target.dispatchEvent(a);b.preventDefault()},scrubberSeek:function(b,c){this.options.parent.hidePauseBar();var a=$(".seek-bar",this.el)[0],d=this.getFullOffsetLeft(a),a=a.offsetWidth;b.pageX+
d<=a+2*d&&(d=(b.pageX-d)/(a/100)*.01,d=Math.max(0,d),a=this.totalTime*d,this.updateScrubber(a),c||Math.abs(this.lastPercentage-d)>this.minPercentageChange)&&(this.options.parent.showTotalTime(a),this.lastPercentage=d)},updateScrubber:function(b){$(".current-time",this.el).text(this.toMinutesSeconds(b));b=Math.min(b/this.totalTime*100,100);$(".play-bar",this.el).css("width",b+"%");$(".playHead",this.el).css("left",b+"%")},getFullOffsetLeft:function(b){return null==b.offsetParent?b.offsetLeft:b.offsetLeft+
this.getFullOffsetLeft(b.offsetParent)},play:function(){this.options.parent.play();return!1},pause:function(){this.options.parent.pause();return!1},pad:function(b,c,a){b+="";return b.length>=c?b:Array(c-b.length+1).join(a||"0")+b},toMinutesSeconds:function(b){var c=Math.floor(b/60);b=this.pad(Math.floor(b)%60,2);return c+":"+b},setPaused:function(b){this.scrubbing||(b?($(".play",this.el).show(),$(".pause",this.el).hide()):($(".play",this.el).hide(),$(".pause",this.el).show()))},isPaused:function(){return this.isPlayVisible()&&
!this.scrubbing},isPlayVisible:function(){return $(".play",this.el).is(":visible")}})});
define("questions/slideshow/run/js/views/noAudioView",[],function(){return Backbone.View.extend({events:{"click .nextSlide":"showNextTransition","click .previousSlide":"showPreviousTransition"},render:function(){$(".numSlides",this.el).text(this.model.numSlides)},hide:function(){$(this.el).hide();this.clearKeyboardEvents()},show:function(b){$(this.el).is(":visible")||($(this.el).show(),this.bindKeyboardEvents(),b&&$(".previousSlide",this.el).prop("disabled",!0),this.options.parent.isNextTransitionAvailable()&&
$(".nextSlide",this.el).prop("disabled",!1))},showNextTransition:function(){this.options.parent.showNextTransition();this.enableButtons();return!1},showPreviousTransition:function(){this.options.parent.showPreviousTransition();this.enableButtons();return!1},enableButtons:function(){this.options.parent.isNextTransitionAvailable()?$(".nextSlide",this.el).prop("disabled",!1):$(".nextSlide",this.el).prop("disabled",!0);this.options.parent.isPreviousTransitionAvailable()?$(".previousSlide",this.el).prop("disabled",
!1):$(".previousSlide",this.el).prop("disabled",!0)},clearKeyboardEvents:function(){$(document).off("keydown");$(document).off("keyup")},bindKeyboardEvents:function(){var b=this;$(document).on("keydown",function(c){b.isInputFocused()||("39"==c.which?c.preventDefault():"37"==c.which&&c.preventDefault())});$(document).on("keyup",function(c){b.isInputFocused()||("39"==c.which?(c.preventDefault(),b.showNextTransition()):"37"==c.which&&(c.preventDefault(),b.showPreviousTransition()))})},isInputFocused:function(){var b=
document.activeElement,c=$(b).prop("tagName").toLowerCase();return"input"===c||"iframe"===c||$(b).hasClass("editor")},setSlideIndex:function(b){$(".slideNumber",this.el).text(b+1);this.enableButtons()}})});
define("questions/slideshow/run/js/views/pauseBarView",[],function(){return Backbone.View.extend({events:{"click .pauseTryAnother":"tryAnother","click .pauseInSession":"doInSessionFeedback","click .fa-repeat":"startOver","click .continue":"resume"},render:function(){this.continuescreen=$(".pauseBar",this.el)},show:function(b){null!=b&&(b.howDidIDo?$(".pauseInSession",this.el).show():$(".pauseInSession",this.el).hide(),b.tryAnother?$(".pauseTryAnother",this.el).show():$(".pauseTryAnother",this.el).hide(),
b.startOver?$(".fa-repeat, .finishedMessage",this.el).show():$(".fa-repeat, .finishedMessage",this.el).hide(),b.pauseMarker?$(".continue, .pausedMessage",this.el).show():$(".continue, .pausedMessage",this.el).hide());$(this.el).slideDown()},hide:function(){$(this.el).slideUp();$(".pauseInSession",this.el).hide();$(".pauseTryAnother",this.el).hide();$(".pausedMessage",this.el).hide();$(".continue",this.el).hide();$(".finishedMessage",this.el).hide();$(".fa-repeat",this.el).hide()},resume:function(){this.options.parent.play();
return!1},doInSessionFeedback:function(b){this.options.parent.doInSessionFeedback(b);return!1},tryAnother:function(b){this.options.parent.tryAnother(b);return!1},startOver:function(){var b=this.options.parent;b.playSlide(0,0,!1);b.sendSlideshowEvent("START");return!1}})});
define("questions/slideshow/run/js/views/navigationView",[],function(){return Backbone.View.extend({events:{"click a":"gotoSlide"},render:function(){var b=0,c=this;_.each(this.model.models,function(a){a=a.get("name");c.addNavigation(a,b++,c.totalTime)});$(this.el).on("mouseleave",function(){c.hide()});"undefined"!=typeof MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub,"navigationContainer"])},addNavigation:function(b,c,a){b='\x3cli class\x3d"outline"\x3e\x3ca href\x3d"#" rel\x3d"'+c+'" data-time\x3d"'+
a+'"\x3e'+b+"\x3c/a\x3e\x3c/li\x3e";$("ol",this.el).append(b)},gotoSlide:function(b){var c=this.options.parent.options.parent;b=parseInt($(b.currentTarget).attr("rel"));c.playSlide(b,0,!1);c.sendSlideshowEvent("MENU_NAVIGATE");return!1},show:function(b){$(this.el).slideDown()},hide:function(){$(this.el).slideUp()}})});
define("questions/slideshow/run/js/views/glossaryView",[],function(){return Backbone.View.extend({events:{},render:function(){var b=this;_.each(this.model.models,function(c){$(".glossaryContent",b.el).append("\x3ch1 data-term\x3d'"+c.get("term")+"'\x3e"+c.get("term")+"\x3c/h1\x3e").append("\x3cdiv\x3e"+c.get("entry")+"\x3c/div\x3e")})},show:function(){$(this.el).slideDown()},hide:function(){$(this.el).slideUp()},showGlossaryTerm:function(b){b=$(".glossaryContent [data-term\x3d'"+b+"']",this.el);$(".glossaryContainer",
this.el).scrollTop(0);b.length&&($(".glossaryContainer",this.el).scrollTop($(".glossaryContainer",this.el).scrollTop()+b.position().top),b.addClass("glossaryEntryFocus"),b.effect("pulsate",{times:2},3E3))},buildGlossary:function(){var b=this,c=$("span[data-term]",this.el);if(c.filter('[data-entry][data-entry!\x3d""]').length){var a=[];c.each(function(){var c=$(this);if(_.some(a,function(a){return c.data("term")===a.term}))c.on("click",function(a){b.toggleMenu("glossary");b.scrollGlossary($(a.target).data("term"))});
else c.removeClass("glossaryTermHighlight")});$(".glossaryButton",this.el).on("click",function(){$(".glossaryContainer .glossaryContent h1",b.el).removeClass("glossaryEntryFocus")});$(".glossaryButton",this.el).show()}else c=$("#glossary"),c.length&&0<c.val().length&&$(".glossaryContainer",b.el).load(c.val(),function(a,b,c){"error"!=b&&$(".glossaryButton",this.el).show()})}})});
define("questions/slideshow/run/js/views/slideNotesView",[],function(){return Backbone.View.extend({events:{},render:function(){},show:function(b){$(this.el).slideDown()},hide:function(){$(this.el).slideUp()},setNotes:function(b){$(this.el).html(b)},showNotesExpanded:function(b){var c=this.getSlideNote(b);null!==c&&$(b).after('\x3cp class\x3d"slideNote"\x3e'+c+"\x3c/p\x3e")}})});
define("questions/slideshow/run/js/views/titleBarView",["./navigationView","./glossaryView","./slideNotesView"],function(b,c,a){return Backbone.View.extend({events:{"click .notesButton":"showNotes","click .glossaryButton":"showGlossary","click .expandedButton":"showAllSlides","click .navigationButton":"showNavigation"},render:function(){0<this.options.glossary.size()&&(this.glossaryView=new c({el:$(".glossaryContainer",this.options.parent.el),parent:this,model:this.options.glossary}),this.glossaryView.render(),
$(".glossaryButton",this.el).show());this.navigationView=new b({el:$(".navigationContainer",this.options.parent.el),model:this.model,parent:this});this.navigationView.render();this.notesView=new a({el:$(".notesContainer",this.options.parent.el),parent:this});this.notesView.render()},hideChildViews:function(a){null!=this.glossaryView&&this.glossaryView.hide();this.navigationView.hide();this.notesView.hide();a||this.options.parent.collapseAllSlides()},showNotes:function(){this.showView(this.notesView)},
showGlossary:function(){this.showView(this.glossaryView)},showNavigation:function(){this.showView(this.navigationView)},showView:function(a){var b=$(a.el).is(":visible");this.hideChildViews();b||a.show()},setNotes:function(a){this.notesView.setNotes(a);0<a.length?$(".notesButton",this.el).show():(this.notesView.hide(),$(".notesButton",this.el).hide())},showAllSlides:function(){this.hideChildViews(!0);this.options.parent.toggleAllSlides()},showGlossaryTerm:function(a){this.showGlossary();this.glossaryView.showGlossaryTerm(a)}})});
define("questions/slideshow/common/js/models/slideshowAnalyticsEvent",[],function(){return Backbone.Model.extend({initialize:function(b){this.el=b.el;this.audio=b.slideModel.getAudio();this.slideDuration=Math.floor(b.slideModel.get("duration"));var c=b.slideModel;this.clear({silent:!0});var a={};a.name=c.getName();a.number=b.slideIndex+1;a.currentTime=this.getCurrentTimeInSeconds();a.duration=this.slideDuration;a.playbackMode=this.getPlaybackMode();this.set("slideDetails",a);this.set("assignmentId",
$("input[name\x3dtestId]").val());this.set("pageNumber",$("input[name\x3dcurrPage]").val());this.set("questionId",$(this.el).parents("[name\x3dquestioncontainer]").find("#indexId").val());this.set("action",b.action);this.set("duration",b.totalTime)},url:function(){return getBaseURL()+"rest/analytics/slideshow/send"},validate:function(b,c){if(null==b.slideDetails||null==b.assignmentId)return"Slideshow Analytics Event is not valid."},getCurrentQuestion:function(){var b={};if(null==this.questions)return b;
for(var c=parseInt($(this.el).parent().children("#indexId").val()),a=0;a<this.questions.length;a++){var d=this.questions[a];if(d.revisionId==c){b=$.extend(!0,{},d);break}}return b},getCurrentTimeInSeconds:function(){var b=0,c=$(".current-time",this.el).text();""!=c&&(b=c.split(":"),b=60*parseInt(b[0])+parseInt(b[1]));return b},getPlaybackMode:function(){var b="AUTO_PAUSE";null==this.audio||"object"!=typeof this.audio||null==this.audio.mp3&&null==this.audio.wav&&null==this.audio.ogg?0<this.slideDuration&&
(b="DURATION"):b="FILE";return b},getSlideshowEventParameters:function(){var b=null,c=this.get("slideDetails");null!=c&&(b={},b.slideshowDuration=this.get("duration"),b.slideName=c.name,b.slideNumber=c.number,b.slideDuration=c.duration,b.slidePlaybackMode=c.playbackMode,b.slideCurrentTime=c.currentTime);return b}})});
define("questions/slideshow/run/js/views/slideshowView","./slideView ./scrubberView ./noAudioView ./pauseBarView ./titleBarView ../../../common/js/models/slideshowAnalyticsEvent".split(" "),function(b,c,a,d,g,n){return Backbone.View.extend({events:{"click .beginbutton":"beginPlayback"},render:function(){this.scrubberView=new c({el:$(".jp-audio",this.el),parent:this,model:this.model});this.scrubberView.render();this.createSlideViews();this.totalTime=0;this.finished=!1;this.pickPreviewSlide();this.titleBarView=
new g({el:$(".header",this.el),parent:this,model:this.model,glossary:this.options.glossary});this.titleBarView.render();this.noAudioView=new a({el:$(".no-audio-controls",this.el),parent:this,model:{numSlides:this.model.size()}});this.noAudioView.render();this.pauseBarView=new d({el:$(".pauseBar",this.el),parent:this});this.pauseBarView.render();this.waitShowPreview()},createSlideViews:function(){this.slideViews=[];for(var a=this.model.size(),c=0;c<a;c++){var d=this.model.at(c);d.set("lastSlide",c==
a-1);d.set("firstSlide",0==c);d=new b({el:d.el,model:d,parent:this,glossary:this.options.glossary,scrubberView:this.scrubberView});d.render();this.slideViews.push(d)}},pickPreviewSlide:function(){var a=this.model.filter(function(a){return null!=a.get("preview")});0==a.length?(this.previewSlide=this.model.first(),this.previewSlide.set("preview",-1)):this.previewSlide=a[0]},updateScrubber:function(a){a=this.getWithinShow(a);this.scrubberView.updateScrubber(a)},getWithinShow:function(a){for(var b=0,
c=0;c<this.model.size()&&c<this.curSlideIndex;c++)var d=this.model.at(c),b=b+d.get("duration");return b+a},getCurSlideView:function(){return this.slideViews[this.curSlideIndex]},pause:function(){this.getCurSlideView().pause();this.showPaused()},showPaused:function(){this.scrubberView.isScrubbing()||this.sendSlideshowEvent("PAUSE");this.scrubberView.setPaused(!0)},play:function(){this.finished?(this.finished=!1,this.playSlide(0,0,!1)):(this.getCurSlideView().play(),this.scrubberView.setPaused(!1))},
finish:function(){this.getCurSlideView().finish();this.finished=!0;this.sendSlideshowEvent("END")},doInSessionFeedback:function(a){this.getCurSlideView().doInSessionFeedback(a)},tryAnother:function(a){this.getCurSlideView().tryAnother(a)},showBegin:function(){$(".loading",this.el).hide();$(".beginbutton",this.el).show();$(".videoContainer",this.el).show();$(".expand",this.el).show()},showTotalTime:function(a){a=Math.floor(a);for(var b=0,c=0;c<this.model.size();c++){var d=this.model.at(c).get("duration");
if(a<b+d)return this.playSlide(c,a-b,this.scrubberView.isPaused());b+=d}return null},playSlide:function(a,b,c){var d=this.slideViews[a];this.finished=!1;if(null!=d){for(var f=0;f<this.slideViews.length;f++)f!=a&&this.slideViews[f].hide();a!=this.curSlideIndex&&(this.curSlideIndex=a);d.show();-1==b?d.showLastTransition():(d.playTime(b,c),this.scrubberView.setPaused(c));this.noAudioView.setSlideIndex(a);return d}return null},showNextTransition:function(){var a=this.slideViews[this.curSlideIndex];return null!=
a?a.showNextTransition():!1},showPreviousTransition:function(){$(".fa-repeat",this.el).hide();var a=this.slideViews[this.curSlideIndex];return null!=a?a.showPreviousTransition():!1},showNextSlide:function(){var a=this.playSlide(this.curSlideIndex+1,0,!1);if(null!=a)return 1<a.model.get("transitions").length;this.finish();return!1},showPreviousSlide:function(){1<=this.curSlideIndex&&(0<this.model.at(this.curSlideIndex-1).get("duration")?(this.playSlide(this.curSlideIndex-1,0,!0),this.getCurSlideView().pause({pauseMarker:!0})):
this.playSlide(this.curSlideIndex-1,-1,!1))},setNotes:function(a){this.titleBarView.setNotes(a)},hidePauseBar:function(){this.pauseBarView.hide()},waitShowPreview:function(){var a=this;"undefined"!=typeof MathJax?MathJax.Hub.Queue(function(){setTimeout(function(){var b=parseInt($("#slideNumber").val());null!=b&&0<=b?a.showBegin():a.showPreview()},200)}):setTimeout(function(){a.waitShowPreview()},100)},showPreview:function(){var a=_.findWhere(this.slideViews,{model:this.previewSlide});a.show();for(var b=
this.previewSlide.get("preview"),c=0,d=this.previewSlide.get("transitions"),f=0;f<d.size()&&0==c;f++){var n=d.at(f);if(-1==b||n.get("id")==b)c=f}a.showTransition(c);a.pause();this.showBegin()},beginPlayback:function(){$(".startscreen",this.el).fadeOut();this.hideAllSlides();$(".controls",this.el).slideDown();$(".videoContainer",this.el).addClass("playing");var a=parseInt($("#slideNumber").val());null!=a&&0<=a?this.playSlide(a,0,!1):(this.playSlide(0,0,!1),this.play(),this.sendSlideshowEvent("START"))},
toggleAllSlides:function(){$(this.el).hasClass("expanded")?this.collapseAllSlides():this.showAllSlides()},hideAllSlides:function(){_.each(this.slideViews,function(a){a.hide()})},showAllSlides:function(){_.each(this.slideViews,function(a){a.showExpanded()});this.scrubberView.hide();this.noAudioView.hide();this.pauseBarView.hide();$(this.el).addClass("expanded")},collapseAllSlides:function(){if($(this.el).hasClass("expanded")){for(var a=0;a<this.slideViews.length;a++){var b=this.slideViews[a];a!=this.curSlideIndex?
b.hide():b.resumeFromExpanded()}$(this.el).removeClass("expanded")}},showGlossaryTerm:function(a){this.titleBarView.showGlossaryTerm(a)},isPreviousTransitionAvailable:function(){if(0<this.curSlideIndex)return!0;var a=this.getCurSlideView();return null!=a?a.isPreviousTransitionAvailable():!1},isNextTransitionAvailable:function(){var a=this.getCurSlideView();return null==a?!0:a.model.get("lastSlide")?a.isNextTransitionAvailable():!0},sendSlideshowEvent:function(a){this.createSlideshowEvent(a).save()},
createSlideshowEvent:function(a){return new n({slideModel:this.getCurSlideView().model,action:a,el:this.el,totalTime:this.scrubberView.totalTime,slideIndex:this.curSlideIndex})}})});define("questions/slideshow/common/js/collections/slideshow",["../models/slide"],function(b){return Backbone.Collection.extend({model:b,initialize:function(c,a){var d=$(".slide",a.el),g=this;_.each(d,function(a){a=new b({el:a,index:g.models.length});g.models.push(a)})}})});
define("questions/slideshow/common/js/models/glossaryEntry",[],function(){return Backbone.Model.extend({initialize:function(b){}})});
define("questions/slideshow/common/js/collections/glossaryEntries",["../models/glossaryEntry"],function(b){return Backbone.Collection.extend({model:b,comparator:"term",initialize:function(c,a){var d=this,g=$("span[data-term]",a.el).filter('[data-entry][data-entry!\x3d""]');g.length&&_.each(g,function(a){a=new b({term:$(a).data("term"),entry:decodeURIComponent($(a).data("entry"))});d.models.push(a)})}})});
define("questions/slideshow/run/js/app",["require","./views/slideshowView","../../common/js/collections/slideshow","../../common/js/collections/glossaryEntries"],function(b,c){var a=b("../../common/js/collections/slideshow"),d=b("../../common/js/collections/glossaryEntries");return{initialize:function(){_.each($(".slideshow"),function(b){if(!0!==$(b).data("initialized")){var n=new a(null,{el:b}),p=new d(null,{el:b}),n=new c({el:b,model:n,glossary:p});n.render();$(b).data("initialized",!0);$(b).data("view",
n)}})}}});define("questions/list/common/js/nls/strings",{root:!0,"zh-cn":!0,ja:!0,es:!0});define("questions/list/common/js/nls/root/strings",{list:{placeholder:"Click for List"}});
define("questions/list/run/js/views/listQuestionView",["require","select2","i18n!questions/list/common/js/nls/strings"],function(b,c,a){var d=function(a){var b=document.createElement("span");$(b).append(a.text);return b},g=function(a,b){var c=a.id,d=a.text;"string"===typeof c&&(c=c.trim());"string"===typeof d&&(d=d.trim());"string"===typeof b&&(b=b.trim());return c==b||d==b};return Backbone.View.extend({render:function(){$(this.model.dataDiv).removeClass("hidden");var b=this;window.setTimeout(function(){for(var c=
100,l=$(b.model.dataDiv).clone().css({position:"absolute",left:"-10000px"}).appendTo("body"),X=$(l).children(".dataItem"),A=$(b.model.dataDiv).attr("data-response"),f=void 0!==A&&null!==A&&""!==A,q=0;q<X.length;q++)c=Math.max(c,$(X[q]).outerWidth());l.remove();$(b.model.dataDiv).addClass("hidden");$(b.el).parent().width(c+48+"px");$(b.el).select2({disabled:f,data:b.model.data,minimumResultsForSearch:Infinity,templateResult:d,templateSelection:d,theme:"bootstrap",placeholder:a.list.placeholder,width:"style",
dropdownAutoWidth:!0});$(".select2-selection__rendered").on("mouseenter mouseleave",function(){$(".select2-selection__rendered .varPreview").popover({html:!0})});$(b.el).on("change",function(a){$(b.el).select2("enable")});if(f)for(q=0;q<b.model.data.length;q++)if(g(b.model.data[q],A)){c=b.model.data[q].id;$(b.el).val(c).trigger("change");break}},100)}})});
define("questions/list/common/js/models/listQuestion",[],function(){return Backbone.Model.extend({initialize:function(b){this.el=b.el;this.dataDiv=b.dataDiv;this.data=[];b=$(this.dataDiv).children(".dataItem");for(var c=0;c<b.length;c++)this.data.push({id:$(b[c]).attr("data-value"),text:b[c].innerHTML})}})});define("jquery",[],function(){return jQuery});
define("questions/list/run/js/app",["require","./views/listQuestionView","../../common/js/models/listQuestion"],function(b,c,a){var d=function(b){if(1!=$(b).data("initialized")){var d=$(b).parent().children("[id^\x3d'menuDisplayData_']")[0];MathJax.Hub.Queue(["Typeset",MathJax.Hub,d]);MathJax.Hub.Queue(function(){var p=new a({el:b,dataDiv:d}),p=new c({el:b,model:p});"function"===typeof overrideSelect2PositionDropdown&&overrideSelect2PositionDropdown();p.render();$(b).data("initialized",!0)})}};return{initialize:function(){var a=
$(".menuDisplayHtml select");0<a.length&&_.each(a,function(a){d(a)})}}});define("questions/programming/run/js/views/programmingInputView",["require"],function(b){return Backbone.View.extend({render:function(){window.programmingEditors||(window.programmingEditors={});var b=window.programmingEditors,a=$(this.el).attr("id"),a=a.substr(0,a.lastIndexOf(".")).replace(/\./g,"_");b[a]=ace.edit(this.el);b[a].setTheme("ace/theme/eclipse");b[a].getSession().setMode("ace/mode/python");b[a].getSession().setUseWorker(!1)}})});
define("questions/programming/run/js/views/programmingOutputView",["require"],function(b){return Backbone.View.extend({})});define("questions/programming/run/js/views/programmingQuestionView",["require","./programmingInputView","./programmingOutputView"],function(b,c,a){return Backbone.View.extend({render:function(){this.inputView=new c({el:$("pre",this.el)});this.inputView.render();this.outputView=new a({el:$(this.el).nextAll(".programmingMessage").children("pre")})}})});
define("questions/programming/run/js/runProgrammingApp",["require","./views/programmingQuestionView"],function(b,c){var a=function(a){!0!==$(a).data("initialized")&&((new c({el:a})).render(),$(a).data("initialized",!0))};return{initialize:function(){var b=$(".programming");0<b.length&&_.each(b,a)}}});define("questions/all/hints/js/models/hint",[],function(){return Backbone.Model.extend({url:function(){return getBaseURL()+"rest/hints/"+this.get("id")}})});
define("questions/all/hints/js/nls/strings",{root:!0,"zh-cn":!0,ja:!0,es:!0});define("questions/all/hints/js/nls/root/strings",{penaltyDialog:{title:"Warning",body:"A penalty of \x3c%\x3d penalty %\x3e will be applied for viewing this hint.",ok:"Accept",cancel:"Cancel"},hintDialog:{close:"Close"},hintButton:{view:"View Hint",again:"View Again"}});define("text!common/templates/dialogs/confirmDialog.html",[],function(){return'\x3cdiv class\x3d"modal fade" tabindex\x3d"-1" role\x3d"alertdialog"\n\taria-labelledby\x3d"confirmDialogTitle" aria-describedby\x3d"confirmDialogBody" aria-hidden\x3d"true"\x3e\n\t\x3cdiv class\x3d"modal-dialog"\x3e\n\t\t\x3cdiv class\x3d"modal-content"\x3e\n\t\t\t\x3cdiv class\x3d"modal-header"\x3e\n\t\t\t\t\x3cbutton type\x3d"button" class\x3d"close" data-dismiss\x3d"modal"\x3e\n\t\t\t\t\t\x3cspan aria-hidden\x3d"true"\x3e\x26times;\x3c/span\x3e\n\t\t\t\t\x3c/button\x3e\n\t\t\t\t\x3ch4 id\x3d"confirmDialogTitle" class\x3d"modal-title"\x3e\x3c%\x3d model.title %\x3e\x3c/h4\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv id\x3d"confirmDialogBody" class\x3d"modal-body"\x3e\n        \t\t\x3c%\x3d model.body %\x3e\n\t\t\t\x3c/div\x3e\n\t\t\t\x3cdiv class\x3d"modal-footer"\x3e\n\t\t\t\t\x3cbutton name\x3d"cancel" type\x3d"button" class\x3d"btn \x3c%\x3d model.cancelButtonClass %\x3e" data-dismiss\x3d"modal"\x3e\n\t\t\t\t\t\x3c%\x3d model.cancel %\x3e\n\t\t\t\t\x3c/button\x3e\n\t\t\t\t\x3cbutton name\x3d"ok" type\x3d"button" class\x3d"btn \x3c%\x3d model.okButtonClass %\x3e" data-dismiss\x3d"modal"\x3e\n\t\t\t\t\t\x3c%\x3d model.ok %\x3e\n\t\t\t\t\x3c/button\x3e\n\t\t\t\x3c/div\x3e\n\t\t\x3c/div\x3e\n\t\x3c/div\x3e\n\x3c/div\x3e'});
define("common/js/views/dialogs/confirmDialog",["i18n!common/js/nls/strings","text!common/templates/dialogs/confirmDialog.html","common/js/views/dialogs/dialogButton"],function(b,c,a){return Backbone.View.extend({tagName:"div",attributes:{"class":"confirmDialogArea"},initialize:function(d){"undefined"===typeof this.model.title&&(this.model.title=b.confirmDialog.title);"undefined"===typeof this.model.ok&&(this.model.ok=b.confirmDialog.ok);"undefined"===typeof this.model.cancel&&(this.model.cancel=
b.confirmDialog.cancel);"undefined"===typeof this.model.cancelButtonClass&&(this.model.cancelButtonClass="btn-default");"undefined"===typeof this.model.okButtonClass&&(this.model.okButtonClass="btn-primary");this.template=_.template(c);$("body").append(this.el);this.$el.html(this.template({model:this.model}));this.okButton=new a({el:$("button[name\x3dok]",this.el),callback:d.doAction,callbackScope:d.doActionScope||this});this.cancelButton=new a({el:$("button[name\x3dcancel]",this.el),callback:d.doCancel,
callbackScope:d.doCancelScope||this})},render:function(){var a=this;this.previousFocus=$(document.activeElement);var b=$(".modal",this.el).modal({backdrop:"static"}).modal("show");$(b).on("hide.bs.modal",function(){a.unrender()});MathJax.Hub.Queue(["Typeset",MathJax.Hub,$(this.el)[0]]);$(b).on("shown.bs.modal",function(){$("button[name\x3dok]",this.el).trigger("focus")});return this},unrender:function(){$(this.el).remove();this.remove();if("function"==typeof this.options.onClose)this.options.onClose();
$(this.previousFocus).length&&$(this.previousFocus).trigger("focus")}})});
define("questions/all/hints/js/views/hintButton",["i18n!questions/all/hints/js/nls/strings","questions/all/hints/js/models/hint","common/js/views/dialogs/alertDialog","common/js/views/dialogs/confirmDialog"],function(b,c,a,d){return Backbone.View.extend({initialize:function(a){this.model=a.model;this.penalize=a.penalize;this.mode=a.mode;this.testId=a.testId;this.asiRef=a.asiRef;this.seen=a.seen;this.row=a.row},events:{click:"submit"},render:function(){this.seen?this.$el.val(b.hintButton.again):this.$el.val(b.hintButton.view);
return this},displayPenaltyDialog:function(){var a=this;(new d({model:{title:b.penaltyDialog.title,body:_.template(b.penaltyDialog.body)({penalty:a.model.get("penalty")}),ok:b.penaltyDialog.ok,cancel:b.penaltyDialog.cancel},doAction:function(){a.displayHint()}})).render()},displayHint:function(){var a=this;""==this.model.get("hint")?this.model.fetch({success:function(b){a.displayHintDialog(a.model.get("name"),a.model.get("hint"))},data:{testId:a.testId,mode:a.mode,asiRef:a.asiRef}}):this.displayHintDialog()},
displayHintDialog:function(){var c=this;(new a({model:{title:this.model.get("name"),body:this.model.get("hint"),done:b.hintDialog.close},onClose:function(){c.hintSeen()},allowDrag:!0})).render()},isSeen:function(){return this.seen},getOrderId:function(){return this.model.get("orderId")},hintSeen:function(){this.seen=!0;this.$el.val(b.hintButton.again);this.row.hintSeen(this.getOrderId())},submit:function(){this.penalize&&!this.seen&&0<this.model.get("penalty")?this.displayPenaltyDialog():this.displayHint();
return!1}})});
define("questions/all/hints/js/views/hintTableRow",["questions/all/hints/js/models/hint","questions/all/hints/js/views/hintButton"],function(b,c){return Backbone.View.extend({initialize:function(a){this.element=a.el;this.table=a.table;this.hintModel=new b({id:this.$(".showHint").data("id"),penalty:this.$(".showHint").data("penalty"),orderId:this.$(".showHint").data("orderid"),hint:this.$(".showHint").data("hint"),name:this.$(".showHint").data("name")})},render:function(){var a=document.forms.edu_form&&document.forms.edu_form.assignment_mode?
document.forms.edu_form.assignment_mode.value:"Unset",b=document.forms.edu_form&&document.forms.edu_form.testId?document.forms.edu_form.testId.value:-1;this.button=new c({el:this.$(".showHint"),model:this.hintModel,penalize:this.$(".showHint").data("penalize"),asiRef:this.$(".showHint").data("asiref"),seen:this.$(".showHint").data("seen"),mode:a,testId:b,row:this});this.button.render();return this},tagName:"tr",getOrderId:function(){return this.button.getOrderId()},show:function(){this.$el.show()},
hide:function(){this.$el.hide()},isSeen:function(){return this.button.isSeen()},hintSeen:function(a){this.table.hintSeen(a)}})});
define("questions/all/hints/js/views/hintTable",["questions/all/hints/js/views/hintTableRow"],function(b){return Backbone.View.extend({initialize:function(b){this.element=b.el;this.showOneHint=$(this.element).data("showonehint");this.showing=null},hintSeen:function(b){this.showOneHint&&((b=this.rows[b+1])?(this.showing=b,b.show()):this.showing=null)},render:function(){var c=this;this.rows={};_.each(this.$("tr.hintRow"),function(a){a=new b({el:$(a),table:c});a.render();c.rows[a.getOrderId()]=a;c.showOneHint?
c.showing||a.isSeen()?a.isSeen()&&a.show():(c.showing=a,a.show()):a.show();c.$el.show()});return this}})});
define("questions/sorting/run/js/sorting",[],function(){var b=function(b,a){var d=jQuery(document.getElementById(b)),g=d.find("ul[class^\x3dsorting] li");g.sort(function(a,b){return Number(a.id)-Number(b.id)});for(var n=0;n<a.length;n++)d.find("ul[class^\x3dsorting]").append(g[a[n]])};return{initialize:function(b,a,d){var g=jQuery(document.getElementById(b)),n=jQuery("input[type\x3d'hidden'][name\x3d'"+a+"']");d&&(g.off("mouseleave").on("mouseleave",function(a){1!=a.buttons&&3!=a.buttons||g.find("ul[class^\x3dsorting]").sortable("cancel");
n.val(g.find("ul[class^\x3dsorting]").sortable("toArray").join(","))}),g.find("ul[class^\x3dsorting]").sortable({items:"li",scroll:!1,update:function(a,b){n.val(g.find("ul[class^\x3dsorting]").sortable("toArray").join(","));g.find("ul[class^\x3dsorting]").trigger("questionResponse:changed")}}),g.find("ul[class^\x3dsorting]").disableSelection());n.val("");g.find("li").each(function(){""!=n.val()&&n.val(n.val()+",");n.val(n.val()+jQuery(this).attr("id"))})},setFeedback:function(c,a,d,g){var n=jQuery(document.getElementById(c)),
p=jQuery("input[type\x3d'hidden'][name\x3d'"+a+"']"),l=a=null;if(null!=d&&(a=d.replace(/.nbsp./g,"").replace(/\u00a0/g,"").replace(/(<.?u>)*/g,"").trim(),"No answer"!=a))for(a=a.split(","),d=0;d<a.length;d++)a[d]=a[d].trim();if(null!=g)for(l=g.replace(/.nbsp./g,"").replace(/\u00a0/g,"").replace(/(<.?u>)*/g,"").trim().split(","),d=0;d<l.length;d++)l[d]=l[d].trim();if(null!=a&&null==l)b(c,a),p.val(""),n.find("li").each(function(){""!=p.val()&&p.val(p.val()+",");p.val(p.val()+jQuery(this).attr("id"))});
else if(null!=l&&(b(c,l),null!=a))for(c=n.find("ul[class^\x3dsorting] li"),d=0;d<l.length;d++)l[d]==a[d]?jQuery(c.get(d)).addClass("corClass"):jQuery(c.get(d)).addClass("incClass")}}});
define("questions/sorting/run/js/app",["require","questions/sorting/run/js/sorting"],function(b,c){return{initialize:function(){_.each($(".sorting"),function(a){if(!$(a).data("initialized")){var b=!1,g=$("input[name\x3d'sortingQuestionId']",a).val(),n=$("input[name\x3d'sortingResponseId']",a).val(),p=$("input[name\x3d'sortingResponse']",a).val(),l=$("input[name\x3d'sortingAnswer']",a).val();"true"===$("input[name\x3d'sortingInteractive']",a).val()&&(b=!0);""==l&&(l=null);c.initialize(g,n,b);c.setFeedback(g,
n,p,l);$(a).data("initialized",!0)}})}}});
define("questions/html5/run/js/runHtml5QuestionApp",["require"],function(b){return{initialize:_.once(function(){window.html5Ques={};html5Ques.MODE={LOCKED:"1",EDITABLE:"0",INTERACTIVE:"2"};html5Ques.TYPE={SKETCH:"sketch",FREEBODYDIAGRAM:"fbd",CLICKABLEIMAGE:"clickableimage"};html5Ques.MSG={uncompletedForce:"Please specifiy the type and angle of each force before checking your work.",emptyControlPoint:"The orgin of a force must not be empty.",angleWarning:"Angles should be between -180 and 360 degrees, inclusive. Half angles are allowed, for example 22.5 degrees",confirmDeleteAllForce:"Are you sure you want to delete all forces you have drawn?",
imageSizeWarn:"Image size must be less than 1 MB.",cannotRemoveForce:"cannot be removed because you have drawn a force of this type.",drawForce:"Draw",deleteForce:"Delete",selectAForce:"Select a Force",chooseAType:"Choose a Type",noBgImage:"No background image",selectBgImage:"Please select a background image.",noForceSelected:"No force selected",chooseForces:"Please choose forces to be selected from.",noCorrectAnswer:"No correct answer",specifyCorrectAnswer:"Please specify a correct answer to this question.",
unCompletedAnswer:"Please make sure the correct answer is complete.",cplist:"List of control points"};html5Ques.utils={styler:function(b){$("div.ui-widget-overlay").css("background","none");var a=$(b).closest(".ui-dialog").css({padding:"0",left:"230px"}).find(".ui-dialog-buttonpane").css({padding:"0.3em 1em",margin:"0"}).children("button");"undefined"===typeof b.mloaded&&($(b).css("background-color","#ffffff"),1<a.length?($(a[0]).addClass("mpl_button").css("color","#444444"),$(a[a.length-1]).removeClass("ui-state-default").addClass("flr mpl_button blue")):
a.addClass("mpl_button flr").css("color","#444444"),b.mloaded="true");a.on("mouseover",function(){$(b).removeClass("ui-state-hover")}).on("focusin",function(){$(b).removeClass("ui-state-focus")})},triggerResponseChangedEvent:function(b,a){$(b).parents(a).trigger("questionResponse:changed")}}})}});
define("questions/clickableImage/run/js/runClickableImageQuestionApp",["require","questions/html5/run/js/runHtml5QuestionApp"],function(b,c){var a=_.once(function(){window.html5Ques.clickableImage=function(){function a(b,c){var d=null,g=[],A=[],f=[],q=!1,e=c,t=null,k=null,v=null;null==e&&(e=html5Ques.MODE.EDITABLE);this.attachAddRegionButton=function(a){t=a;t.on("click",addNewRegion)};this.attachSetCorrectButton=function(a){k=a;k.on("click",setCorrect)};this.attachDeleteButton=function(a){v=a;v.on("click",
deleteRegion)};this.onSubmit=function(a,b){for(var c="",d="",e="",g=0;g<f.length;g++){for(var d="",k=0;k<f[g][2].length;k++)""==d?d=Math.round(f[g][2][k].X())+","+Math.round(f[g][2][k].Y()):d=d+","+Math.round(f[g][2][k].X())+","+Math.round(f[g][2][k].Y());c=g!=f.length-1?c+d+"/":c+d;1==f[g][4]&&(""==e?e=g+1:e=e+", "+(g+1))}a.val(c);b.val(e);return""!=e?!0:!1};this.getResponse=function(){for(var a="",b=0;b<f.length;b++)1==f[b][3]&&(""==a?a=b+1:a=a+", "+(b+1));return a};addNewRegion=function(){for(var a=
0;a<f.length;a++)1==f[a][3]&&(f[a][1].vertices.forEach(function(a){a.setAttribute({strokeColor:"red",fillColor:"red",size:3})}),f[a][3]=!1);q=!0;null!=v&&v.attr("disabled","disabled");null!=k&&k.attr("disabled","disabled")};setCorrect=function(){if(null!=d){d.suspendUpdate();for(var a=0;a<f.length;a++)1==f[a][3]?(f[a][1].setAttribute({fillColor:"#00FF00",fillOpacity:.5,highlightFillColor:"#90EE90"}),f[a][4]=!0):1==f[a][4]&&(f[a][1].setAttribute({fillColor:"#00FF00",fillOpacity:0,highlightFillColor:"gray"}),
f[a][4]=!1);d.unsuspendUpdate()}};deleteRegion=function(){if(null!=d){d.suspendUpdate();for(var a=0;a<f.length;a++)if(1==f[a][3]){d.removeObject(f[a][1]);for(var b=0;b<f[a][2].length;b++)d.removeObject(f[a][2][b]);f.splice(a,1);--a}1==Y()&&(A.forEach(function(a){d.removeObject(a)}),g.forEach(function(a){d.removeObject(a)}),A=[],g=[]);d.unsuspendUpdate();null!=v&&v.attr("disabled","disabled");null!=k&&k.attr("disabled","disabled")}};var Y=function(){for(var a=0;a<A.length;a++)if("blue"==A[a].getAttribute("strokeColor"))return!0;
return!1},P=function(a){var b=null;this.board.suspendUpdate();for(var c=0;c<f.length;c++)this.id==f[c][1].id&&(f[c][3]=!f[c][3],e==html5Ques.MODE.EDITABLE?this.vertices.forEach(function(a){a.setAttribute({strokeColor:f[c][3]?"white":"red",fillColor:f[c][3]?"white":"red",size:f[c][3]?5:3})}):(this.setAttribute({fillOpacity:f[c][3]?.2:0}),this.borders.forEach(function(a){a.setAttribute({strokeOpacity:f[c][3]?1:0,strokeWidth:f[c][3]?2:1})}),html5Ques.utils.triggerResponseChangedEvent(a.target,".html5clickableimage"))),
null==b&&1==f[c][3]&&(b=!0);this.board.unsuspendUpdate();null!=k&&(1==b?k.prop("disabled",!1):k.attr("disabled","disabled"));null!=v&&(1==b||1==Y()?v.prop("disabled",!1):v.attr("disabled","disabled"))};this.init=function(a,c,p){if("object"===typeof a){a.width>=a.height?e==html5Ques.MODE.EDITABLE?($("#"+b).width(600),$("#"+b).height(Math.round(600/a.width*a.height))):600<=a.width?($("#"+b).width(600),$("#"+b).height(Math.round(600/a.width*a.height))):($("#"+b).width(a.width),$("#"+b).height(a.height)):
e==html5Ques.MODE.EDITABLE?($("#"+b).width(Math.round(600/a.height*a.width)),$("#"+b).height(600)):600<=a.height?($("#"+b).width(Math.round(600/a.height*a.width)),$("#"+b).height(600)):($("#"+b).width(a.width),$("#"+b).height(a.height));null!=d&&(JXG.JSXGraph.freeBoard(d),d=null,g=[],A=[],f=[]);var t=[];$("#"+b).parents().each(function(){"none"===$(this).css("display")&&(t[t.length]=this,$(this).css("display","initial"))});d=JXG.JSXGraph.initBoard(b,{boundingbox:[0,0,a.width,a.height],axis:!1,grid:!1,
showNavigation:!1,showCopyright:!1});t.forEach(function(a){$(a).hasClass("timed")||$(a).css("display","none")});d.create("image",[a.src,[0,a.height],[a.width,a.height]],{fixed:!0,highlight:!1});getMouseCoords=function(a,b,c){var d=c.getCoordsTopLeftCorner(a,b);a=JXG.getPosition(a,b);return new JXG.Coords(JXG.COORDS_BY_SCREEN,[a[0]-d[0],a[1]-d[1]],c)};Y=function(){for(var a=0;a<A.length;a++)if("blue"==A[a].getAttribute("strokeColor"))return!0;return!1};getSelectedRegion=function(){for(var a=[],b=0;b<
f.length;b++)1==f[b][3]&&(a[a.length]=b);return a};addPointIntoPolygon=function(a){var b=null;if(1!=(b=getSelectedRegion()).length)return!1;for(var c=-1,e=-1,g=-1,k=2E5,n=0;n<b.length;n++)for(var q=0;q<f[b[n]][1].vertices.length-1;q++){var g=f[b[n]][1].vertices[q].Dist(f[b[n]][1].vertices[q+1]),p=a.Dist(f[b[n]][1].vertices[q]),v=a.Dist(f[b[n]][1].vertices[q+1]),g=Math.max(p,v)>g?Math.min(p,v):Math.abs((f[b[n]][1].vertices[q+1].X()-f[b[n]][1].vertices[q].X())*(a.Y()-f[b[n]][1].vertices[q].Y())-(f[b[n]][1].vertices[q+
1].Y()-f[b[n]][1].vertices[q].Y())*(a.X()-f[b[n]][1].vertices[q].X()))/g;g<k&&(k=g,c=b[n],e=q)}f[c][2].splice(e+1,0,a);d.removeObject(f[c][1]);f[c][1]=d.create("polygon",f[c][2],{hasInnerPoints:!0,fillColor:"#00FF00",fillOpacity:0,highlightFillColor:f[c][4]?"#90EE90":"gray",highlightFillOpacity:.8,borders:{strokeOpacity:1,strokeWidth:1,strokeColor:"green",highlightStrokeOpacity:1,highlightStrokeWidth:1,highlightStrokeColor:"green"}});f[c][1].on("down",P);f[c][1].borders.forEach(function(a){a.isDraggable=
!1});1==f[c][3]&&f[c][1].vertices.forEach(function(a){a.setAttribute({strokeColor:"white",fillColor:"white",size:5})});1==f[c][4]&&f[c][1].setAttribute({fillOpacity:.5});return!0};boardDown=function(a){var b=!0,c,e;a[JXG.touchProperty]&&(c=0);a=getMouseCoords(a,c,d);for(e in d.objects)if(("point"==d.objects[e].getType()||"line"==d.objects[e].getType()||"polygon"==d.objects[e].getType())&&d.objects[e].hasPoint(a.scrCoords[1],a.scrCoords[2])){JXG.isPoint(d.objects[e])&&(q=!0);b=!1;break}1<getSelectedRegion().length&&
(b=q=!1);if(b){g[g.length]=d.create("point",[a.usrCoords[1],a.usrCoords[2]],{face:"\x3c\x3e",size:3,showInfobox:!1,name:""});if(1==addPointIntoPolygon(g[g.length-1]))return g.pop(),!0;null!=k&&k.attr("disabled","disabled");null!=v&&v.attr("disabled","disabled");1<g.length&&(A[A.length]=d.create("line",[g[g.length-2],g[g.length-1]],{strokeColorOpacity:1,strokeWidth:1,strokeColor:"green",highlightStrokeOpacity:1,highlightStrokeWidth:1,highlightStrokeColor:"blue",straightFirst:!1,straightLast:!1}),A.forEach(function(a){a.setAttribute({strokeColor:"green"})}),
g.forEach(function(a){a.setAttribute({strokeColor:"red",fillColor:"red",size:3})}),A[A.length-1].on("down",function(a){var b=Y();A.forEach(function(a){a.setAttribute({strokeColor:b?"green":"blue"})});g.forEach(function(a){a.setAttribute({strokeColor:b?"red":"white",fillColor:b?"red":"white",size:b?3:5})});null!=k&&0==getSelectedRegion().length&&(b||k.attr("disabled","disabled"));null!=v&&0==getSelectedRegion().length&&(b?v.attr("disabled","disabled"):v.prop("disabled",!1))}))}if(3<=g.length&&q){b=
0;for(c in g)if(d.objects[e].id==g[c].id)break;else b++;if(3<=g.length-b){null!=k&&k.attr("disabled","disabled");null!=v&&v.attr("disabled","disabled");d.suspendUpdate();for(c=0;c<A.length;c++)d.removeObject(A[c]);for(c=0;c<b;c++)d.removeObject(g[0]),g.shift();f[f.length]=[];f[f.length-1][0]=f.length;f[f.length-1][1]=d.create("polygon",g,{hasInnerPoints:!0,fillColor:"#00FF00",fillOpacity:0,highlightFillColor:"gray",highlightFillOpacity:.8,borders:{isDraggable:!1,strokeOpacity:1,strokeWidth:1,strokeColor:"green",
highlightStrokeOpacity:1,highlightStrokeWidth:1,highlightStrokeColor:"green"}});f[f.length-1][1].borders.forEach(function(a){a.isDraggable=!1});f[f.length-1][1].vertices.forEach(function(a){a.setAttribute({strokeColor:"red",fillColor:"red",size:3})});f[f.length-1][1].on("down",P);f[f.length-1][2]=g.slice(0,g.length);f[f.length-1][3]=!1;f[f.length-1][4]=!1;d.unsuspendUpdate();g=[];A=[];q=!1;b=!0}}};if(e==html5Ques.MODE.EDITABLE)d.on("down",boardDown);$("#"+b).on("mouseleave",function(){for(var a in d.highlightedObjects)d.renderer.noHighlight(d.highlightedObjects[a])});
if(null!=c&&null!=p){d.suspendUpdate();a=c.split("/");for(var K=0;K<a.length;K++){c=a[K].split(",");for(var ba=0;ba<c.length;ba+=2)g[g.length]=e==html5Ques.MODE.EDITABLE?d.create("point",[parseInt(c[ba]),parseInt(c[ba+1])],{face:"\x3c\x3e",size:3,showInfobox:!1,name:"",fixed:!1}):d.create("point",[parseInt(c[ba]),parseInt(c[ba+1])],{face:"\x3c\x3e",size:3,showInfobox:!1,name:"",fixed:!0,visible:!1});f[f.length]=[];f[f.length-1][0]=f.length;e==html5Ques.MODE.EDITABLE?(f[f.length-1][1]=d.create("polygon",
g,{hasInnerPoints:!0,fillColor:"#00FF00",fillOpacity:0,highlightFillColor:"gray",highlightFillOpacity:.8,borders:{strokeOpacity:1,strokeWidth:1,strokeColor:"green",highlightStrokeOpacity:1,highlightStrokeWidth:1,highlightStrokeColor:"green"}}),f[f.length-1][1].borders.forEach(function(a){a.isDraggable=!1})):e==html5Ques.MODE.INTERACTIVE?f[f.length-1][1]=d.create("polygon",g,{hasInnerPoints:!0,fillColor:"#00FF00",fillOpacity:0,highlightFillColor:"gray",highlightFillOpacity:.8,borders:{strokeColor:"green",
strokeWidth:1,strokeOpacity:0,highlightStrokeOpacity:0,highlightStrokeWidth:1,highlightStrokeColor:"green"}}):e==html5Ques.MODE.LOCKED&&(f[f.length-1][1]=d.create("polygon",g,{hasInnerPoints:!0,fillColor:"#00FF00",fillOpacity:0,highlightFillColor:"gray",highlightFillOpacity:0,borders:{strokeColor:"green",strokeWidth:1,strokeOpacity:0,highlightStrokeOpacity:0,highlightStrokeWidth:1,highlightStrokeColor:"green"}}));if(e==html5Ques.MODE.EDITABLE)f[f.length-1][1].on("down",P);else if(e==html5Ques.MODE.INTERACTIVE)f[f.length-
1][1].on("down",P);else e==html5Ques.MODE.LOCKED&&(f[f.length-1][1].off("mouseover"),f[f.length-1][1].off("down"));f[f.length-1][2]=g.slice(0,g.length);p.split(",").some(function(a){if(parseInt(a.trim())-1==K)return!0})?(f[f.length-1][3]=!0,f[f.length-1][4]=!0,f[f.length-1][1].setAttribute({highlightFillColor:e==html5Ques.MODE.EDITABLE?"#90EE90":"gray",fillColor:"#00FF00",fillOpacity:.5,highlightFillOpacity:.8}),f[f.length-1][1].borders.forEach(function(a){a.setAttribute({strokeOpacity:1,strokeWidth:1,
highlightStrokeOpacity:1,highlightStrokeWidth:1})}),f[f.length-1][1].vertices.forEach(function(a){a.setAttribute({strokeColor:"white",fillColor:"white",size:5})}),null!=v&&v.prop("disabled",!1),null!=k&&k.prop("disabled",!1)):(f[f.length-1][3]=!1,f[f.length-1][4]=!1);g=[]}d.unsuspendUpdate()}}}}var b={};return{getInstance:function(a){return a in b?b[a]:null},newInstance:function(c,p){return b[c]=new a(c,p)}}}()});return{initialize:function(){c.initialize();a()}}});
define("questions/sketch/run/js/runSketchQuestionApp",["require","questions/html5/run/js/runHtml5QuestionApp"],function(b,c){var a=_.once(function(){window.html5Ques.sketch=function(){function a(b,c,d,g,A,f){var q=null,e=null,t={},k={},v=[],Y=!1,P="#0000ff #9b30ff #802a2a #ff00ff #ff6600 #006400 #4682b4".split(" "),T=Array.apply(null,Array(P.length)).map(Number.prototype.valueOf,0),na=0,ja=function(){var a="#000000";if(na<P.length)for(a=P[na],T[na++]=1;na<P.length&&1==T[na];)na++;return a},J=function(a){"response"==
w(a)[0]&&(a=e.objects[a].getAttribute("strokeColor"),a=P.indexOf(a),-1!=a&&(T[a]=0,na=a<na?a:na))},K=["all"],ba={createdroplinepoint:Infinity,createline:Infinity,createabsolutevalue:Infinity,createparabola:Infinity,createthreepointparabola:Infinity,createthreepointparabolaseg:Infinity,createexponential:Infinity,createlogarithmic:Infinity},fa=$.extend({},ba),U=!1,da=function(){var a;a={};var b="";if(k.hasOwnProperty("topGroup")&&0<k.topGroup.parents.length){for(var m="grouping0"==k.topGroup.parents[0]?
k.grouping0:k.topGroup,c=[],d=0;d<m.parents.length;d++){var e=k[m.parents[d]],h=e.elementType;if(!e.hasOwnProperty("link"))if(-1<$.inArray(h,"point line absolutevalue parabola exponential logarithmic".split(" "))){var f=h;"point"==h?e.attributes&&1==e.attributes.droplines&&(f="droplinepoint"):"parabola"==h&&(3==e.parents.length&&(f="threepointparabola"),2==_.intersection(e.domain,e.parents).length&&(f="threepointparabolaseg"));a.hasOwnProperty("create"+f)?a["create"+f]++:a["create"+f]=1}else"region"==
h?(a.createline=e.parents.length-2,a.togglesoliddashed=!0,a.chooseregion=!0):"subcurve"==h&&(a.snipleft=!0,a.snipright=!0,a.snipbetween=!0,a.togglefilled=!0,-1==$.inArray(e.parents[0],c)&&c.push(e.parents[0]))}for(d=0;d<c.length;d++)m=k[c[d]].elementType,a.hasOwnProperty("create"+m)?a["create"+m]++:a["create"+m]=1;for(var g in a)-1<$.inArray(g,"createpoint createdroplinepoint createline createabsolutevalue createparabola createthreepointparabola createthreepointparabolaseg createexponential createlogarithmic".split(" "))?
b+=g+":"+a[g]+", ":-1<$.inArray(g,"chooseregion togglesoliddashed snipleft snipright snipbetween togglefilled".split(" "))&&(b+=g+", ");b+="delete"}a=b;var C;try{C=JSON.parse("{"+$('textarea[name\x3d"options"]').val()+"}")}catch(I){C={}}0<a.length?C.visible_buttons=a:delete C.visible_buttons;var z;try{z=JSON.stringify(C).trim(),z=z.substring(1,z.length-1)}catch(I){z=""}$('textarea[name\x3d"options"]').val(z)},B={UNSET:-1,DELETE:0,CREATE:1,CREATEDROPLINEPOINT:14,CREATELINE:2,CREATEABSOLUTEVALUE:3,
CREATEPARABOLA:4,CREATETHREEPOINTPARABOLA:15,CREATETHREEPOINTPARABOLASEG:16,CREATEEXPONENTIAL:5,CREATELOGARITHMIC:6,CHOOSEREGION:7,SNIPLEFT:8,SNIPRIGHT:9,SNIPBETWEEN:10,TOGGLEFILLED:11,TOGGLESOLIDDASHED:12,TOGGLEBUILDTRANSFORM:13},F=B.UNSET,ta=-1,Q=function(a,b,m,c,d){this.elementType=a;this.parents=b;this.attributes=m;this.gradingOptions=c;d&&(this.domain=d)},r={pt1:null,pt2:null,pt3:null,ln1:null},N={},Ja=!1,oa=[],V,ka=null,za=function(a){for(var b in a)if(Object.prototype.hasOwnProperty.call(a,
b))return!1;return!0},eb=function(a){var b="delete",m;for(m in B)if(B[m]==a){b=m.toLowerCase();break}return q.find("button[name\x3d'"+b+"']")},ra=function(a){var b=[];if(0<a.length)for(var m=0;m<a.length;m++)b[m]=e.objects[a[m]];return b},Fa=function(a){var b;a[JXG.touchProperty]?a[JXG.touchProperty][0]?b=e.getMousePosition(a,0):(b=e.getCoordsTopLeftCorner(),a=[a.changedTouches[0].pageX,a.changedTouches[0].pageY],b=[a[0]-b[0],a[1]-b[1]]):b=e.getMousePosition(a);return new JXG.Coords(JXG.COORDS_BY_SCREEN,
b,e)},G=function(a,b){var m=w(a)[1],c=[],d;for(d in m)-1!=m[d].parents.indexOf(a)&&(null==b?c.push(d):m[d].elementType==b&&c.push(d));return c},fb=function(a){var b=!1,m=e.getBoundingBox();if(a[0]<=m[0]||a[0]>=m[2]||a[1]<=m[3]||a[1]>=m[1])b=!0;return b},Xa=function(a){var b=e.create("line",[function(){return[0,a.Y()]},a],{straightFirst:!1,straightLast:!1,strokeColor:aa.givenCurves.common.strokeColor,strokeWidth:"1",dash:2}),m=e.create("line",[function(){return[a.X(),0]},a],{straightFirst:!1,straightLast:!1,
strokeColor:aa.givenCurves.common.strokeColor,strokeWidth:"1",dash:2});a.droplines=[b.id,m.id]},ua=function(a,b){var m=void 0!=b&&null!=b?b:.1,c=w(a)[1][a],d=c.parents,h=[a],m={fillOpacity:m,strokeOpacity:m};"point"!=c.elementType?(h.push.apply(h,d),m.strokeWidth="1"):e.objects[a].droplines&&h.push.apply(h,e.objects[a].droplines);for(c=0;c<h.length;c++)e.objects[h[c]].setAttribute(m)},Ga=function(a){var b=w(a),m=b[0],c=b[1][a],d=c.parents,b=[a],h={fillOpacity:1,strokeOpacity:1};"point"!=c.elementType?
(b.push.apply(b,d),h.strokeWidth=aa[m].common.strokeWidth):e.objects[a].droplines&&b.push.apply(b,e.objects[a].droplines);for(a=0;a<b.length;a++)e.objects[b[a]].setAttribute(h)},gb=function(a){var b=function(){var b=a[0],c=a[1],d=(c.Y()-b.Y())/Math.pow(c.X()-b.X(),2),L=(c.Y()-b.Y())/Math.abs(c.X()-b.X()),h=e.getBoundingBox();return{v:b,p:c,m:L,k:d,tMin:h[0],tMax:h[2]}};return[function(a){return a},function(a){return b().m*Math.abs(a-b().v.X())+b().v.Y()},function(){return b().tMin},function(){return b().tMax}]},
ga=function(a,b){var m;return 2==a.length||4==a.length?(m=function(){var b=a[0],m=a[1],c=(m.Y()-b.Y())/Math.pow(m.X()-b.X(),2),d=e.getBoundingBox(),L=d[0],d=d[2];if(4==a.length){var h=a[2],f=a[3];"-infinity"!=h&&(L=h.X());"infinity"!=f&&(d=f.X())}return{v:b,p:m,k:c,tMin:L,tMax:d}},[function(a){return a},function(a){return m().k*Math.pow(a-m().v.X(),2)+m().v.Y()},function(){return m().tMin},function(){return m().tMax}]):[function(a){return a},function(b){var m=[a[0].X(),a[0].Y()],c=[a[1].X(),a[1].Y()],
d=[a[2].X(),a[2].Y()],L=[m[0],c[0],d[0]],m=[m[1],c[1],d[1]];return m[0]*(b-L[1])*(b-L[2])/((L[0]-L[1])*(L[0]-L[2]))+m[1]*(b-L[0])*(b-L[2])/((L[1]-L[0])*(L[1]-L[2]))+m[2]*(b-L[0])*(b-L[1])/((L[2]-L[0])*(L[2]-L[1]))},function(){return b?b[0].X():e.getBoundingBox()[0]},function(){return b?b[1].X():e.getBoundingBox()[2]}]},xa=function(a){var b=function(){var b=a[0],c=a[1],d=(c.Y()-b.Y())/(c.X()-b.X()),L=e.getBoundingBox(),h=L[0],L=L[2];if(4==a.length){var f=a[2],g=a[3];"-infinity"!=f&&(h=f.X());"infinity"!=
g&&(L=g.X())}return{p:b,q:c,m:d,tMin:h,tMax:L}};return[function(a){return a},function(a){return b().m*(a-b().p.X())+b().p.Y()},function(){return b().tMin},function(){return b().tMax}]},Ya=function(a){var b=function(){var b=a[0],c=a[1],d=e.objects[a[2].parents[0]].Y(),c=Math.pow((b.Y()-d)/(c.Y()-d),1/(b.X()-c.X())),b=(b.Y()-d)/Math.pow(c,b.X()),L=e.getBoundingBox();return{a:b,b:c,c:d,tMin:L[0],tMax:L[2]}};return[function(a){return a},function(a){return b().a*Math.pow(b().b,a)+b().c},b().tMin,b().tMax]},
Za=function(a){var b=function(){var b=a[0],c=a[1],d=e.objects[a[2].parents[0]].X(),c=Math.pow((b.X()-d)/(c.X()-d),1/(b.Y()-c.Y())),b=(b.X()-d)/Math.pow(c,b.Y()),L=e.getBoundingBox();return{a:b,b:c,c:d,tMin:L[3],tMax:L[1]}};return[function(a){return b().a*Math.pow(b().b,a)+b().c},function(a){return a},b().tMin,b().tMax]},$a=function(a){var b=e.getBoundingBox(),m=b[0],c=b[2],d=b[1],h=b[3];a=w(a)[1][a];var f,g,C,I;"parabola"==a.elementType?(f=e.objects[a.parents[0]],g=e.objects[a.parents[1]],C=(g.Y()-
f.Y())/Math.pow(g.X()-f.X(),2),h=function(a){return C*Math.pow(a-f.X(),2)+f.Y()},c=g.Y()>=f.Y()?b[1]:b[3],m=f.X()-Math.sqrt((c-f.Y())/C),c=f.X()+Math.sqrt((c-f.Y())/C),m=Math.max(m,b[0]),c=Math.min(c,b[2]),d=h(m),h=h(c)):"line"==a.elementType&&(g=e.objects[a.parents[0]],m=e.objects[a.parents[1]],I=(m.Y()-g.Y())/(m.X()-g.X()),h=function(a){return I*(a-g.X())+g.Y()},c=g.X()+(b[1]-g.Y())/I,d=g.X()+(b[3]-g.Y())/I,m=Math.min(c,d),c=Math.max(c,d),m=Math.max(m,b[0]),c=Math.min(c,b[2]),d=h(m),h=h(c));return[[m,
d],[c,h]]},hb=function(a){for(var b=a[0],m=a[0],c=1;c<a.length;c++){var d=a[c];d.X()<b.X()&&(b=d);d.X()>m.X()&&(m=d)}return[b,m]},Pa=function(a,b){for(var m in b)if(b[m].attributes.name==a)return m;return null},la=function(a){a.hasOwnProperty("topGroup")||(a.topGroup=new Q("topGroup",[],{name:"Top-level Group"},{}));return"grouping0"==a.topGroup.parents[0]?a.grouping0:a.topGroup},ma=function(a,b){var m=w(a),c=m[0],m=m[1][a];if(m.hasOwnProperty("link")){var c="response"==c?t:k,d;if(void 0!=b&&null!=
b)a:{m=m.attributes.name;for(d in c){var h=c[d];if(h.hasOwnProperty("link")&&h.link.linkToName==m)break a}d=null}else d=Pa(m.link.linkToName,c);return d}return null},Ka=function(a){var b;a:if(b=w(a)[1],b=la(b),-1!=b.parents.indexOf(a))b=a;else{a=G(a,null);if(0<a.length&&(a=a[0],-1!=b.parents.indexOf(a))){b=a;break a}b=null}return null!=b?ma(b):null},sa=function(a){a=Ka(a);if(null!=a){var b=w(a),m=b[0];delete b[1][a].link;"givenCurves"==m&&Ga(a)}},Qa=function(a){if(!(0<Ha("region",k).length)){var b=
w(a),m=b[0],b=b[1],c=la(b);if(-1!=c.parents.indexOf(a)){var d="response"==m?"givenCurves":"response",h="response"==m?t:k,f=la(h),g=b[a],C=g.elementType,I=g.parents,z=e.objects[a],M=aa[d].point.common.size,n=aa[d].point.common.strokeWidth,q=aa[d].point.common.strokeColor,u=aa[d].point.solid.fillColor,d=aa[d].common.strokeWidth;"response"==m?("grouping"!=c.elementType&&J(a),m=aa.givenCurves.common.strokeColor):m="grouping0"==f.name?e.objects[f.parents[0]].getAttribute("strokeColor"):ja();z.setAttribute({strokeWidth:d,
strokeColor:m});if("point"==C)z.setAttribute({strokeWidth:n,fillColor:m,size:M});else for(z=0;z<I.length;z++){var p=I[z],y=b[p],p=e.objects[p];"point"==y.elementType?p.setAttribute({strokeWidth:n,strokeColor:q,fillColor:u,size:M}):"line"==y.elementType&&p.setAttribute({strokeWidth:d,strokeColor:m})}f.parents.push(a);f=c.parents.indexOf(a);"grouping"==c.elementType?Aa("grouping0",a):c.parents.splice(f,1);h[a]=g;delete b[a];if("point"!=C)for(z=0;z<I.length;z++)p=I[z],y=b[p],h[p]=y,delete b[p];da()}}},
Ba=function(a){if(g===html5Ques.MODE.EDITABLE&&F===B.TOGGLEBUILDTRANSFORM){var b=w(a),m=b[0];-1!=la(b[1]).parents.indexOf(a)&&(b=e.objects[a],!b.drags||2>b.drags)&&(null==ka||ka==a)&&(b=ma(a),null==b?Qa(a):(Qa("response"==m?a:b),ua("response"==m?a:b,.4),Qa("response"==m?b:a),Ga("response"==m?b:a)))}},qa=function(a,b){var m=w(a),c=m[0],d=m[1];la(d);var h="response"==c?"givenCurves":"response",m="response"==c?t:k;la(m);var e=d[a],f=e.elementType,g=e.parents,C=e.attributes,I={},z=new Q("topGroup",[],
{name:"Top-level Group"},{});I.topGroup=z;z.parents.push(a);z=JSON.parse(JSON.stringify(e));null!=b&&void 0!=b?z.attributes.name=b:delete z.attributes.name;z.link={linkToName:C.name};I[a]=z;if("point"!=f)for(f=0;f<g.length;f++)C=g[f],z=JSON.parse(JSON.stringify(d[C])),delete z.attributes.name,I[C]=JSON.parse(JSON.stringify(z));ib(I,m,h,!0);e.hasOwnProperty("link")||(e.link={});d=ma(a,!0);e.link={linkToName:m[d].attributes.name};ua("response"==c?d:a,.4)},Ra=function(a,b){if(e.objects[b].hasOwnProperty("translationPieces"))"DNE"!=
e.objects[b].translationPieces&&V.setPosition(JXG.COORDS_BY_USER,[a[0],a[1]]);else{var m=ma(b);if(null==m)e.objects[b].translationPieces="DNE";else if("point"!=e.objects[b].getType()){var c=w(b),d=c[0],c=c[1];la(c);var h=c[b].parents,c=e.objects[b],f=w(m)[1];la(f);var g=e.objects[m],h=e.objects[h[0]],m=e.objects[f[m].parents[0]],f=[h.X()-m.X(),h.Y()-m.Y()],h=e.getBoundingBox(),C=h[2]-h[0],m=.01*C,z=.02*(h[1]-h[3]),I=1.25E-5*C,M=e.create("point",[a[0]-f[0],a[1]-f[1]],{visible:!1}),f="response"==d?
c.getAttribute("strokeColor"):g.getAttribute("strokeColor"),d=e.create("line",[[M.X(),M.Y()],function(){return[M.X(),V.Y()]}],{straightFirst:!1,straightLast:!1,strokeColor:f,strokeWidth:"1",dash:2,withLabel:!1}),g=e.create("line",[function(){return[M.X(),V.Y()]},function(){return[V.X(),V.Y()]}],{straightFirst:!1,straightLast:!1,strokeColor:f,strokeWidth:"1",dash:2,withLabel:!1}),m=e.create("text",[M.X()+m,function(){return(V.Y()+M.Y())/2},function(){var a=Math.abs(V.Y()-M.Y());return a<I?"":JXG.autoDigits(a)}],
{strokeColor:f}),f=e.create("text",[function(){return(V.X()+M.X())/2},function(){return V.Y()+z},function(){var a=Math.abs(V.X()-M.X());return a<I?"":JXG.autoDigits(a)}],{strokeColor:f});c.translationPieces=[M.id,d.id,g.id,m.id,f.id]}}},Ca=function(a){a=e.objects[a];if(a.hasOwnProperty("translationPieces")){var b=a.translationPieces;if("DNE"!=b)for(var m=0;m<b.length;m++)e.removeObject(e.objects[b[m]]);delete a.translationPieces}},va=function(a,b){var m=Fa(a),m=[m.usrCoords[1],m.usrCoords[2]],c=w(b)[1],
c=la(c);if(g===html5Ques.MODE.EDITABLE)if(-1==c.parents.indexOf(b)){if(2==e.objects[b].drags&&(m=Ka(b),null!=m)){switch(w(m)[1][m].elementType){case "point":Ia(m);break;case "line":Sa(m);break;case "absolutevalue":jb(m);break;case "parabola":kb(m);break;case "exponential":u(m);break;case "logarithmic":Z(m)}da()}}else F===B.TOGGLEBUILDTRANSFORM?null==ma(b)?2==e.objects[b].drags&&(qa(b),da()):Ra(m,b):Ra(m,b);else-1!=c.parents.indexOf(b)&&Ra(m,b)},Da=function(a){1!=Ja&&(oa=[],Ja=!0);oa.push(a)},Ta=function(a,
b){Da(this.id)},Ua=function(a,b){if(F===B.DELETE)pa(null,this.id),E(this.id),g===html5Ques.MODE.EDITABLE&&da();else{if(F===B.TOGGLEFILLED){var m=w(this.id),c=m[0],m=m[1][this.id].attributes;m.hasOwnProperty("solid")&&"true"!=m.solid?(this.setAttribute({fillColor:aa[c].glider.solid.fillColor}),m.solid="true"):(this.setAttribute({fillColor:aa[c].glider.notSolid.fillColor}),m.solid="false")}ha(this.id)}},La=function(a,b){za(N)&&pa(null,this.id);var m=(N.hasOwnProperty(this.id)?N:w(this.id)[1])[this.id].parents[2],
c=$a(m),m=c[0],c=c[1];this.X()<m[0]?(this.setPosition(JXG.COORDS_BY_USER,m),this.makeGlider(this.slideObject)):this.X()>c[0]&&(this.setPosition(JXG.COORDS_BY_USER,c),this.makeGlider(this.slideObject))},wa=function(a,b){var m=w(this.id)[1];!m[this.id]||0<_.intersection(oa,m[this.id].parents).length||F!==B.DELETE||(pa(null,this.id),nb(this.id,null),g===html5Ques.MODE.EDITABLE&&da())},Ma=function(a,b){Da(this.id)},Na=function(a,b){za(N)&&pa(null,this.id);var m=G(this.id,"parabola");0==m.length&&(m=G(this.id,
"line"));0<m.length&&ab(m[0]);ka=this.id;this.drags=this.hasOwnProperty("drags")?this.drags+1:1;va(a,this.id)},Va=function(a,b){Fa(a);Ca(this.id);var m=w(this.id),c=m[0],m=m[1],d=G(this.id,"line"),d=0==d.length?G(this.id,"parabola"):d,h=0<d.length?d[0]:null,d=null==h?[]:G(h,"glider"),h=null==h?[]:G(h,"subcurve");if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||"response"==c)c=ma(this.id),m=m[this.id].attributes.name,pa(null,this.id),0==d.length&&0==h.length&&Ia(this.id),g===html5Ques.MODE.EDITABLE?
da():null!=c&&(t[c].link={linkToName:m},qa(c,m))}else Oa(this.id),Ba(this.id);delete this.drags},ab=function(a){var b=G(a,"glider");if(0<b.length){var b=ra(b),m=$a(a);a=m[0];for(var m=m[1],c=0;c<b.length;c++){var d=b[c];d.X()<a[0]?(d.setPosition(JXG.COORDS_BY_USER,a),d.makeGlider(d.slideObject)):d.X()>m[0]&&(d.setPosition(JXG.COORDS_BY_USER,m),d.makeGlider(d.slideObject))}}},Wa=function(a,b){console.log("lineDrag called!");za(N)&&pa(null,this.id);ab(this.id);ka=this.id;this.drags=this.hasOwnProperty("drags")?
this.drags+1:1;va(a,this.id)},h=function(a,b){Fa(a);Ca(this.id);var m=w(this.id),c=m[0],d=m[1],h=this.id,m=G(h,"glider"),h=G(h,"subcurve");if(d[this.id]&&!(0<_.intersection(oa,d[this.id].parents).length))if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||"response"==c)c=ma(this.id),d=d[this.id].attributes.name,pa(null,this.id),0==m.length&&0==h.length&&Sa(this.id,null),g===html5Ques.MODE.EDITABLE?da():null!=c&&(t[c].link={linkToName:d},qa(c,d))}else F!==B.TOGGLESOLIDDASHED||"response"!=c||k[this.id].parents[0]instanceof
Array||k[this.id].parents[1]instanceof Array||(m=k[this.id].attributes,m.hasOwnProperty("solid")&&"true"!=m.solid?(this.setAttribute({dash:aa.response.line.solid.dash}),m.solid="true"):(this.setAttribute({dash:aa.response.line.notSolid.dash}),m.solid="false"),1==Y&&(m=Ha("region",k),m=0==m.length?null:m[0],null!=m&&(c=k[m].parents,-1!=c.slice(2,c.length).indexOf(this.id)&&(k[m].attributes.mapleExpression=ob(c))))),lb(this.id),Ba(this.id);delete this.drags},I=function(a,b){console.log("absolutevalueDrag called!");
ka=this.id;this.drags=this.hasOwnProperty("drags")?this.drags+1:1;va(a,this.id)},C=function(a,b){Ca(this.id);var m=w(this.id),c=m[0],m=m[1];if(m[this.id]&&!(0<_.intersection(oa,m[this.id].parents).length))if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||"response"==c)c=ma(this.id),m=m[this.id].attributes.name,pa(null,this.id),jb(this.id,null),g===html5Ques.MODE.EDITABLE?da():null!=c&&(t[c].link={linkToName:m},qa(c,m))}else{for(var c=this.id,c=w(c)[1][c].parents,d=0;d<c.length;d++)m=c[d],Oa(m);Ba(this.id)}delete this.drags},
z=function(a,b){console.log("parabolaDrag called!");ka=this.id;this.drags=this.hasOwnProperty("drags")?this.drags+1:1;va(a,this.id)},M=function(a,b){Fa(a);Ca(this.id);var m=w(this.id),c=m[0],d=m[1],h=this.id,m=G(h,"glider"),h=G(h,"subcurve");if(d[this.id]&&!(0<_.intersection(oa,d[this.id].parents).length))if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||"response"==c)c=ma(this.id),d=d[this.id].attributes.name,pa(null,this.id),0==m.length&&0==h.length&&kb(this.id,null),g===html5Ques.MODE.EDITABLE?
da():null!=c&&(t[c].link={linkToName:d},qa(c,d))}else{m=this.id;c=w(m)[1][m].parents;for(h=0;h<c.length;h++)d=c[h],Oa(d);m=G(m,"glider");for(c=0;c<m.length;c++)ha(m[c]);Ba(this.id)}delete this.drags},W=function(a,b){console.log("exponentialDrag called!");ka=this.id;this.drags=this.hasOwnProperty("drags")?this.drags+1:1;va(a,this.id)},ia=function(a,b){Ca(this.id);var m=w(this.id),c=m[0],m=m[1];if(m[this.id]&&!(0<_.intersection(oa,m[this.id].parents).length))if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||
"response"==c)c=ma(this.id),m=m[this.id].attributes.name,pa(null,this.id),u(this.id,null),g===html5Ques.MODE.EDITABLE?da():null!=c&&(t[c].link={linkToName:m},qa(c,m))}else{for(var m=this.id,c=w(m)[1],m=c[m].parents,d,h=0;h<m.length;h++)d=m[h],"point"==c[d].elementType?Oa(d):lb(d);Ba(this.id);this.id}delete this.drags},ca=function(a,b){console.log("logarithmicDrag called!");ka=this.id;this.drags=this.hasOwnProperty("drags")?this.drags+1:1;va(a,this.id)},S=function(a,b){Ca(this.id);var c=w(this.id),
d=c[0],c=c[1];if(c[this.id]&&!(0<_.intersection(oa,c[this.id].parents).length))if(F===B.DELETE){if(g===html5Ques.MODE.EDITABLE||"response"==d)d=ma(this.id),c=c[this.id].attributes.name,pa(null,this.id),Z(this.id,null),g===html5Ques.MODE.EDITABLE?da():null!=d&&(t[d].link={linkToName:c},qa(d,c))}else{for(var c=this.id,d=w(c)[1],c=d[c].parents,h,e=0;e<c.length;e++)h=c[e],"point"==d[h].elementType?Oa(h):lb(h);Ba(this.id);this.id}delete this.drags},E=function(a){for(var b=w(a)[1],c=G(a,"subcurve"),d=0;d<
c.length;d++)nb(c[d],a);e.removeObject(e.objects[a]);delete b[a]},O=function(a){var b=null,c=w(a)[1][a].parents[0],c=G(c,"subcurve");a=c.indexOf(a);c.splice(a,1);0<c.length&&(b=c[0]);return b},Aa=function(a,b){var c=w(b)[1],d=c[b].elementType,h=null;"subcurve"==d&&(h=O(b));var e=c[a].parents,f=e.indexOf(b);"subcurve"!=d||null!=h?(e.splice(f,1),1==e.length&&(c.topGroup.parents.push(e[0]),f=c.topGroup.parents.indexOf(a),c.topGroup.parents.splice(f,1),delete c[a])):(c=c[b].parents[0],e[f]=c,Ga(c))},
nb=function(a,b){for(var c=w(a)[1],d=G(a,"grouping"),h=0;h<d.length;h++)Aa(d[h],a);h=c.topGroup.parents.indexOf(a);-1<h&&(null!=O(a)?c.topGroup.parents.splice(h,1):(d=c[a].parents[0],c.topGroup.parents[h]=d,Ga(d)));d=c[a].parents;e.removeObject(e.objects[a]);delete c[a];for(h=1;h<d.length;h++)c=d[h],c!=b&&"-infinity"!=c&&"infinity"!=c&&E(c)},Ia=function(a){sa(a);for(var b=w(a)[1],c=G(a,"line"),d=0;d<c.length;d++)Sa(c[d],a);c=G(a,"absolutevalue");for(d=0;d<c.length;d++)jb(c[d],a);c=G(a,"parabola");
for(d=0;d<c.length;d++)kb(c[d],a);c=G(a,"exponential");for(d=0;d<c.length;d++)u(c[d],a);c=G(a,"logarithmic");for(d=0;d<c.length;d++)Z(c[d],a);c=G(a,"grouping");for(d=0;d<c.length;d++)Aa(c[d],a),J(a);d=b.topGroup.parents.indexOf(a);-1<d&&(b.topGroup.parents.splice(d,1),J(a));e.removeObject(e.objects[a]);delete b[a]},Sa=function(a,b){sa(a);for(var c=w(a)[1],d=G(a,"exponential"),h=0;h<d.length;h++)u(d[h],a);d=G(a,"logarithmic");for(h=0;h<d.length;h++)Z(d[h],a);d=G(a,"grouping");for(h=0;h<d.length;h++)Aa(d[h],
a),J(a);h=c.topGroup.parents.indexOf(a);-1<h&&(c.topGroup.parents.splice(h,1),J(a));var d=c[a].parents,f=e.objects[a].getParents();e.removeObject(e.objects[a]);delete c[a];for(h=0;h<d.length;h++)c=d[h],c instanceof Array||c==b?e.removeObject(e.objects[f[h]]):Ia(c)},jb=function(a,b){sa(a);for(var c=w(a)[1],d=G(a,"grouping"),h=0;h<d.length;h++)Aa(d[h],a),J(a);h=c.topGroup.parents.indexOf(a);-1<h&&(c.topGroup.parents.splice(h,1),J(a));d=c[a].parents;e.removeObject(e.objects[a]);delete c[a];for(h=0;h<
d.length;h++)c=d[h],c!=b&&Ia(c)},kb=function(a,b){sa(a);for(var c=w(a)[1],d=G(a,"grouping"),h=0;h<d.length;h++)Aa(d[h],a),J(a);h=c.topGroup.parents.indexOf(a);-1<h&&(c.topGroup.parents.splice(h,1),J(a));d=c[a].parents;e.removeObject(e.objects[a]);delete c[a];for(h=0;h<d.length;h++)c=d[h],c!=b&&Ia(c)},u=function(a,b){sa(a);for(var c=w(a)[1],d=G(a,"grouping"),h=0;h<d.length;h++)Aa(d[h],a),J(a);h=c.topGroup.parents.indexOf(a);-1<h&&(c.topGroup.parents.splice(h,1),J(a));d=c[a].parents;e.removeObject(e.objects[a]);
delete c[a];for(h=0;h<d.length-1;h++)c=d[h],c!=b&&Ia(c);c=d[d.length-1];c!=b&&Sa(c)},Z=function(a,b){sa(a);for(var c=w(a)[1],d=G(a,"grouping"),h=0;h<d.length;h++)Aa(d[h],a),J(a);h=c.topGroup.parents.indexOf(a);-1<h&&(c.topGroup.parents.splice(h,1),J(a));d=c[a].parents;e.removeObject(e.objects[a]);delete c[a];for(h=0;h<d.length-1;h++)c=d[h],c!=b&&Ia(c);c=d[d.length-1];c!=b&&Sa(c)},ha=function(a){var b=N.hasOwnProperty(a)?N:w(a)[1],b=b[a],c=e.objects[a];b.parents[0]=c.X();b.parents[1]=c.Y();c=G(a,"subcurve");
0<c.length&&(b=w(a)[1],a=b[c[0]].parents,"-infinity"!=a[1]&&"infinity"!=a[2]&&(b=a[1],c=a[2],e.objects[b].X()>e.objects[c].X()&&(a[1]=c,a[2]=b)))},Oa=function(a){var b=N.hasOwnProperty(a)?N:w(a)[1],c=e.objects[a];b[a].parents=[c.X(),c.Y()];c=G(a,null);if(0<c.length&&(c=c[0],b=b[c],b.domain&&"-infinity"!=b.domain[0]&&"infinity"!=b.domain[1])){var c=b.domain[0],d=b.domain[1];e.objects[c].X()>e.objects[d].X()&&(b.domain[0]=d,b.domain[1]=c)}c=G(a,"parabola");0==c.length&&(c=G(a,"line"));if(0<c.length)for(c=
c[0],a=G(c,"glider"),b=0;b<a.length;b++)ha(a[b])},lb=function(a){for(var b=w(a)[1][a],c=e.objects[a],b=b.parents,d,h=0;h<b.length;h++)d=b[h],d instanceof Array?b[h]=[e.objects[c.parents[h]].X(),e.objects[c.parents[h]].Y()]:Oa(d);a=G(a,"glider");for(c=0;c<a.length;c++)ha(a[c])},ub=function(a,b){for(var c in a)"point"!=k[c].elementType&&"glider"!=k[c].elementType&&e.objects[c].setAttribute({strokeColor:b})},vb=function(a,b,c){var d=!1;a=G(a,"subcurve");0==a.length?d=!0:1==a.length&&(a=k[a[0]],c==B.SNIPLEFT&&
"-infinity"==a.parents[1]&&k[a.parents[2]].parents[0]>b[0]?d=!0:c==B.SNIPRIGHT&&"infinity"==a.parents[2]&&k[a.parents[1]].parents[0]<b[0]&&(d=!0));return d},wb=function(a){1!=Ja?oa=[]:Ja=!1;ka=null},xb=function(a){var b=!0,c=!1,d=Fa(a),f=[d.usrCoords[1],d.usrCoords[2]],n=null,q=null,u=null,x=[],p=-1;a=null;var l=[],w=aa.response,R,H;if(F==B.DELETE){var c=!1,D;for(D in e.objects)if(e.objects[D].hasPoint(d.scrCoords[1],d.scrCoords[2])&&(k.hasOwnProperty(D)||t.hasOwnProperty(D))){c=!0;break}c||(c=Ha("region",
k),c=0==c.length?null:c[0],null!=c&&(D=bb(k[c].parents.slice(0,2)),bb(f)==D&&pa(c)));g===html5Ques.MODE.EDITABLE&&da()}else if(F==B.CREATE||F==B.CREATEDROPLINEPOINT||F==B.CREATELINE||F==B.CHOOSEREGION||F==B.CREATEABSOLUTEVALUE||F==B.CREATEPARABOLA||F==B.CREATETHREEPOINTPARABOLA||F==B.CREATETHREEPOINTPARABOLASEG||F==B.CREATEEXPONENTIAL||F==B.CREATELOGARITHMIC||F==B.SNIPLEFT||F==B.SNIPRIGHT||F==B.SNIPBETWEEN){for(D in r)if(n=r[D],null!=n&&n.hasPoint(d.scrCoords[1],d.scrCoords[2])){b=!1;break}if(b&&
F==B.CHOOSEREGION){if(fb(f))b=!1;else for(D in e.objects)if(e.objects[D].hasPoint(d.scrCoords[1],d.scrCoords[2])&&(k.hasOwnProperty(D)||t.hasOwnProperty(D))){b=!1;break}b&&(a=Ha("region",k),a=0==a.length?null:a[0],l=null==a?Ha("line",k):k[a].parents.slice(2,k[a].parents.length),v=pb(l),p=bb(f),0==l.length||-1==p)&&(b=!1)}if(b&&(F==B.SNIPLEFT||F==B.SNIPRIGHT||F==B.SNIPBETWEEN)){for(D in e.objects)if(e.objects[D].hasPoint(d.scrCoords[1],d.scrCoords[2])&&k.hasOwnProperty(D)&&("parabola"==k[D].elementType||
"line"==k[D].elementType)){if(c=vb(D,f,F))q=D,u=k[D].elementType,x=G(q,"subcurve");break}b=c}c="#000000";if(b){var E=!1,y="",A=b=null,Ea=null,O=null,Z=d=Ea=null,Ea=n=null;F==B.CHOOSEREGION?(A=v[p],p=$.extend({},{withLabel:!1},w.region),A=e.create("curve",A,p),f=[f[0],f[1]],f.push.apply(f,l),l={name:A.getName()},1==Y&&(l.mapleExpression=ob(f)),Ea=new Q("region",f,l,{}),N[A.id]=Ea):null==r.pt2?null!=q?(p=$.extend({},{withLabel:!1},w.glider.common,w.glider.solid),O=e.create("glider",[f[0],f[1],e.objects[q]],
p),O.on("down",Ta),O.on("drag",La),O.on("up",Ua),Ea=new Q("glider",[O.X(),O.Y(),q],{name:O.getName()},{}),N[O.id]=Ea):(d=e.create("point",f,{withLabel:!1}),d.on("down",Ma),d.on("drag",Na),d.on("up",Va),Z=new Q("point",[d.X(),d.Y()],{name:d.getName()},{}),N[d.id]=Z):F===B.CREATEEXPONENTIAL||F===B.CREATELOGARITHMIC?(l=F===B.CREATEEXPONENTIAL?[f[0]+1,f[1]]:[f[0],f[1]+1],p=$.extend({},{withLabel:!1,fixed:!0},w.line.notSolid),n=e.create("line",[f,l],p),n.on("drag",Wa),n.on("up",h),Ea=new Q("line",[f,l],
{name:n.getName(),solid:"false"},{}),N[n.id]=Ea):(d=e.create("point",f,{withLabel:!1}),d.on("down",Ma),d.on("drag",Na),d.on("up",Va),Z=new Q("point",[d.X(),d.Y()],{name:d.getName()},{}),N[d.id]=Z);F===B.CHOOSEREGION&&(y=A.id,E=!0);F===B.SNIPLEFT&&(ua(q),r.pt1=O,y=k[q].parents,y=ra(y),y.push(r.pt1),0==x.length?(y.push("infinity"),y="parabola"==u?e.create("curve",ga(y),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}):e.create("curve",xa(y),{strokeWidth:w.common.strokeWidth,
strokeColor:w.common.strokeColor,withLabel:!1}),y.on("up",wa),l=new Q("subcurve",[q,r.pt1.id,"infinity"],{name:y.getName()},{}),N[y.id]=l,y=y.id,E=!0):(f=x[0],b=e.objects[f].getAttribute("strokeColor"),l=k[f].parents[2],y.push(e.objects[l]),y="parabola"==u?e.create("curve",ga(y),{strokeWidth:w.common.strokeWidth,strokeColor:b,withLabel:!1}):e.create("curve",xa(y),{strokeWidth:w.common.strokeWidth,strokeColor:b,withLabel:!1}),y.on("up",wa),l=new Q("subcurve",[q,r.pt1.id,l],{name:y.getName()},{}),N[y.id]=
l,y=y.id,E=!0,b=G(f,null),b=b[0],l=k[b].parents.indexOf(f),k[b].parents[l]=y,delete k[f],e.removeObject(f)));F===B.SNIPRIGHT&&(ua(q),r.pt1=O,y=k[q].parents,y=ra(y),0==x.length?(y.push("-infinity"),y.push(r.pt1),y="parabola"==u?e.create("curve",ga(y),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}):e.create("curve",xa(y),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}),y.on("up",wa),l=new Q("subcurve",[q,"-infinity",r.pt1.id],{name:y.getName()},
{}),N[y.id]=l,y=y.id,E=!0):(f=x[0],b=e.objects[f].getAttribute("strokeColor"),x=k[f].parents[1],y.push(e.objects[x]),y.push(r.pt1),y="parabola"==u?e.create("curve",ga(y),{strokeWidth:w.common.strokeWidth,strokeColor:b,withLabel:!1}):e.create("curve",xa(y),{strokeWidth:w.common.strokeWidth,strokeColor:b,withLabel:!1}),y.on("up",wa),l=new Q("subcurve",[q,x,r.pt1.id],{name:y.getName()},{}),N[y.id]=l,y=y.id,E=!0,b=G(f,null),b=b[0],l=k[b].parents.indexOf(f),k[b].parents[l]=y,delete k[f],e.removeObject(f)));
F===B.SNIPBETWEEN&&(null===r.pt1?r.pt1=O:(ua(q),r.pt2=O,r.pt1.X()>r.pt2.X()&&(x=r.pt1,r.pt1=r.pt2,r.pt2=x),x=k[q].parents,x=ra(x),x.push("-infinity"),x.push(r.pt1),x="parabola"==u?e.create("curve",ga(x),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}):e.create("curve",xa(x),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}),x.on("up",wa),y=new Q("subcurve",[q,"-infinity",r.pt1.id],{name:x.getName()},{}),N[x.id]=y,y=k[q].parents,y=ra(y),
y.push(r.pt2),y.push("infinity"),u="parabola"==u?e.create("curve",ga(y),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}):e.create("curve",xa(y),{strokeWidth:w.common.strokeWidth,strokeColor:w.common.strokeColor,withLabel:!1}),u.on("up",wa),q=new Q("subcurve",[q,r.pt2.id,"infinity"],{name:u.getName()},{}),N[u.id]=q,y=[x.id,u.id],E=!0));F===B.CREATE&&(y=d.id,E=!0);F===B.CREATEDROPLINEPOINT&&(Z=N[d.id],Z.attributes.droplines=!0,Xa(d),y=d.id,E=!0);if(F===B.CREATELINE)null===
r.pt1?r.pt1=d:null===r.pt2&&(r.pt2=d,H=e.create("line",[r.pt1,r.pt2],{withLabel:!1}),H.on("drag",Wa),H.on("up",h),R=new Q("line",H.parents,{name:H.getName()},{}),N[H.id]=R,y=H.id,E=!0);else if(F===B.CREATEABSOLUTEVALUE)if(null===r.pt1)r.pt1=d;else{if(null===r.pt2){r.pt2=d;var ha=r.pt1,Z=r.pt2,p=$.extend({},{withLabel:!1},w.common);H=e.create("curve",[function(a){return a},function(a){return(Z.Y()-ha.Y())/Math.abs(Z.X()-ha.X())*Math.sqrt(Math.pow(a-ha.X(),2))+ha.Y()},function(){return e.getBoundingBox()[0]},
function(){return e.getBoundingBox()[2]}],p);H.addParents([r.pt1,r.pt2]);H.on("drag",I);H.on("up",C);R=new Q("absolutevalue",[r.pt1.id,r.pt2.id],{name:H.getName()},{});N[H.id]=R;y=H.id;E=!0}}else F===B.CREATEPARABOLA?null===r.pt1?r.pt1=d:null===r.pt2&&(r.pt2=d,p=$.extend({},{withLabel:!1},w.common),R=e.create("curve",ga([r.pt1,r.pt2]),p),R.addParents([r.pt1,r.pt2]),R.on("drag",z),R.on("up",M),H=new Q("parabola",[r.pt1.id,r.pt2.id],{name:R.getName()},{}),N[R.id]=H,y=R.id,E=!0):F===B.CREATETHREEPOINTPARABOLA||
F===B.CREATETHREEPOINTPARABOLASEG?null===r.pt1?r.pt1=d:null===r.pt2?r.pt2=d:null===r.pt3&&(r.pt3=d,F===B.CREATETHREEPOINTPARABOLASEG&&(R=hb([r.pt1,r.pt2,r.pt3]),H=[R[0].id,R[1].id]),p=$.extend({},{withLabel:!1},w.common),R=e.create("curve",ga([r.pt1,r.pt2,r.pt3],R),p),R.addParents([r.pt1,r.pt2,r.pt3]),R.on("drag",z),R.on("up",M),H=new Q("parabola",[r.pt1.id,r.pt2.id,r.pt3.id],{name:R.getName()},{},H),N[R.id]=H,y=R.id,E=!0):F===B.CREATEEXPONENTIAL?null===r.pt1?r.pt1=d:null===r.pt2?r.pt2=d:null===r.ln1&&
(r.ln1=n,p=$.extend({},{withLabel:!1},w.common),H=e.create("curve",Ya([r.pt1,r.pt2,r.ln1]),p),H.addParents([r.pt1,r.pt2]),H.addParents(ra(r.ln1.getParents())),H.on("drag",W),H.on("up",ia),R=new Q("exponential",[r.pt1.id,r.pt2.id,r.ln1.id],{name:H.getName()},{}),N[H.id]=R,y=H.id,E=!0):F===B.CREATELOGARITHMIC&&(null===r.pt1?r.pt1=d:null===r.pt2?r.pt2=d:null===r.ln1&&(r.ln1=n,p=$.extend({},{withLabel:!1},w.common),H=e.create("curve",Za([r.pt1,r.pt2,r.ln1]),p),H.addParents([r.pt1,r.pt2]),H.addParents(ra(r.ln1.getParents())),
H.on("drag",ca),H.on("up",S),R=new Q("logarithmic",[r.pt1.id,r.pt2.id,r.ln1.id],{name:H.getName()},{}),N[H.id]=R,y=H.id,E=!0));if(E){E=!1;for(D in N)k[D]=N[D];D=k.topGroup.parents;if(F==B.CHOOSEREGION){if(null==a)for(c=k[y].parents.slice(2,k[y].parents.length),a=0;a<c.length;a++)D.splice(D.indexOf(c[a]),1);else e.removeObject(e.objects[a]),k.topGroup.parents.splice(k.topGroup.parents.indexOf(a),1),delete k[a];D.push(y)}else if(pa(null),null==b)if(k.hasOwnProperty("topGroup")||(k.topGroup=new Q("topGroup",
[],{name:"Top-level Group"},{})),0==D.length?(c=ja(),D.push(y)):-1==ta?y instanceof Array||"subcurve"==k[y].elementType?(y instanceof Array?(D.push.apply(D,y),b=k[y[0]].parents[0]):(D.push(y),b=k[y].parents[0]),H=D.indexOf(b),-1<H&&D.splice(H,1),c=e.objects[b].getAttribute("strokeColor")):(D.push(y),c=ja()):0==ta?y instanceof Array||"subcurve"==k[y].elementType?(y instanceof Array?(D.push.apply(D,y),b=k[y[0]].parents[0]):(D.push(y),b=k[y].parents[0]),H=D.indexOf(b),-1<H&&D.splice(H,1),c=e.objects[b].getAttribute("strokeColor")):
(D.push(y),c=ja()):1==ta&&(b=D[0],a=k[b],"grouping"==a.elementType?(c=e.objects[a.parents[0]].getAttribute("strokeColor"),y instanceof Array||"subcurve"==k[y].elementType?(y instanceof Array?(a.parents.push.apply(a.parents,y),b=k[y[0]].parents[0]):(a.parents.push(y),b=k[y].parents[0]),H=a.parents.indexOf(b),-1<H&&a.parents.splice(H,1)):a.parents.push(y)):(c=e.objects[b].getAttribute("strokeColor"),y instanceof Array||"subcurve"==k[y].elementType?y instanceof Array?(a=new Q("grouping",y,{name:"grouping0"},
{}),k.grouping0=a,D[0]="grouping0"):D[0]=y:(a=new Q("grouping",[b,y],{name:"grouping0"},{}),k.grouping0=a,D[0]="grouping0"))),ub(N,c),y instanceof Array)for(a=0;a<y.length;a++)e.objects[y[a]].setAttribute({strokeColor:c});else e.objects[y].setAttribute({strokeColor:c}),"point"==k[y].elementType&&e.objects[y].setAttribute({fillColor:c});g===html5Ques.MODE.EDITABLE&&da();cb(!1);eb(F).attr("class","mode_off");F=B.UNSET}}}},Ha=function(a,b){var c=[],d=b.topGroup.parents;if(0<d.length)for(var h=0;h<d.length;h++)b[d[h]].elementType==
a&&c.push(d[h]);return c},D=function(a,b){if("undefined"!==typeof a&&null!=a&&a!={}){var c={},d;for(d in a){var h=a[d];h.elementType==b&&(c[d]=h)}return c}},aa={response:{common:{strokeWidth:"2",strokeColor:"#0000ff",fixed:!1},glider:{common:{strokeWidth:"2",strokeColor:"#008000",size:3},solid:{fillColor:"#008000"},notSolid:{fillColor:"#f5f5f5"}},point:{common:{strokeWidth:"2",strokeColor:"#ff0000",size:3},solid:{fillColor:"#ff0000"},notSolid:{fillColor:"#f5f5f5"}},line:{solid:{dash:0},notSolid:{dash:3}},
region:{strokeOpacity:0,fillColor:"green",fillOpacity:.2,highlight:!1}},givenCurves:{common:{strokeWidth:"1",strokeColor:"#333333",fixed:!1},glider:{common:{strokeWidth:"2",strokeColor:"#333333",size:3},solid:{fillColor:"#333333"},notSolid:{fillColor:"#f5f5f5"}},point:{common:{strokeWidth:"2",strokeColor:"#333333",size:3},solid:{fillColor:"#333333"},notSolid:{fillColor:"#f5f5f5"}},line:{solid:{dash:0},notSolid:{dash:3}}}},ya=function(a,b){var c=JSON.parse(JSON.stringify(a.attributes)),d=a.elementType;
c.withLabel=!1;var h=aa;c.strokeWidth=h[b].common.strokeWidth;c.strokeColor=h[b].common.strokeColor;c.fixed=h[b].common.fixed;"glider"==d?(c.strokeWidth=h[b].glider.common.strokeWidth,c.strokeColor=h[b].glider.common.strokeColor,c.size=h[b].glider.common.size,d=c.hasOwnProperty("solid")&&"true"!=c.solid?"notSolid":"solid",c.fillColor=h[b].glider[d].fillColor,delete c.solid,c.disableMe&&(c.visible=!1)):"point"==d?(c.strokeWidth=h[b].point.common.strokeWidth,c.strokeColor=h[b].point.common.strokeColor,
c.size=h[b].point.common.size,d=c.hasOwnProperty("solid")&&"true"!=c.solid?"notSolid":"solid",c.fillColor=h[b].point[d].fillColor,delete c.solid,c.disableMe&&(c.visible=!1)):"line"==d?(d=c.hasOwnProperty("solid")&&"true"!=c.solid?"notSolid":"solid",c.dash=h[b].line[d].dash,delete c.solid,c.disableMe&&(c.fixed=!0)):"region"==d?(c.strokeOpacity=h[b].region.strokeOpacity,c.fillColor=h[b].region.fillColor,c.fillOpacity=h[b].region.fillOpacity,c.highlight=h[b].region.highlight,c.hasOwnProperty("mapleExpression")&&
delete c.mapleExpression):"subcurve"==d&&(c.fixed=!0);"givenCurves"==b&&g!==html5Ques.MODE.EDITABLE&&(c.highlight=!1,c.fixed=!0);delete c.disableMe;return c},w=function(a){return k.hasOwnProperty(a)?["response",k]:t.hasOwnProperty(a)?["givenCurves",t]:["",{}]},ib=function(a,b,c,d){if("undefined"!==typeof a&&null!=a&&a!={}){var f={},q=function(a){if("undefined"!==typeof a&&null!=a&&0<a.length)for(var b=0;b<a.length;b++){var c=a[b];c instanceof Array||!f.hasOwnProperty(c)||(a[b]=f[c])}},n=function(a){var b=
[];if("undefined"!==typeof a&&null!=a&&0<a.length)for(var c=0;c<a.length;c++){var d=a[c];b[c]=d;d instanceof Array||!e.objects.hasOwnProperty(d)||(b[c]=e.objects[d])}return b},k,x,u,p,l=[];p=-1;var w,r;if(g!==html5Ques.MODE.EDITABLE)for(u=la(a),x=0;x<u.parents.length;x++)if(r=a[u.parents[x]],("givenCurves"==c||r.hasOwnProperty("link"))&&"point"!=r.elementType)for(k=0;k<r.parents.length;k++){var E=a[r.parents[k]];"point"==E.elementType||"glider"==E.elementType?E.attributes.disableMe=!0:"line"==E.elementType&&
E.parents[0]instanceof Array&&E.parents[1]instanceof Array&&(E.attributes.disableMe=!0)}u=D(a,"point");for(var t in u)k=u[t],x=ya(k,c),x=e.create("point",k.parents,x),x.on("down",Ma),x.on("drag",Na),x.on("up",Va),k.attributes&&1==k.attributes.droplines&&Xa(x),k.attributes.name=k.attributes.hasOwnProperty("name")?k.attributes.name:x.getName(),b[x.id]=k,f[t]=x.id;r=D(a,"line");for(t in r)u=r[t],q(u.parents),k=n(u.parents),x=ya(u,c),x=e.create("line",k,x),x.on("drag",Wa),x.on("up",h),u.attributes.name=
u.attributes.hasOwnProperty("name")?u.attributes.name:x.getName(),b[x.id]=u,f[t]=x.id;r=D(a,"absolutevalue");for(t in r)u=r[t],q(u.parents),k=n(u.parents),x=ya(u,c),x=e.create("curve",gb(k),x),x.addParents(k),x.on("drag",I),x.on("up",C),u.attributes.name=u.attributes.hasOwnProperty("name")?u.attributes.name:x.getName(),b[x.id]=u,f[t]=x.id;r=D(a,"parabola");for(t in r)u=r[t],q(u.parents),k=n(u.parents),u.domain&&(q(u.domain),w=n(u.domain)),x=ya(u,c),x=e.create("curve",ga(k,w),x),x.addParents(k),x.on("drag",
z),x.on("up",M),u.attributes.name=u.attributes.hasOwnProperty("name")?u.attributes.name:x.getName(),b[x.id]=u,f[t]=x.id;u=D(a,"glider");for(t in u)w=u[t],q(w.parents),k=n(w.parents),x=ya(w,c),x=e.create("glider",k,x),x.on("down",Ta),x.on("drag",La),x.on("up",Ua),b[x.id]=w,f[t]=x.id;u=D(a,"subcurve");for(t in u)w=u[t],q(w.parents),k=n(w.parents),r=w.parents[0],underlyingCurveParents=b[r].parents,k=[e.objects[underlyingCurveParents[0]],e.objects[underlyingCurveParents[1]],k[1],k[2]],x=ya(w,c),r=b[r].elementType,
x="parabola"==r?e.create("curve",ga(k),x):e.create("curve",xa(k),x),x.on("up",wa),b[x.id]=w,f[t]=x.id;u=D(a,"exponential");for(t in u)w=u[t],q(w.parents),k=n(w.parents),x=ya(w,c),x=e.create("curve",Ya(k),x),x.addParents(k.slice(0,2)),x.addParents(ra(k[2].getParents())),x.on("drag",W),x.on("up",ia),w.attributes.name=w.attributes.hasOwnProperty("name")?w.attributes.name:x.getName(),b[x.id]=w,f[t]=x.id;u=D(a,"logarithmic");for(t in u)w=u[t],q(w.parents),k=n(w.parents),x=ya(w,c),x=e.create("curve",Za(k),
x),x.addParents(k.slice(0,2)),x.addParents(ra(k[2].getParents())),x.on("drag",ca),x.on("up",S),w.attributes.name=w.attributes.hasOwnProperty("name")?w.attributes.name:x.getName(),b[x.id]=w,f[t]=x.id;k=D(a,"region");if(!za(k))for(t in k)n=k[t],q(n.parents),0==Y&&n.attributes.hasOwnProperty("mapleExpression")&&delete n.attributes.mapleExpression,p=n.parents.slice(0,2),l=n.parents.slice(2,n.parents.length),v=pb(l),p=bb(p),-1!=p&&(x=ya(n,c),x=e.create("curve",v[p],x),b[x.id]=n,f[t]=x.id);x=D(a,"grouping");
for(t in x)n=x[t],q(n.parents),b[t]=n;t=null;a.hasOwnProperty("topGroup")?(t=a.topGroup,q(t.parents)):t=new Q("topGroup",[],{name:"Top-level Group"},{});d?(a=la(b),a.parents.push.apply(a.parents,t.parents)):b.topGroup=t;if("response"==c)if(c="#000000",-1!=p)for(x=0;x<l.length;x++)c=ja(),e.objects[l[x]].setAttribute({strokeColor:c});else if(l=b.topGroup.parents,d&&"grouping0"!=l[0]&&(l=t.parents),0<l.length)for(x=0;x<l.length;x++)if(a=l[x],c=ja(),"grouping"!=b[a].elementType)e.objects[a].setAttribute({strokeColor:c}),
"point"==b[a].elementType?e.objects[a].setAttribute({fillColor:c}):"exponential"==b[a].elementType||"logarithmic"==b[a].elementType?(a=b[a].parents[2],e.objects[a].setAttribute({strokeColor:c})):"subcurve"==b[a].elementType&&(a=b[a].parents[0],ua(a));else if(p=b[a].parents,d&&(p=t.parents),0<p.length)for(k=0;k<p.length;k++)a=p[k],e.objects[a].setAttribute({strokeColor:c}),"point"==b[a].elementType?e.objects[a].setAttribute({fillColor:c}):"exponential"==b[a].elementType||"logarithmic"==b[a].elementType?
(a=b[a].parents[2],e.objects[a].setAttribute({strokeColor:c})):"subcurve"==b[a].elementType&&(a=b[a].parents[0],ua(a))}},qb=function(){var a=!1,b;for(b in t){var c=t[b];c.hasOwnProperty("link")&&(a=!0,ua(b,.4),c=c.link.linkToName,null==Pa(c,k)&&qa(b,c))}return a},cb=function(a){var b=null,c;for(c in r)b=r[c],null!=b&&(r[c]=null,a&&e.removeObject(b));N={}},yb=function(a){for(var b=[[],[]],c=0;c<a.length;c++)b[0].push(a[c][0]),b[1].push(a[c][1]);return b},ob=function(a){var b="",c=[];if(3<=a.length){b=
a.slice(0,2);a=a.slice(2,a.length);for(var d=0;d<a.length;d++){var h;h=a[d];var f=e.getBoundingBox();lineIn=k[h];lineOut=[];h="nonstrict";lineIn.attributes.hasOwnProperty("solid")&&"false"==lineIn.attributes.solid&&(h="strict");lineOut.push(h);var g=lineIn.parents;h=k[g[0]].parents;var g=k[g[1]].parents,C=(g[1]-h[1])/(g[0]-h[0]),z=void 0,f=(f[1]-f[3])/(f[2]-f[0])*C;150<Math.abs(f)?lineOut.push((h[0]+g[0])/2):Math.abs(f)<1/150?(z=(h[1]+g[1])/2,lineOut.push(0,z)):(z=h[1]-C*h[0],lineOut.push.apply(lineOut,
[C,z]));h=lineOut;f="";f=h[0];g=void 0;g=b[0];z=b[1];3==h.length?(C=h[1],h=h[2],g=z<=C*g+h?"\x3c":"\x3e",g="strict"==f?g:g+"\x3d",f=0!=C?"y"+g+"("+C+")*x + ("+h+")":"y"+g+"("+h+")"):(h=h[1],g=g<=h?"\x3c":"\x3e",g="strict"==f?g:g+"\x3d",f="x"+g+"("+h+")");c.push(f)}b=c.join(",")}return"Grading:-Inequalities(["+b+"])"},pa=function(a,b){if("response"==(b?w(b)[0]:"response")){var c=a;null==c&&(c=Ha("region",k),c=0==c.length?null:c[0]);if(null!=c){for(var d=k[c].parents.slice(2,k[c].parents.length),h=
0;h<d.length;h++)k.topGroup.parents.push(d[h]);e.removeObject(e.objects[c]);k.topGroup.parents.splice(k.topGroup.parents.indexOf(c),1);delete k[c]}}},bb=function(a){var b=-1;if(null!=v&&0<v.length)for(var c=0;c<v.length;c++){var d;a:{var h=v[c];d=h[0];var h=h[1],e=d.length;if(h.length!=e)d=!1;else{for(var f=0;f<e;f++){var g=f==e-1?0:f+1,C=[d[f],h[f]],g=[d[g],h[g]],g=[g[0]-C[0],g[1]-C[1]],C=[C[0]-a[0],C[1]-a[1]];if(0>=g[0]*C[1]-g[1]*C[0]){d=!1;break a}}d=!0}}if(d){b=c;break}}return b},db=function(a){a=
new JXG.Coords(JXG.COORDS_BY_USER,a,e);return[a.scrCoords[1],a.scrCoords[2]]},pb=function(a){var b=[],c=e.getBoundingBox(),d=c[0],h=c[2],f=c[3],g=c[1],C=a,C=null==a?Ha("line",k):C;if(0<C.length){var z={A:[c[0],c[1]],B:[c[2],c[1]],C:[c[2],c[3]],D:[c[0],c[3]]},I=["A","B","C","D"],u=["A","B","C","D","A"],n=["AB","BC","CD","DA"],q={AB:e.create("line",[z.A,z.B],{visible:!1}),BC:e.create("line",[z.B,z.C],{visible:!1}),CD:e.create("line",[z.C,z.D],{visible:!1}),DA:e.create("line",[z.D,z.A],{visible:!1})},
M=["I","H","G","F","E"],w=function(a,b){var c=u.indexOf("A"),d=u.indexOf("B"),h=u.indexOf("C"),f=u.indexOf("D"),e=b.slice(0,1),m=b.slice(1,2),e=u.indexOf(e),g=m=u.lastIndexOf(m);if(m>e+1)for(g=e+1;!(!(g<=m)||e==c&&z[u[g]][0]>z[a][0]||e==d&&z[u[g]][1]<z[a][1]||e==h&&z[u[g]][0]<z[a][0]||e==f&&z[u[g]][1]>z[a][1]);g++);u.splice(g,0,a)},p=function(a,b,c){for(var m=0;m<c.length;m++){var C=c[m],u=q[C],k=e.create("intersection",[a,u,0],{visible:!1}),I=db([k.X(),k.Y()]);if(u.hasPoint(I[0],I[1]))if(("AB"==
C||"CD"==C)&&k.X()>d&&k.X()<h){if(u=M.pop(),z[u]=[k.X(),k.Y()],b.push(u),w(u,C),2==b.length)break}else if(("BC"==C||"DA"==C)&&k.Y()>f&&k.Y()<g&&(u=M.pop(),z[u]=[k.X(),k.Y()],b.push(u),w(u,C),2==b.length))break;e.removeObject(k)}},l=function(a,b){for(var c=0;c<I.length;c++){var d=I[c],h=db(z[d]);a.hasPoint(h[0],h[1])&&b.push(d)}2!=b.length&&(1==b.length?(c=b[0],d=[],"A"==c?d=["BC","CD"]:"B"==c?d=["CD","DA"]:"C"==c?d=["DA","AB"]:"D"==c&&(d=["AB","BC"]),p(a,b,d)):0==b.length&&(c=n,p(a,b,c)))},r=function(a,
b){for(var c=[],d=u.length-1,h=a;h!=b;)c.push(u[h]),h=h==d-1?0:h+1;c.push(u[b]);return c},D=function(a){for(var b=[],c=0;c<a.length;c++)b.push(z[a[c]]);return b},t=function(a){var c=a[1];a=u.indexOf(a[0]);var d=u.indexOf(c),c=r(a,d);a=r(d,a);c=D(c);a=D(a);b.push(c);b.push(a)},S=function(a,b){var c=!1,d=b[1],h=u.indexOf(b[0]),d=u.indexOf(d);-1<r(h,d).indexOf(a)&&(c=!0);return c},E=function(a,c){var d=a.indexOf(c[0]),h=0;-1==d&&(d=a.indexOf(c[1]),h=1);var e=a[d],d=a[1-d],f=c[1-h],m=d,h=f;S(h,[e,m])&&
(m=f,h=d);d=u.indexOf(e);m=u.indexOf(m);f=u.indexOf(h);h=r(d,m);m=r(m,f);m.push(e);e=r(f,d);h=D(h);m=D(m);e=D(e);b.push(h);b.push(m);b.push(e)};a=function(a,c){var d=a[0],h=a[1],e=c[0],f=c[1],m=d,g=h,C=e,z=f;if(S(e,[d,h])||S(f,[d,h]))m=h,g=d;if(S(d,[e,f])||S(h,[e,f]))C=f,z=e;d=u.indexOf(m);g=u.indexOf(g);C=u.indexOf(C);h=u.indexOf(z);z=r(d,g);g=r(g,C);d=r(h,d);g.push.apply(g,d);C=r(C,h);z=D(z);g=D(g);C=D(C);b.push(z);b.push(g);b.push(C)};var c=function(a,c,d){var h=M.pop();z[h]=[d[0],d[1]];d=a[0];
a=a[1];var e=c[0],f=c[1],m=e;c=f;S(e,[a,d])&&(m=f,c=e);d=u.indexOf(d);a=u.indexOf(a);e=u.indexOf(m);m=u.indexOf(c);c=r(d,e);e=r(e,a);a=r(a,m);d=r(m,d);c.push(h);e.push(h);a.push(h);d.push(h);c=D(c);e=D(e);a=D(a);d=D(d);b.push(c);b.push(e);b.push(a);b.push(d)},v=e.objects[C[0]],W=[];l(v,W);W.sort();if(1==C.length)2==W.length&&t(W);else{var C=e.objects[C[1]],ia=[],ca=[];l(C,ia);for(l=0;l<ia.length;l++){var O=ia[l],B=db(z[O]);-1==I.indexOf(O)&&v.hasPoint(B[0],B[1])?(delete z[O],O=u.indexOf(O),u.splice(O,
1),ca.push(u[O])):ca.push(O)}ca.sort();0==W.length||0==ca.length?2!=W.length&&2!=ca.length||t(2==W.length?W:ca):ca[0]==W[0]&&ca[1]==W[1]?t(W):-1<W.indexOf(ca[0])||-1<W.indexOf(ca[1])?E(W,ca):(t=e.create("intersection",[C,v,0],{visible:!1}),E=[t.X(),t.Y()],ia=db(E),!v.hasPoint(ia[0],ia[1])||!C.hasPoint(ia[0],ia[1])||E[0]<d||E[0]>h||E[1]<f||E[1]>g?a(W,ca):c(W,ca,E),e.removeObject(t))}for(l=0;l<b.length;l++)b[l]=yb(b[l]);e.removeObject(q.AB);e.removeObject(q.BC);e.removeObject(q.CD);e.removeObject(q.DA)}return b},
rb=function(a,b){var c=a[b],d=c.range[1]-c.range[0],h=a.x.range,e=a.y.range,f;"x"==b?(f=(3+(1+Math.floor(Math.log(Math.abs(Math.max(Math.abs(h[0]),Math.abs(h[1]))))/Math.LN10)))/2*8,0==h[0]&&(f=Math.max(f,8*((0<=e[0]?1.25:2.25)+(1+Math.floor(Math.log(Math.abs(Math.max(Math.abs(e[0]),Math.abs(e[1]))))/Math.LN10)))))):(f=16.5,0==e[0]&&(f=27.5));d*=f/(450-2*f);return[c.range[0]-d,c.range[1]+d]},zb=function(a,b){var c=rb(a,"x"),d=rb(a,"y");return JXG.JSXGraph.initBoard(b,{boundingbox:[c[0],d[1],c[1],
d[0]],axis:!1,grid:!1,showNavigation:!1,showCopyright:!1})},sb=function(a,b){var c=a[b],d=(c.range[1]-c.range[0])/c.ticks[0],h=d/c.ticks[1],f=e.create("axis","x"==b?[[0,0],[1,0]]:[[0,0],[0,1]],{strokeColor:"#25383C",highlight:!1,needsRegularUpdate:!1});f.removeAllTicks();var g="x"==b?[0,1]:[1,0],C="x"==b?[0,-6]:[-6,0],u="x"==b?"middle":"right",z="x"==b?"top":"middle",k,I;k=[];for(var q=0;q<=c.ticks[0];q++)I=c.range[0]+q*d,0!=I&&k.push(I);e.create("ticks",[f,k],{tickEndings:g,majorHeight:12,strokeWidth:1,
strokeColor:"#666666",strokeOpacity:.75,highlight:!1,drawLabels:!0,needsRegularUpdate:!1,label:{offset:C,highlight:!1,needsRegularUpdate:!1,anchorX:u,anchorY:z}});k=[];for(q=0;q<=c.ticks[0]*c.ticks[1];q++)I=c.range[0]+q*h,0!=q%c.ticks[1]&&k.push(I);e.create("ticks",[f,k],{tickEndings:g,majorHeight:6,strokeWidth:1,strokeColor:"#666666",strokeOpacity:.75,highlight:!1,drawLabels:!1,needsRegularUpdate:!1,label:{offset:C,highlight:!1,needsRegularUpdate:!1,anchorX:u,anchorY:z}});if(a.showGridlines)for(q=
0;q<=c.ticks[0]*c.ticks[1];q++)d=c.range[0]+q*h,e.create("line","x"==b?[[d,0],[d,1]]:[[0,d],[1,d]],{strokeWidth:1,strokeColor:"#666666",strokeOpacity:0!=q%c.ticks[1]?.1:.3,highlight:!1,fixed:!0,needsRegularUpdate:!1})},Ab=function(a){sb(a,"x");sb(a,"y");a=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],e);a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a.scrCoords[1]-6,a.scrCoords[2]+6],e);e.create("text",[a.usrCoords[1],a.usrCoords[2],"0"],{anchorX:"right",anchorY:"top",highlight:!1,fixed:!0,needsRegularUpdate:!1})},
ea=function(a){cb(!0);var b=a.attr("name").toUpperCase();if(F==B[b])F=B.UNSET,a.attr("class","mode_off");else{for(var c in B)c!=b&&"create"!=c.toLowerCase()&&(U||-1<$.inArray(c.toLowerCase(),K))&&q.find("button[name\x3d'"+c.toLowerCase()+"']").attr("class","mode_off");F=B.UNSET;var d=a.attr("name");c=!1;if(fa.hasOwnProperty(d)){var h=fa[d],e;e=k;if("undefined"!==typeof e&&null!=e&&e!={}&&e.hasOwnProperty("topGroup")&&0!=e.topGroup.parents.length){var f="grouping0"==e.topGroup.parents[0]?e.grouping0:
e.topGroup,g=d=d.slice(6);if(""==d||"droplinepoint"==d)g="point";else if("threepointparabola"==d||"threepointparabolaseg"==d)g="parabola";for(var C=0,u=0;u<f.parents.length;u++){var z=e[f.parents[u]];z.elementType!=g||z.hasOwnProperty("link")||("point"==g?("droplinepoint"==d&&1==z.attributes.droplines||""==d&&1!=z.attributes.droplines)&&C++:"parabola"==g?("threepointparabola"==d&&3==z.parents.length&&2!=_.intersection(z.domain,z.parents).length||"threepointparabolaseg"==d&&3==z.parents.length&&2==
_.intersection(z.domain,z.parents).length||"parabola"==d&&2==z.parents.length)&&C++:C++)}e=C}else e=0;e>=h&&(c=!0)}c||(F=B[b],a.attr("class","mode_on"))}},tb=function(a){if("undefined"===typeof a||null==a||a=={}||"undefined"===typeof a.sketchElements||null==a.sketchElements||0==a.sketchElements.length)return{};var b={};a=a.sketchElements;for(var c,d,h=0;h<a.length;h++)c=JSON.parse(JSON.stringify(a[h])),d=c.id,delete c.id,b[d]=c;return b},mb=function(a){if("undefined"===typeof a||null==a||a=={})return{sketchElements:[]};
var b={sketchElements:[]},c;for(c in a){var d=JSON.parse(JSON.stringify(a[c]));d.id=c;b.sketchElements.push(d)}return b};this.validateSketch=function(a){var b="response"==a?"answer":"given curves",c;a="response"==a?k:t;var d=["solid","false"];if("undefined"===typeof a||null==a||a=={})c=void 0;else{var h={};for(c in a){var e=a[c];"line"==e.elementType&&e.attributes.hasOwnProperty(d[0])&&e.attributes[d[0]]==d[1]&&(h[c]=e)}c=h}if(null!=c)for(var f in c)if(0==G(f,"exponential").length&&0==G(f,"logarithmic").length&&
0==G(f,"region").length)return"Invalid "+b+": Dashed line without region";return""};this.getGivenCurves=function(){var a=mb(t);return JSON.stringify(a)};this.getResponse=function(){cb(!0);var a=mb(k);return JSON.stringify(a)};this.getBoard=function(){return e};this.hasEmptyResponse=function(){return!1};this.sameResponse=function(){return!1};(function(a,b,c,d,h,f){var g=[],C={},z=[],u={},I=!0,n="true",M={};K=["all"];ta=-1;var w=[],l=0,p=null;if("undefined"!==typeof h){try{var r="object"==typeof h?
h:JSON.parse(h),C=r.axes,u=r.ticks,n=r.grid,M=r.options}catch(D){C={},u={},n="true",M={}}try{var S=C.split(/\s*,\s*/);if(4!=S.length)throw Error();for(var E=0;E<S.length;E++)if(isNaN(S[E])||""==S[E])throw Error();g[0]=parseFloat(S[0]);g[1]=parseFloat(S[1]);g[2]=parseFloat(S[2]);g[3]=parseFloat(S[3])}catch(D){g=[]}try{S=u.split(/\s*,\s*/);if(4!=S.length)throw Error();for(E=0;E<S.length;E++)if(!/^[1-9]\d*$/.test(S[E]))throw Error();z[0]=parseFloat(S[0]);z[1]=parseFloat(S[1]);z[2]=parseFloat(S[2]);z[3]=
parseFloat(S[3])}catch(D){z=[]}try{I=n&&"false"!==n.toLowerCase()}catch(D){I=!0}try{if(1>M.visible_buttons.length)K=["all"],fa=$.extend({},ba);else{K=[];for(var v=M.visible_buttons.split(/\s*,\s*/),E=0;E<v.length;E++){var W=v[E].split(":"),ia=W[0];K.push(ia);if(fa.hasOwnProperty(ia)&&1<W.length){var ca=parseFloat(W[1]);fa[ia]=ca}}}}catch(D){K=["all"],fa=$.extend({},ba)}try{if(M.hasOwnProperty("targetGroup")){var O=parseFloat(M.targetGroup);if(-1==O||0==O||1==O)ta=O}else ta=-1}catch(D){ta=-1}try{w=
M.hasOwnProperty("background_functions")&&0<M.background_functions.length?M.background_functions.split(/\s*;\s*/):[]}catch(D){w=[]}}q=c;if(d===html5Ques.MODE.EDITABLE||d===html5Ques.MODE.INTERACTIVE){d===html5Ques.MODE.EDITABLE&&(K=["all"],fa=$.extend({},ba),Y=!0);U=!1;-1<$.inArray("all",K)&&(U=!0);but=q.find("button[name\x3d'createdroplinepoint']");U||-1<$.inArray("createdroplinepoint",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:
null):but.addClass("hidden");but=q.find("button[name\x3d'createline']");U||-1<$.inArray("createline",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createabsolutevalue']");U||-1<$.inArray("createabsolutevalue",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createparabola']");
U||-1<$.inArray("createparabola",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createthreepointparabola']");U||-1<$.inArray("createthreepointparabola",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createthreepointparabolaseg']");U||-1<$.inArray("createthreepointparabolaseg",
K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createexponential']");U||-1<$.inArray("createexponential",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'createlogarithmic']");U||-1<$.inArray("createlogarithmic",K)?(but.on("click",function(a){a.preventDefault?a.preventDefault():
a.returnValue=!1;ea($(this))}),p=1==++l?but:null):but.addClass("hidden");but=q.find("button[name\x3d'chooseregion']");if(U||-1<$.inArray("chooseregion",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'snipleft']");if(U||-1<$.inArray("snipleft",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'snipright']");
if(U||-1<$.inArray("snipright",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'snipbetween']");if(U||-1<$.inArray("snipbetween",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'togglefilled']");if(U||-1<$.inArray("togglefilled",K))but.on("click",function(a){a.preventDefault?a.preventDefault():
a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'togglesoliddashed']");if(U||-1<$.inArray("togglesoliddashed",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'togglebuildtransform']");if(U||-1<$.inArray("togglebuildtransform",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});but=q.find("button[name\x3d'delete']");
if(U||-1<$.inArray("delete",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;ea($(this))});else but.addClass("hidden");but=q.find("button[name\x3d'getResponse']");if(U||-1<$.inArray("getResponse",K))but.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;cb(!0);a=mb(k);a=JSON.stringify(a);$("#sro_id_1").find("span.error").html(a)});else but.addClass("hidden")}else q.find("button").addClass("hidden");JXG.Options.board.minimizeReflow="none";
var E="jxgbox_"+b,B=[];$("#"+E).parents().each(function(){"none"===$(this).css("display")&&(B[B.length]=this,$(this).css("display","initial"))});0==g.length?e=JXG.JSXGraph.initBoard(E,{boundingbox:[-10,10,10,-10],axis:!0,grid:!0,showNavigation:!1,showCopyright:!1}):0==z.length?e=JXG.JSXGraph.initBoard(E,{boundingbox:[g[0],g[3],g[1],g[2]],axis:!0,grid:!0,showNavigation:!1,showCopyright:!1}):(g={x:{range:g.slice(0,2),ticks:z.slice(0,2)},y:{range:g.slice(2),ticks:z.slice(2)},showGridlines:I},e=zb(g,
E),Ab(g));B.forEach(function(a){$(a).hasClass("timed")||$(a).css("display","none")});var A=e.getCoordsTopLeftCorner,F=!1,aa=[];e.getCoordsTopLeftCorner=function(){if(F){if(0<aa.length&&(1===this.mode||2===this.mode))return aa;var a=q.children("div.jxgbox")[0].getBoundingClientRect();return aa=[a.left,a.top]}return A.apply(this)};$("#holder").on("scroll",function(){F=!0});d===html5Ques.MODE.EDITABLE&&Function("/*@cc_on return document.documentMode\x3d\x3d\x3d10@*/")()&&(E=window.navigator.appVersion.indexOf("Windows NT 6."),
0<E&&1<parseInt(window.navigator.appVersion[E+13])&&(F=!0));e.on("down",wb);e.on("up",xb);E=e.getBoundingBox();g=E[0];z=E[2];for(E=0;E<w.length;E++)if(b=w[E].split(":"),I=b[0],b=1==b.length?0:3,-1!=I.indexOf("^"))w[E]=null;else try{e.create("functiongraph",[new Function("x","return "+I+";"),g,z],{strokeWidth:"1",strokeColor:"#000000",highlight:!1,dash:b})}catch(D){w[E]=null}w=w.filter(function(a){return null!==a});$('input[name\x3d"backgroundFunctions"]').val(w.join(";"));t={};var Z;try{Z=JSON.parse(f)}catch(D){Z=
{}}Z=tb(Z);ib(Z,t,"givenCurves");k={};var ha;try{ha=JSON.parse(a)}catch(D){ha={}}ha=tb(ha);ib(ha,k,"response");qb();p=qb()?null:p;V=e.create("point",[0,0],{visible:!1});e.on("update",function(){html5Ques.utils.triggerResponseChangedEvent(this.containerObj,".html5sketch")});d===html5Ques.MODE.LOCKED?e.removeEventHandlers():p&&ea(p)})(b,c,d,g,A,f)}var b={};return{getInstances:function(a){return a in b?b[a]:null},newInstance:function(c,p,l,X,A,f){c=new a(c,p,l,X,A,f);return b[p]=c},destroyInstance:function(a){var c=
b[a];JXG.JSXGraph.freeBoard(c.getBoard());delete c;delete b[a]}}}()});return{initialize:function(){c.initialize();a()}}});
define("questions/fbd/run/js/runFbdQuestionApp",["require","questions/html5/run/js/runHtml5QuestionApp"],function(b,c){var a=_.once(function(){window.html5Ques.fbd=function(){function a(b,c,d,g,A){var f=null,q=null,e="{}",t={},k=null,v=[],Y=null,P=[],T={},na=-1,ja={},J={},K=-1,ba=function(a,b,c){return a+", "+b+", "+c+"\x26deg;"},fa=function(a,b){var c=a.replace(b,""),d=c.lastIndexOf("_"),e=c.substr(0,d),c=c.substr(d+1);return[e,c]},U=function(a,b){return[a[0]+b[0],a[1]+b[1]]},da=function(a){a=180*
a/Math.PI;return a=.5*Math.round(a/.5)},B=function(a,b){var c=a[0],d=a[1],e=b[0],f=b[1],g=Math.min.apply(Math,e),e=Math.max.apply(Math,e),k=Math.min.apply(Math,f),f=Math.max.apply(Math,f);return g<c&&c<e&&k<d&&d<f},F=function(a){var b;a[JXG.touchProperty]?a[JXG.touchProperty][0]?b=q.getMousePosition(a,0):(b=q.getCoordsTopLeftCorner(),a=[a.changedTouches[0].pageX,a.changedTouches[0].pageY],b=[a[0]-b[0],a[1]-b[1]]):b=q.getMousePosition(a);return new JXG.Coords(JXG.COORDS_BY_SCREEN,b,q)},ta=function(a){a=
new JXG.Coords(JXG.COORDS_BY_USER,a,q);return[a.scrCoords[1],a.scrCoords[2]]},Q=function(a,b){var c=a.id;if("ctrlPoint"==b||"endPoint"==b){if(v=[c,b],"ctrlPoint"==b){var d=[a.X(),a.Y()];v.push(d);d=ka(c,0);c=[];if(t.hasOwnProperty("forceList")&&t.forceList.hasOwnProperty("forces"))for(var e=0;e<t.forceList.forces.length;e++){var f=t.forceList.forces[e];t[f].ctrlPoint==d&&c.push(f)}d=[];for(e=0;e<c.length;e++){var f=c[e],g=q.objects[J[f][0]],g=[g.X(),g.Y()];d.push([f,g])}v.push(d)}}else"endLabelBkgd"==
b&&"ctrlPoint"!=v[1]&&"endPoint"!=v[1]?v=[c,b]:"arrow"==b&&"endLabelBkgd"!=v[1]&&"ctrlPoint"!=v[1]&&"endPoint"!=v[1]&&(v=[c,b])},r=function(a,b){if("ctrlPoint"!=v[1]&&"endPoint"!=v[1]){var c=F(a),d=[c.usrCoords[1],c.usrCoords[2]],e=-1,f=null;if(t&&t.forceList)for(var k=t.forceList.forces,n=0;n<k.length;n++){var l=J[k[n]][2],p=l?l.match(/jxgBoard[0-9]+[A-Za-z]+([0-9]+)/):null;if((p=p?p[1]:p)&&p>e){var r=q.objects[l];if(B(d,[r.dataX,r.dataY])||r.hasPoint(c.scrCoords[1],c.scrCoords[2]))e=p,f=l}}f&&Q(q.objects[f],
"endLabelBkgd")}"arrow"!=v[1]&&"endLabelBkgd"!=v[1]&&"endPoint"!=v[1]&&(Da(),"ctrlPoint"==v[1]&&g!==html5Ques.MODE.EDITABLE&&(d=q.objects[v[0]],c=Pa(v[2],!0),d=Ka(d,c,!0),Y=[c,d]))},N=function(a,b){if(g!==html5Ques.MODE.EDITABLE&&"ctrlPoint"==v[1]){za(v[0],0).location.slice(0,2);var c=Y[0],d=F(a);c.setPosition(JXG.COORDS_BY_USER,[d.usrCoords[1],d.usrCoords[2]]);c.setAttribute({})}},Ja=function(a,b){if("endLabelBkgd"==v[1]){var c=v[0];v=[];var c=ga(c,2),d=t[c].ctrlPoint,e=null;ja.hasOwnProperty(c)&&
(e=ja[c]);1!=e&&(f.getForceDiv(d,c).trigger("click"),d=F(a),e=[d.usrCoords[1],d.usrCoords[2]],endLabelBkgd=q.objects[J[c][2]],rect=[endLabelBkgd.dataX,endLabelBkgd.dataY],(B(e,rect)||endLabelBkgd.hasPoint(d.scrCoords[1],d.scrCoords[2]))&&endLabelBkgd.setAttribute({strokeColor:"#C3D9FF",fillColor:"purple",strokeOpacity:.35,fillOpacity:.35}))}},oa=function(a){for(var b=-1,c=0;c<P.length;c++)if(P[c].id==a){b=c;break}return b},V=function(a){a=oa(a);return P[a]},ka=function(a,b){var c=-1,d;for(d in T)if(T[d][b]==
a){c=d;break}return c},za=function(a,b){var c=ka(a,b);return V(c)},eb=function(a,b){var c=ka(this.id,0);q.objects[T[c][2]].setText("")},ra=function(a,b){var c=za(this.id,0);q.objects[T[c.id][2]].setText(c.name);q.update();try{window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}catch(d){}},Fa=function(a,b){Q(this,"ctrlPoint")},G=function(a,b){v[0]==
this.id&&g==html5Ques.MODE.EDITABLE&&la(this)},fb=function(a,b){if(v[0]==this.id){var c=za(this.id,0);if(g==html5Ques.MODE.EDITABLE)la(this),c.location[0]=this.X(),c.location[1]=this.Y();else{var d=[this.X(),this.Y()],e=Y[0],f=Y[1],k=F(a),k=[k.usrCoords[1],k.usrCoords[2]];e.setPosition(JXG.COORDS_BY_USER,k);e.setAttribute({});k=sa(d,k);d=k[1];k=da(k[2]);if(35<=d){var n="forceId"+ ++K;Ta(n,{elementType:"force",ctrlPoint:c.id,name:"",angle:k+"",length:d+""},[e.id,f.id],!0);ma()}else q.removeObject(f),
q.removeObject(e);Y=null}v=[]}},Xa=function(a,b){},ua=function(a,b){},Ga=function(a){var b=a,c="cpId"+ ++na,d=[0,0];"string"!=typeof a&&(b=a.name,c=a.id,na=Math.max(--na,c.substring(4)),d=a.location.slice(0,2),a.location.slice(2,4));var b=b.trim(),b=0<b.length?b.substr(0,1).toUpperCase():b,e=q.create("point",d,{fixed:!1,showInfobox:!1,withLabel:!1,size:6,strokeColor:"red",fillColor:"red",highlightStrokeColor:"purple",highlightFillColor:"purple",highlightStrokeOpacity:.35,highlightFillOpacity:.35,
highlight:!0});e.on("over",eb);e.on("out",ra);e.on("down",Fa);e.on("drag",G);e.on("up",fb);a=e.id;g!==html5Ques.MODE.EDITABLE&&e.setAttribute({fixed:!0});d=q.create("text",[function(){return e.X()-3},function(){return e.Y()},b],{fontSize:12,strokeColor:"white",highlight:!1});d.on("over",Xa);d.on("out",ua);d=d.id;b={id:c,name:b,location:[e.X(),e.Y()]};P.push(b);T[c]=[a,null,d];f&&f.updateControlPoints(P)},gb=function(a){for(var b=0;b<a.length;b++)Ga(a[b])},ga=function(a,b){var c=-1,d;for(d in J)if(J[d][b]==
a){c=d;break}return c},xa=function(a,b){Q(this,"arrow")},Ya=function(a,b){if(v[0]==this.id){v=[];var c=ga(this.id,1),d=t[c].ctrlPoint,e=null;ja.hasOwnProperty(c)&&(e=ja[c]);1!=e&&f.getForceDiv(d,c).trigger("click")}},Za=function(a,b){Q(this,"endPoint")},$a=function(a,b){},hb=function(a,b){if(v[0]==this.id){v=[];var c=[this.X(),this.Y()],d=ga(this.id,0),e=t[d],g=e.ctrlPoint,k=V(g).location.slice(0,2),k=sa(k,c),c=k[1],k=da(k[2]),c=c+"",k=k+"";e.length===c&&e.angle===k||ma();e.length=c;e.angle=k;f.updateForce(g,
d,e.name,e.angle)}},Pa=function(a,b){var c=q.create("point",a,{showInfobox:!1,withLabel:!1,size:1.5,strokeColor:"#3399ff",fillColor:"#3399ff",highlightStrokeColor:"purple",highlightFillColor:"purple",visible:b});c.on("down",Za);c.on("drag",$a);c.on("up",hb);return c},la=function(a){var b=v[2];a=[a.X(),a.Y()];b=[a[0]-b[0],a[1]-b[1]];a=v[3];for(var c=0;c<a.length;c++){var d=a[c],e=d[0],d=U(d[1],b),e=q.objects[J[e][0]];e.setPosition(JXG.COORDS_BY_USER,d);e.setAttribute({})}},ma=function(){html5Ques.utils.triggerResponseChangedEvent(q.containerObj,
".html5fbd")},Ka=function(a,b,d){var e=[a.X(),a.Y()],k=[b.X(),b.Y()],e=sa(e,k)[0];d=q.create("curve",e,{strokeColor:d?"black":"white",fillColor:d?"#3399ff":"black",highlightFillColor:"purple",highlightStrokeOpacity:.35,highlightFillOpacity:.35});d.ctrlPointBrdId=a.id;d.endPointBrdId=b.id;d.on("down",xa);d.on("up",Ya);d.updateDataArray=function(){var a=0;null!=Y&&Y[1].id==this.id?a=1:"endPoint"==v[1]&&v[0]==this.endPointBrdId?a=2:g==html5Ques.MODE.EDITABLE&&"ctrlPoint"==v[1]&&v[0]==this.ctrlPointBrdId?
a=1:0==v.length&&(a=1);if(0<a){var b=q.objects[this.ctrlPointBrdId],d=q.objects[this.endPointBrdId],b=[b.X(),b.Y()],d=[d.X(),d.Y()],d=sa(b,d);this.dataX=d[0][0];this.dataY=d[0][1];if(2==a&&f){a=da(d[2]);d=ka(this.ctrlPointBrdId,0);b=ga(this.id,1);f.getForceDiv(d,b).children("input").val(a+"");var h=c?c:"1";$("#angle_"+h).val(a+"");$("#fbdForce_"+h+"_"+b+"_"+d).children("a").html(ba(f.getForces().options[t[b].name],V(d).name,a+""))}}};return d},sa=function(a,b){var c=9.75,d,e=[b[0]-a[0],b[1]-a[1]];
d=Math.atan2(e[1],e[0]);d=[Math.sqrt(e[0]*e[0]+e[1]*e[1])-5.25,0<=d?d:2*Math.PI+d];var e=d[0],f=e-15.75;d=d[1];9.75>f&&(c=f);for(var c=[c,c,f,f,e,f,f,c,c],f=[0,-2.25,-2.25,-7.75,0,7.75,2.25,2.25,0],g=0;g<c.length;g++){var k=[c[g],f[g]],q=k[0],k=k[1],n=d,q=U([q*Math.cos(n)-k*Math.sin(n),q*Math.sin(n)+k*Math.cos(n)],a);c[g]=q[0];f[g]=q[1]}return[[c,f],e,d]},Qa=function(a,b){},Ba=function(a,b){var c=F(a);B([c.usrCoords[1],c.usrCoords[2]],[this.dataX,this.dataY])?this.setAttribute({strokeColor:"#C3D9FF",
fillColor:"purple",strokeOpacity:.35,fillOpacity:.35}):(this.setAttribute({strokeOpacity:1,fillOpacity:1}),this.isSelected?this.setAttribute({strokeColor:"black",fillColor:"#3399ff"}):this.setAttribute({strokeColor:"black",fillColor:"white"}))},qa=function(a,b,c){var d=q.create("curve",[[-5,-5,5,5,-5],[5,-5,-5,5,5]],{layer:6,strokeWidth:2,strokeColor:"black",fillColor:c?"#3399ff":"white",highlightFillColor:"purple",highlightStrokeOpacity:.35,highlightFillOpacity:.35});d.bkgdWidth=10;d.bkgdHeight=
10;d.bkgdOffset=[1,1];d.ctrlPtBrdId=a;d.endPtBrdId=b;d.getDefaultUpperLeftCorner=function(){var a=q.objects[this.ctrlPtBrdId];a.X();a.Y();a=q.objects[this.endPtBrdId];a=[a.X(),a.Y()];return[a[0]+6,a[1]+10.69]};d.updateDataArray=function(){var a=q.objects[this.ctrlPtBrdId];a.X();a.Y();a=q.objects[this.endPtBrdId];a.X();a.Y();var b=[this.dataX[0],this.dataY[0]],b=this.getDefaultUpperLeftCorner(),a=b[0],b=b[1],c=a+this.bkgdWidth,d=b-this.bkgdHeight;this.dataX=[a,a,c,c,a];this.dataY=[b,d,d,b,b]};d.isSelected=
c;d.on("over",Qa);d.on("out",Ba);return d},Ra=function(a){var b=a.X(),c=a.Y(),d=q.getBoundingBox(),e=d[0],f=d[2],k=d[3],n=d[1],d=function(d){var g=d.substr(0,1);d="Min"==d.substr(1)?1:-1;for(var q="x"==g?1==d?e:f:b,l="x"==g?c:1==d?k:n,p=ta([q,l]),r=!1;!r;)a.hasPoint(p[0],p[1])?r=!0:(q="x"==g?q+.12*d:q,l="x"==g?l:l+.1*d,p=ta([q,l]));return"x"==g?1==d?q-3:q+3:(1==d?l- -2:l+-2)-0};xMin=d("xMin");xMax=d("xMax");yMin=d("yMin");yMax=d("yMax");var d=b-xMin,l=yMax-c;g!==html5Ques.MODE.EDITABLE&&(yMin+=2,
yMax-=3,l=yMax-c+1);return[xMax-xMin,yMax-yMin,[d,l]]},Ca=function(a){var b=Ra(a);a=q.objects[a.bkgdBrdId];a.bkgdWidth=b[0];a.bkgdHeight=b[1];a.bkgdOffset=b[2];q.update()},va=function(a,b,c){a=q.create("text",[function(){return b.dataX[0]+b.bkgdOffset[0]},function(){return b.dataY[0]-b.bkgdOffset[1]},a],{fontSize:12,fixed:!0,strokeColor:c?"white":"black",highlight:!1});a.bkgdBrdId=b.id;Ca(a);return a},Da=function(){f.removeFocus();Ma(null)},Ta=function(a,b,c,d){t.hasOwnProperty("forceList")||(t.forceList=
{elementType:"forceList",forces:[]});t[a]=b;t.forceList.forces.push(a);J[a]=c;f&&(c=ja.hasOwnProperty(a)?ja[a]:null,a=f.createForce(b.ctrlPoint,b.name,b.angle,a,c),d&&a.trigger("click"))},Ua=function(a,b,c,d,e,f){f=!0;e?(K=Math.max(K,e.substring(7)),f=!1):e="forceId"+ ++K;var g=V(b).location.slice(0,2),k=T[b][0],n=q.objects[k],l=parseFloat(c)*(Math.PI/180);d=d?d:"74.75";var p=parseFloat(d)+5.25,l=[p*Math.cos(l),p*Math.sin(l)],g=Pa([g[0]+l[0],g[1]+l[1]],!1),n=Ka(n,g,!1),l={},p={};a&&0<a.trim().length&&
(a=a.trim(),l=qa(k,g.id,!1),p=va(a,l,!1));Ta(e,{elementType:"force",ctrlPoint:b,name:a,angle:c,length:d},[g.id,n.id,l.id,p.id],f)},La=function(a,b,c,d){var e=t[a],f=e.ctrlPoint,g=V(f).location.slice(0,2),k=J[a][0],n=q.objects[k],l=q.objects[J[a][1]];e.name!=b.trim()?(e.name=b.trim(),n=T[f][0],c=J[a][2],d=J[a][3],g={},b={},c&&(q.removeObject(q.objects[d]),q.removeObject(q.objects[c])),0<e.name.length&&(g=qa(n,k,!0),b=va(e.name,g,!0)),J[a][2]=g.id,J[a][3]=b.id):e.angle!=d?(a=parseFloat(d)*(Math.PI/
180),k=parseFloat(e.length),deltaXY=[(k+5.25)*Math.cos(a),(k+5.25)*Math.sin(a)],a=U(g,deltaXY),n.setPosition(JXG.COORDS_BY_USER,a),n.setAttribute({}),e.angle=d):e.ctrlPoint!=c&&(l.ctrlPointBrdId=T[c][0],a=V(c).location.slice(0,2),k=[a[0]-g[0],a[1]-g[1]],a=[n.X(),n.Y()],a=U(a,k),n.setPosition(JXG.COORDS_BY_USER,a),n.setAttribute({}),e.ctrlPoint=c)},wa=function(a){var b=t.forceList.forces,c=b.indexOf(a);b.splice(c,1);delete t[a];q.removeObject(q.objects[J[a][1]]);b=J[a];c=b[2];q.removeObject(q.objects[b[3]]);
q.removeObject(q.objects[c]);q.removeObject(q.objects[J[a][0]]);delete J[a]},Ma=function(a){for(var b=t.forceList.forces,c=0;c<b.length;c++){var d=b[c],e=b[c]==a?!0:!1,f=J[d][0],g=q.objects[f];g.X();g.Y();g.setAttribute({visible:e});var k=q.objects[J[d][1]],n=q.objects[J[d][2]],l=q.objects[J[d][3]],p=t[d].ctrlPoint;V(p).location.slice(0,2);var p=T[p][0],r=q.objects[p];e?(q.removeObject(k),k=Ka(r,g,!0),J[d][1]=k.id,l&&n&&(e=l.htmlStr,q.removeObject(l),q.removeObject(n),n=qa(p,f,!0),l=va(e,n,!0),J[d][2]=
n.id,J[d][3]=l.id)):(k.setAttribute({strokeColor:"white",fillColor:"black"}),l&&n&&(n.isSelected=!1,n.setAttribute({fillColor:"white"}),l.setAttribute({strokeColor:"black"})))}},Na=function(a,b){var c=a,d=b;if(600<c||450<d){var e=600/c,f=450/d;e<f?(c=600,d=Math.floor(d*e)):(c=Math.floor(c*f),d=450)}return[[Math.ceil(-c/2),Math.ceil(-d/2)],[c,d]]},Va=function(a,b){if("undefined"!==typeof a&&null!=a&&a!={})if(a.hasOwnProperty("forceList")&&a.forceList.hasOwnProperty("forces")&&0<a.forceList.forces.length)for(var c=
a.forceList.forces,d=0;d<c.length;d++){ja[c[d]]=b[d];var e=a[c[d]];Ua(e.name,e.ctrlPoint,e.angle,e.length,c[d],e.nameLoc)}else t.forceList={elementType:"forceList",forces:[]}},ab=function(a){if("undefined"===typeof a||null==a||a=={}||"undefined"===typeof a.fbdElements||null==a.fbdElements||0==a.fbdElements.length)return{};var b={};a=a.fbdElements;for(var c,d,e=0;e<a.length;e++)c=JSON.parse(JSON.stringify(a[e])),d=c.id,delete c.id,b[d]=c;return b},Wa=function(a,b,c,d,e,g,k,n){a=a?a:"1";var l={options:{},
drawn:{},drawnValues:[]},p=$("#forceList_"+a),r=$("#cpList_"+a),v=$("#angle_"+a),B=$("#drawErase_"+a);d=function(b){var d=document.createElement("div"),e=document.createElement("a"),f=document.createElement("span"),g=document.createElement("span"),k=$("#angle_"+a)[0];$(e).attr("id","selectmenu_"+a).addClass("selectmenu form-control").append(f).append(g);f.innerHTML=b.options[b.selectedIndex].innerHTML;f.optionindex=b.selectedIndex;$(g).addClass("ddimage");for(var g=document.createElement("ul"),l=
[],n,q=0;q<b.options.length;q++)n=document.createElement("li"),n.innerHTML=b.options[q].innerHTML,n.fvalue=b.options[q].value,$(n).on("mouseover",function(){for(var a=0;a<l.length;a++)$(l[a]).removeClass("selected");$(this).addClass("selected")}).on("mouseout",function(){$(this).removeClass("selected")}).on("click",function(a){return function(){$(d).addClass("hidden");f.innerHTML=30<this.innerHTML.length?this.innerHTML.substr(0,30)+"...":this.innerHTML;f.optionindex=a;$(e).removeClass("hidden");$(b).val(this.fvalue);
var c=$._data($(b)[0],"events");c&&c.change&&$(b).trigger("change")}}(q)),$(g).append(n),l.push(n);$(g).addClass("dropdown");$("#fbd2draw_"+a).append(d.appendChild(g).parentNode);$(e).on("click",function(){var a=this.children[0].optionindex;$(d).removeClass("hidden");for(var b=0;b<l.length;b++)$(l[b]).removeClass("selected");$(l[a]).addClass("selected");$(d).css({top:$(this).position().top+$(this).height()+2,left:$(this).position().left-2})});$(d).on("mouseleave",function(){$(this).addClass("hidden");
$(e).removeClass("hidden")});c&&$(e).css({top:k.getBoundingClientRect().top});$(b).addClass("hidden");$(b.parentNode).children("select.cpList").before(e).before('\x3cspan style\x3d"display:inline-block; width:260px;"\x3e\x3c/span\x3e');$(d).addClass("selectmenu").addClass("hidden").css({"z-index":"999999"})};var F=function(){$("#fbdSelectedForce_"+a).val("");$('[id^\x3d"fbdForce_'+a+'_"]').removeClass("selected");p.val(p.children("option")[0].value);if(0<$("#selectmenu_"+a).length){var b=$("#selectmenu_"+
a)[0].children[0];b.optionindex=0;b.innerHTML=p.children("option")[0].innerHTML}r.val(r.children("option")[0].value);v.val("");B.text(html5Ques.MSG.drawForce);B.removeClass("btn-danger").addClass("btn-success");p.off("change");r.off("change");v.off("change");B.off("click");B.on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;r.val()&&v.val()&&J(v.val())&&Ua(p.val(),r.val(),v.val(),null,null,null)})};if(0<g.length){e=[];g=g.split(",");for(var A=0;A<g.length;A++){var G=g[A].indexOf("\x3d");
0<G&&(n=document.createElement("option"),n.value=g[A].substring(0,G).trim(),n.text=g[A],e.push(n),l.options[n.value]=n.text)}0<p.length?(p.find("option").remove(),1==e.length?p.append(e):p.append('\x3coption value\x3d""\x3e'+html5Ques.MSG.chooseAType+"\x3c/option\x3e").append(e)):(p=$(document.createElement("select")),p.append('\x3coption value\x3d""\x3e'+html5Ques.MSG.chooseAType+"\x3c/option\x3e").append(e));b===html5Ques.MODE.INTERACTIVE&&d(p[0]);p.children("option").each(function(){var a=$(this).text();
30<a.length&&$(this).text(a.substr(0,30)+"...")})}if(b!==html5Ques.MODE.LOCKED){var J=function(b,c){var d,e;e=b.indexOf(".");-1<e?(d=parseInt(b.substr(0,e)),e=parseInt(b.substr(e+1))):(d=parseInt(b),e=0);return""==b&&"undefined"!==typeof c||-1<b.indexOf("@")||isNaN(d)||isNaN(e)||360<d||-180>d||0!=e&&5!=e?($("#fbdAngleWarningArea_"+a).show(),$("#fbdCpWarningArea_"+a).hide(),$("#fbdWarning_"+a).modal("show"),!1):!0};$("#fbdNewForce_"+a).on("mouseenter",function(){Da()});$("#fbdNewForce_"+a).on("click",
function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;Da()});$("#fbdDrawnForces_"+a).on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1});$(document).on("mouseenter",'[id^\x3d"fbdForce_'+a+'_"]',function(){var b=fa(this.id,"fbdForce_"+a+"_");f.getForceDiv(b[1],b[0])[0].handleClick()});$(document).on("click",'[id^\x3d"fbdForce_'+a+'_"]',function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;b=fa(this.id,"fbdForce_"+a+"_");f.getForceDiv(b[1],b[0]).trigger("click")});
$(document).on("mouseleave",'[id^\x3d"fbdForce_'+a+'_"]',function(){$("#fbdSelectedForce_"+a).val()||Da()});$("#fbdReset_"+a).on("mouseenter",function(){Da()});$("#fbdReset_"+a).on("click",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;$("#reset_"+a).trigger("click")});F();$("#fbdClearAllWarning_"+a+" .btn-default").on("click",function(){var b,c;for(c in l.drawn)if(l.drawn.hasOwnProperty(c))for(var d in l.drawn[c])l.drawn[c].hasOwnProperty(d)&&(b=l.drawn[c][d],b.div.remove(),$("#fbdForce_"+
a+"_"+d+"_"+c).remove(),b=l.drawnValues.indexOf(b.name),-1<b&&l.drawnValues.splice(b,1),delete l.drawn[c][d]);c=void 0;c="undefined"==typeof c?[]:c;if(t.hasOwnProperty("forceList")&&t.forceList.hasOwnProperty("forces"))for(d=JSON.parse(JSON.stringify(t.forceList.forces)),b=0;b<d.length;b++)-1==$.inArray(d[b],c)&&wa(d[b]);$("#reset_"+a).addClass("disabled");$("#fbdReset_"+a).addClass("disabled");$("#fbdClearAllWarning_"+a).modal("hide")});$("#reset_"+a).on("click",function(b){b.preventDefault?b.preventDefault():
b.returnValue=!1;$(this).hasClass("disabled")||(0<l.drawnValues.length&&$("#fbdClearAllWarning_"+a).modal("show"),f.removeFocus())});$("#fbdWarning_"+a+" .btn-default").on("click",function(){$("#fbdWarning_"+a).modal("hide")})}if(b===html5Ques.MODE.EDITABLE)$("#drawCp").on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;if(a=$("#cplabel").val())"@"==a?alert($("#noatmsg").val()):(Ga(a),$("#cplabel").val(""))});return{getForces:function(){return l},getForceDiv:function(a,b){var c=
null;try{c=l.drawn[a][b].div}catch(d){}return c},getControlPoints:function(){return"object"==typeof k?JSON.stringify(k):k},createForce:function(d,e,g,k,n){try{if(e&&"undefined"===typeof l.options[e]||"undefined"===typeof g||""==g||"undefined"===typeof d||""==d||"undefined"===typeof k||""==k)return;n="undefined"===typeof n||null==n?null:n.toLowerCase()}catch(q){return}var t=$('[id^\x3d"fbdForce_'+a+'_"][id$\x3d_'+d+"]").last();"undefined"===typeof l.drawn[d]&&(l.drawn[d]={},$("#drawn_"+a).append('\x3cdiv class\x3d"forces" id\x3d"drawn_'+
a+"_"+d+'"\x3e\x3c/div\x3e'));$.isEmptyObject(l.drawn[d])&&(t=$("#fbdDrawnForces_"+a+', [id^\x3d"fbdForce_'+a+'_"]').last());var z=$("#drawn_"+a+"_"+d),A=$($("div.templateforce")[0]).clone();A.attr("id",k+"_"+d);A.removeClass("templateforce").addClass("force");null!=n&&(A.children("span.fimgplace").addClass("hidden"),"true"==n?A.prepend('\x3ci class\x3d"questionErrorIndicator fa fa-check-circle fa-2x"\x3e\x3c/i\x3e'):A.prepend('\x3ci class\x3d"questionErrorIndicator fa fa-times-circle fa-2x"\x3e\x3c/i\x3e'));
A.children("select.forceList").append(p.children("option").clone()).val(e);A.children("select.cpList").append(r.children("option").clone()).val(d);1==r.children("option").length&&A.children("select.cpList").addClass("hidden");A.children("input").val(g);l.drawn[d][k]={name:e,angle:g,div:A,correctness:n};l.drawnValues.push(e);var G=document.createElement("li"),M=document.createElement("a");$(G).attr("id","fbdForce_"+a+"_"+k+"_"+d);$(G).append(M);$(M).attr("href","#");$(M).html(ba(l.options[e],V(d).name,
g));t.after(G);b!=html5Ques.MODE.LOCKED&&"true"!=n?(A.children("button").on("click",function(b){b.stopPropagation&&b.stopPropagation();b.preventDefault?b.preventDefault():b.returnValue=!1;b=this.parentNode;var c=$(b).attr("id").lastIndexOf("_"),d=$(b).attr("id").substr(0,c),e=$(b).attr("id").substr(c+1);wa(d);c=l.drawnValues.indexOf(l.drawn[e][d].name);-1<c&&l.drawnValues.splice(c,1);delete l.drawn[e][d];b.parentNode.removeChild(b);$("#deleted")[0].appendChild(b);""==$("#drawn_"+a+"_"+e).html().trim()&&
(delete l.drawn[e],b=$("#drawn_"+a+"_"+e)[0],b.parentNode.removeChild(b),0==l.drawnValues.length&&($("#reset_"+a).addClass("disabled"),$("#fbdReset_"+a).addClass("disabled")));$("#fbdForce_"+a+"_"+d+"_"+e).remove();$("#fbdSelectedForce_"+a).val()&&fa($("#fbdSelectedForce_"+a).val(),"")[0]==d&&F()}),A.children("select.forceList").on("change",function(){var b=this.parentNode,c=$(b).attr("id").lastIndexOf("_"),d=$(b).attr("id").substr(0,c),b=$(b).attr("id").substr(c+1),c=l.drawn[b][d].name;l.drawn[b][d].name=
$(this).val();c=l.drawnValues.indexOf(c);-1<c&&l.drawnValues.splice(c,1);l.drawnValues.push($(this).val());c=l.drawn[b][d].angle;La(d,$(this).val(),b,c);p.val($(this).val());$("#fbdForce_"+a+"_"+d+"_"+b).children("a").html(ba(l.options[$(this).val()],V(b).name,c))}),A.children("select.cpList").on("change",function(){var b=this.parentNode,c=$(b).attr("id").lastIndexOf("_"),d=$(b).attr("id").substr(0,c),b=$(b).attr("id").substr(c+1),c=l.drawn[b][d],e=$(this).val(),f=$('[id^\x3d"fbdForce_'+a+'_"][id$\x3d_'+
e+"]").last();if(""==e)$("#fbdAngleWarningArea_"+a).hide(),$("#fbdCpWarningArea_"+a).show(),$("#fbdWarning_"+a).modal("show"),e=b,$(this).val(e);else{delete l.drawn[b][d];"undefined"===typeof l.drawn[e]&&(l.drawn[e]={},0==$("#drawn_"+a+"_"+e).length&&$("#drawn_"+a).append('\x3cdiv class\x3d"forces" id\x3d"drawn_'+a+"_"+e+'"\x3e\x3c/div\x3e'));$.isEmptyObject(l.drawn[e])&&(f=$('[id^\x3d"fbdForce_'+a+'_"]').last());c.div.attr("id",d+"_"+e);$("#drawn_"+a+"_"+e).append(c.div);l.drawn[e][d]=c;$("#fbdSelectedForce_"+
a).val(d+"_"+e);$('[id^\x3d"fbdForce_'+a+'_"]').removeClass("selected");var g=document.createElement("li"),k=document.createElement("a");$(g).attr("id","fbdForce_"+a+"_"+d+"_"+e);$(g).append(k);$(g).addClass("selected");$(k).attr("href","#");$(k).html(ba(l.options[c.name],V(e).name,c.angle));f.after(g);$("#fbdForce_"+a+"_"+d+"_"+b).remove();La(d,c.name,e,c.angle)}r.val(e)}),A.find("input").on("change",function(){var b=$(this).closest("div.force")[0],c=$(b).attr("id").lastIndexOf("_"),d=$(b).attr("id").substr(0,
c),b=$(b).attr("id").substr(c+1),c=$(this).val().trim(),e=l.drawn[b][d].angle;J(c,e)?(l.drawn[b][d].angle=c,La(d,l.drawn[b][d].name,b,c)):(c=e,$(this).val(c));v.val(c);$("#fbdForce_"+a+"_"+d+"_"+b).children("a").html(ba(l.options[l.drawn[b][d].name],V(b).name,c))}),A[0].loseFocus=function(){"undefined"!==typeof this.focused&&this.focused&&$(this).removeClass("focus");this.focused=!1},A[0].handleClick=function(b){for(var c=$(this).closest("#drawn_"+a).find("div.force"),d=0;d<c.length;d++)"function"==
typeof c[d].loseFocus&&c[d].loseFocus();$("#fbdSelectedForce_"+a).val("");$('[id^\x3d"fbdForce_'+a+'_"]').removeClass("selected");"undefined"!==typeof this.focused&&this.focused||($(this).addClass("focus"),this.focused=!0);p.val($(this).children("select.forceList").val());0<$("#selectmenu_"+a).length&&(c=$("#selectmenu_"+a)[0].children[0],c.optionindex=p[0].selectedIndex,c.innerHTML=p.children("option")[p[0].selectedIndex].innerHTML);r.val($(this).children("select.cpList").val());v.val($(this).children("input.angle").val());
B.text(html5Ques.MSG.deleteForce);B.removeClass("btn-success").addClass("btn-danger");b&&($("#fbdSelectedForce_"+a).val($(this).attr("id")),$("#fbdForce_"+a+"_"+$(this).attr("id")).addClass("selected"),p.on("change",function(){var b=fa($("#fbdSelectedForce_"+a).val(),""),b=f.getForceDiv(b[1],b[0]).children("select.forceList");b.val($(this).val());b.trigger("change")}),r.on("change",function(){var b=fa($("#fbdSelectedForce_"+a).val(),""),b=f.getForceDiv(b[1],b[0]).children("select.cpList");b.val($(this).val());
b.trigger("change")}),v.on("change",function(){var b=fa($("#fbdSelectedForce_"+a).val(),""),b=f.getForceDiv(b[1],b[0]).children("input.angle");b.val($(this).val());b.trigger("change")}),B.off("click"),B.on("click",function(b){b.preventDefault?b.preventDefault():b.returnValue=!1;b.clientX&&b.clientY&&(b=fa($("#fbdSelectedForce_"+a).val(),""),f.getForceDiv(b[1],b[0]).children("button").trigger("click"))}));Ma(k)},A.on("click",function(){$(this)[0].handleClick(!0)}),1==p[0].options.length&&(d=A.children("select.forceList"),
d.val(p[0].options[0].value),d.trigger("change"))):(A.children("button").remove(),A.children().attr("disabled","disabled"));z.append(A);$("#reset_"+a).removeClass("disabled");$("#fbdReset_"+a).removeClass("disabled");$("div.fbdinstruction").addClass("hidden");b===html5Ques.MODE.INTERACTIVE&&c&&$("#selectmenu_"+a).css({top:$("#angle_"+a)[0].getBoundingClientRect().top});return A},updateForce:function(a,b,c,d){a=l.drawn[a][b];a.name=c;a.angle=d;a.div.children("select.forceList").val(c);a.div.children("input").val(d)},
updateControlPoints:function(c){k=c;for(var d="",e=[],g,n=[],p=0;p<c.length;p++)d+=c[p].id+",",b===html5Ques.MODE.EDITABLE&&(g=$("div.cpTemplate").clone(),g[0].cpId=c[p].id,g.removeClass("cpTemplate").addClass("cp"),g.children("input").val(c[p].name),g.children("button.cpUpdate").on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;if("@"==$(this.parentNode).children("input").val())alert($("#noatmsg").val());else{var b=this.parentNode.cpId;a=$(this.parentNode).children("input").val();
a=a.trim();a=0<a.length?a.substr(0,1).toUpperCase():a;var c=V(b),b=q.objects[T[b][2]];c.name=a;b.setText(a);f.updateControlPoints(P)}}),g.children("button.cpDelete").on("click",function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;a=this.parentNode;$("#deleted")[0].appendChild(a);a=a.cpId;var b=oa(a),c=P.slice(0);c.splice(b,1);f.updateControlPoints(c);b=T[a];c=b[0];q.removeObject(q.objects[b[2]]);q.removeObject(q.objects[c]);delete T[a];b=oa(a);P.splice(b,1)}),e.push(g)),g=document.createElement("option"),
g.value=c[p].id,g.text=c[p].name,n.push(g);b===html5Ques.MODE.EDITABLE&&$("#drawnCp").html('\x3cp class\x3d"glabel"\x3e'+html5Ques.MSG.cplist+":\x3c/p\x3e").append(e);0<r.length?(r.find("option").remove(),1==n.length?(r.append(n),r.addClass("hidden"),$("#fbd2draw_"+a+" span.mcp").addClass("hidden"),$("#fbd2draw_"+a+" span.scp").removeClass("hidden")):(r.append('\x3coption value\x3d""\x3eOrigin\x3c/option\x3e').append(n),r.removeClass("hidden"),$("#fbd2draw_"+a+" span.mcp").removeClass("hidden"),$("#fbd2draw_"+
a+" span.scp").addClass("hidden"))):(r=$(document.createElement("select")),r.append(n));$("#fbdSelectedForce_"+a).val()&&(c=fa($("#fbdSelectedForce_"+a).val(),"")[1],r.val(c));for(var t in l.drawn)if(l.drawn.hasOwnProperty(t))if(0>d.indexOf(t))for(var v in l.drawn[t])l.drawn[t].hasOwnProperty(v)&&l.drawn[t][v].div.children("button").trigger("click");else for(v in l.drawn[t])l.drawn[t].hasOwnProperty(v)&&(c=l.drawn[t][v].div.children("select.cpList"),e=c.val(),c.children("option").remove(),c.append(r.children("option").clone()),
1==n.length?c.addClass("hidden"):c.removeClass("hidden"),c.val(e))},removeFocus:function(){for(var a in l.drawn)if(l.drawn.hasOwnProperty(a))for(var b in l.drawn[a])if(l.drawn[a].hasOwnProperty(b)){var c=l.drawn[a][b].div[0];"function"===typeof c.loseFocus&&c.loseFocus()}F()},aMethod:function(){}}};this.addImage=function(a,b,c){!a||0>=b||0>=c||(null!=k&&q.removeObject(k),b=Na(b,c),k=q.create("image",[a,b[0],b[1]],{fixed:!0,highlight:!1,fillOpacity:.8}),k.off("down"),k.off("move"),k.off("up"))};this.getResponse=
function(){if("object"==typeof t){var a;if("undefined"===typeof t||null==t||t=={})a={fbdElements:[]};else{a={fbdElements:[]};for(var b in t){var c=JSON.parse(JSON.stringify(t[b]));c.id=b;a.fbdElements.push(c)}}return JSON.stringify(a)}return t};this.getBoard=function(){return q};this.getDom=function(){return f};this.hasUncompletedForce=function(){var a=f.getForces(),b;for(b in a.drawn)if(a.drawn.hasOwnProperty(b))for(var c in a.drawn[b])if(a.drawn[b].hasOwnProperty(c)){var d=a.drawn[b][c];if(""==
d.name||""==d.angle)return!0}return!1};this.hasEmptyResponse=function(){return $.isEmptyObject(t)};this.sameResponse=function(){if(e!=this.getResponse())return!1;var a=f.getForces(),b;for(b in a.drawn)if(a.drawn.hasOwnProperty(b))for(var c in a.drawn[b])if(a.drawn[b].hasOwnProperty(c)&&null==a.drawn[b][c].correctness)return!1;return!0};(function(a,b,c,d,g){e=JSON.stringify(a);c=null;var l=[],n=[];if("undefined"!==typeof g)try{var p="object"==typeof g?g:JSON.parse(g);c=p.bgImage;l=(l="undefined"==
typeof p.controlPoints?[]:p.controlPoints)?l:[];A=p.options;n="undefined"==typeof p.forceCorrectness?[]:p.forceCorrectness.map(function(a){return"null"==a?null:a});fromQE="undefined"===typeof p.fromQE?!1:p.fromQE}catch(v){c=null,l=[],A={},n=[]}JXG.Options.board.minimizeReflow="none";var p="jxgbox_"+b,B=[];$("#"+p).parents().each(function(){"none"===$(this).css("display")&&(B[B.length]=this,$(this).css("display","initial"))});q=JXG.JSXGraph.initBoard(p,{boundingbox:[-300,225,300,-225],axis:!1,grid:!1,
showNavigation:!1,showCopyright:!1});B.forEach(function(a){$(a).hasClass("timed")||$(a).css("display","none")});q.on("down",r);q.on("move",N);q.on("up",Ja);c&&"undefined"!=typeof c.url&&c.url&&(p=Na(c.width,c.height),k=q.create("image",[c.url,p[0],p[1]],{fixed:!0,highlight:!1,fillOpacity:.8}),k.off("down"),k.off("move"),k.off("up"));f=Wa(b,d,fromQE,"undefined"===typeof g.correct?!1:g.correct,"undefined"===typeof g.showAnswer?!1:g.showAnswer,"undefined"===typeof g.forces?"":g.forces,"undefined"===
typeof g.controlPoints?{}:g.controlPoints,"undefined"===typeof g.forceCorrectness?[]:g.forceCorrectness);gb(l);t={};var E;try{E="object"==typeof a?a:JSON.parse(a)}catch(v){E={}}E=ab(E);Va(E,n);d===html5Ques.MODE.LOCKED&&q.removeEventHandlers()})(b,c,d,g,A)}var b={};return{getInstances:function(a){return a in b?b[a]:null},newInstance:function(c,p,l,X,A){c=new a(c,p,l,X,A);return b[p]=c},destroyInstance:function(a){var c=b[a];JXG.JSXGraph.freeBoard(c.getBoard());delete c;delete b[a]}}}()});return{initialize:function(){c.initialize();
a()}}});define("questions/html5/run/js/html5JsxGraphQuestionsApp",["require","questions/clickableImage/run/js/runClickableImageQuestionApp","questions/sketch/run/js/runSketchQuestionApp","questions/fbd/run/js/runFbdQuestionApp"],function(b,c,a,d){return{initialize:function(){c.initialize();a.initialize();d.initialize()}}});define("text!mathEditor/templates/mathEditorDialog.html",[],function(){return'\x3cdiv class\x3d"modal fade resizable" tabindex\x3d"-1" role\x3d"dialog"\n  aria-labelledby\x3d"modalTitle" aria-hidden\x3d"true" id\x3d"mathEditorDialog"\x3e\n  \x3cdiv class\x3d"modal-dialog"\x3e\n    \x3cdiv class\x3d"modal-content"\x3e\n      \x3cdiv class\x3d"modal-header"\x3e\n        \x3cbutton type\x3d"button" class\x3d"close" data-dismiss\x3d"modal"\x3e\n          \x3cspan aria-hidden\x3d"true"\x3e\x26times;\x3c/span\x3e\n        \x3c/button\x3e\n        \x3ch4 class\x3d"modal-title" id\x3d"modalTitle"\x3e\x3c%\x3d strings.title %\x3e\x3c/h4\x3e\n      \x3c/div\x3e\n      \x3cdiv class\x3d"modal-body"\x3e\n        \x3cdiv class\x3d"btn-group" role\x3d"toolbar"\x3e\n            \x3cbutton id\x3d"equationEditorTab" class\x3d"btn btn-default active"\x3e\x3c%\x3d strings.editorTab %\x3e\x3c/button\x3e\n            \x3cbutton id\x3d"sourceTab" class\x3d"btn btn-default"\x3e\x3c%\x3d strings.mathmlTab %\x3e\x3c/button\x3e\n        \x3c/div\x3e\n\n        \x3cdiv id\x3d"equationEditor" data-toolbar\x3d"EqeFullToolbar.xml"\x3e\n               \x3cdiv id\x3d\'\x3c%\x3d mathEditorId %\x3e\' class\x3d"mathEditor"\x3e\n               \x3c/div\x3e\n               \x3cinput type\x3d"hidden" class\x3d"mathEditorValue"/\x3e\n             \x3c/div\x3e\n\n             \x3cdiv id\x3d"sourceEditor" class\x3d"startHidden"\x3e\n               \x3cp class\x3d"info"\x3e\n                 \x3c%\x3d strings.mathmlText %\x3e\n               \x3c/p\x3e\n               \x3cdiv class\x3d"resizableContent"\x3e\n                 \x3cdiv class\x3d"row sourceHolder"\x3e\n                   \x3cpre class\x3d"sourceEditor"\x3e\x3c/pre\x3e\n                 \x3c/div\x3e\n                 \x3cdiv class\x3d"resizer" title\x3d\'\x3c%\x3d strings.resizerTitle %\x3e\'\x3e\n                   ::::::::\n                 \x3c/div\x3e\n                 \x3cdiv id\x3d"mathOutput"\x3e\n                 \x3c/div\x3e\n               \x3c/div\x3e\n               \x3cdiv id\x3d"texBuffer" class\x3d"startHidden"\x3e\x3c/div\x3e\n             \x3c/div\x3e\n\n      \x3c/div\x3e\n      \x3cdiv class\x3d"modal-footer"\x3e\n        \x3cdiv class\x3d"form-group pull-left" id\x3d"paletteSelector"\x3e\n          \x3clabel\x3e\n            \x3c%\x3d strings.paletteLabel %\x3e\n          \x3c/label\x3e\n          \x3cselect class\x3d"form-control"\x3e\n            \x3coption value\x3d\'EqeFullToolbar.xml\'\x3e\x3c%\x3d strings.paletteDefault %\x3e\x3c/option\x3e\n            \x3coption value\x3d\'EqeChemistryToolbar.xml\'\x3e\x3c%\x3d strings.paletteChemistry %\x3e\x3c/option\x3e\n          \x3c/select\x3e\n        \x3c/div\x3e\n\n        \x3cbutton type\x3d"button" id\x3d"cancel" class\x3d"btn btn-danger" data-dismiss\x3d"modal"\x3e\x3c%\x3d strings.cancel %\x3e\x3c/button\x3e\n        \x3cbutton type\x3d"button" id\x3d"insert" class\x3d"btn btn-primary"\x3e\x3c%\x3d strings.done %\x3e\x3c/button\x3e\n      \x3c/div\x3e\n    \x3c/div\x3e\n  \x3c/div\x3e\n\x3c/div\x3e'});
define("mathEditor/js/nls/strings",{de:!0,el:!0,es:!0,fr:!0,it:!0,ja:!0,ko:!0,pl:!0,"pt-br":!0,root:!0,"zh-cn":!0,"zh-tw":!0});
define("mathEditor/js/nls/root/strings",{title:"Equation Editor",editorTab:"Equation Editor",mathmlTab:"MathML/LaTeX",mathmlText:'Enter MathML or LaTeX for 2-D Expression. Escape LaTeX with \x3cspan class\x3d"tex2jax_ignore"\x3e\x26#92;(...\x26#92;)\x3c/span\x3e for inline math and \x3cspan class\x3d"tex2jax_ignore"\x3e\x26#92;[...\x26#92;]\x3c/span\x3e for block math.',preview:"Preview",paletteLabel:"Palette",paletteDefault:"Default",paletteChemistry:"Chemistry",done:"Done",cancel:"Cancel",resizerTitle:"Drag to resize"});
define("mathEditor/js/views/mathEditorDialog",["text!mathEditor/templates/mathEditorDialog.html","i18n!mathEditor/js/nls/strings"],function(b,c){return Backbone.View.extend({initialize:function(){this.template=_.template(b);this.mathEditorId="mathEditor_"+this.options.editor.id},events:{"click #insert":"insertElement","click #equationEditorTab":"showEquationEditorTab","click #sourceTab":"showSourceTab","change select":"paletteSelected",keyup:"handleKeyUp"},rendered:!1,suppressMathUpdate:!1,render:function(a){if(this.rendered)return this.show(a);
var b=this;$(this.el).html(this.template({strings:c,mathEditorId:this.mathEditorId}));this.modal=$(".modal",this.el).modal({backdrop:!1});$(".modal-dialog",this.el).draggable({handle:".modal-header"});$(".modal-header",this.el).addClass("draggable");$(".resizer",this.el).draggable({axis:"y",containment:$(".resizableContent",this.el),scroll:!1,drag:function(a,c){b.resizeEditorContent(c.offset.top)},stop:function(a,c){b.resizeEditorContent(c.offset.top)}});$(".modal-content",this.el).resizable({minHeight:400,
minWidth:550,handles:"se",resize:function(){b.resizeChildren()}});$(this.modal).on("hidden.bs.modal",function(){$(window).off("resize")});$(this.modal).on("shown.bs.modal",function(){$(window).on("resize",function(){b.resizeChildren()});b.editorDiv=$("#equationEditor",b.el);initializeEditor(b.editorDiv,!0);b.createMathSourceEditor();b.resizeChildren(a)});this.rendered=!0;return this},show:function(a){if(!this.rendered)return this.render(a);$(this.modal).modal("show");"function"===typeof a&&a()},resizeChildren:function(a){$(this.el).css("background",
"blue");var b=$(".modal-content",this.el).height(),c=$(".modal-header",this.el).outerHeight(),n=$(".modal-footer",this.el).outerHeight(),p=$(".modal-body",this.el),l=b-c-n-30;p.height(l);var X=$(".btn-group",p).outerHeight();if(this.equationEditorVisible())var A=setInterval(function(){var b=$(".toolbar",p);b.length&&50<b.outerHeight()&&(clearInterval(A),b=b.outerHeight(),b=l-X-b-5,$(".mwEquationEditor",p).height(b),MapleEquationEditorOnline.grabFocus(this.mathEditorId),"function"===typeof a&&a())},
0);else n=$(".info",p).outerHeight(),$("#mathOutput",p).outerHeight(),b=$(".resizableContent",this.el),c=$(".resizer",this.el),n=l-X-n,b.height(n),this.resizeEditorContent(c.offset().top),n=n+b.position().top-c.outerHeight(),c.position().top>n&&c.css("top",n),c.position().top<b.position().top&&c.css("top",b.position().top),this.sourceEditor.focus(),"function"===typeof a&&a()},resizeEditorContent:function(a){var b=this,c=$(".resizableContent",this.el),n=$("#mathOutput",this.el),p=n.outerHeight(!0)-
n.height(),l=a-c.offset().top;a=c.outerHeight()-l-p;$(".sourceHolder",this.el).height(l);n.height(a);setTimeout(function(){var a=$(".ace_line",this.el).outerHeight(),a=Math.floor(l/a);b.sourceEditor.setOptions({maxLines:a,minLines:a})},10)},formatMathSource:function(a){return CKMathExpPlugin.isTeX(a)?this.formatTeX(a):this.formatMathML(a)},formatTeX:function(a){a=a.replace(/(\\begin *?{.*?})(?!\n)/gm,"$1\n");a=a.replace(/([^\n])(\\end *?{.*?})/gm,"$1\n$2");a=a.replace(/(\\\\)(?!(\n|\[[0-9A-Za-z.\s-]*\]))/gm,
"$1\n");a=a.replace(/(\\\\\[[0-9A-Za-z.\s-]*\])(?!\n)/gm,"$1\n");return a=this.restoreEntities(a)},formatMathML:function(a){for(var b="",c=/> ( )*</m;a.match(c);)a=a.replace(c,"\x3e\x26nbsp;$1\x3c");a=a.replace(/(>)\s*(<)(\/*)/g,"$1\r\n$2$3");var n=0;jQuery.each(a.split("\r\n"),function(a,c){var g=0;c.match(/.+<\/\w[^>]*>$/)?g=0:c.match(/^<\/\w/)?0!=n&&--n:g=c.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var A="",f=0;f<n;f++)A+="  ";b+=A+c+"\r\n";n+=g});return b},restoreEntities:function(a){if(-1!=a.indexOf("\\[")||
-1!=a.indexOf("\\("))a=a.replace(/&lt;/g,"\x3c"),a=a.replace(/&gt;/g,"\x3e"),a=a.replace(/&amp;/g,"\x26");return a},getMathContainer:function(){return MapleEquationEditorOnline.getMathContainerForId(this.mathEditorId)},textAreaToEquationEditor:function(){this.getMathContainer().updateMathModel($(".mathEditorValue",this.el).val())},sourceToTextarea:function(){var a=this.sourceEditor.getValue(),a=CKMathExpPlugin.isTeX(a)?CKMathExpPlugin.filterTeX(a,CKMathExpPlugin.makeLTSafe):a;$(".mathEditorValue",
this.el).val(a)},textAreaToSource:function(){var a=$(".mathEditorValue",this.el).val();this.sourceEditor.setValue(this.formatMathSource(a),-1)},createMathSourceEditor:function(){var a=$("style#ace_editor").clone().prop({id:"ace_editor_dialog"});a.text(a.text()+".ace_editor div.ace_text-layer *{font: 12px/normal 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', 'source-code-pro', monospace;} pre.mathMlArea{border: 1px solid #ccc; border-radius: 4px; height: 150px;}");var b=$(".sourceEditor",this.el);$(b).before(a);
this.sourceEditor=ace.edit(b[0]);this.sourceEditor.setTheme("ace/theme/eclipse");this.sourceEditor.getSession().setMode("ace/mode/mapleta_equationeditor");this.sourceEditor.getSession().setUseWorker(!1);this.sourceEditor.setShowPrintMargin(!1);this.timeoutId=0;var c=this;this.sourceEditor.on("change",function(){c.suppressMathUpdate||(clearTimeout(c.timeoutId),c.timeoutId=setTimeout(function(){c.suppressMathUpdate||c.updateMathPreview()},375))})},showContentTab:function(a,b){0<a.length&&CKMathExpPlugin.isTeX(a)?
(this.showSourceTab(b),$("#equationEditorTab",this.el).hide()):$("#equationEditorTab",this.el).show()},updateMathPreview:function(){if(!this.suppressMathUpdate){var a=this.sourceEditor.getValue();this.showContentTab(a,!1);var b=$("#mathOutput",this.el);this.filterHtml(a,function(a){var c=$("#texBuffer",this.el);c.html(a);MathJax.Hub.Queue(["Typeset",MathJax.Hub,c[0]]);MathJax.Hub.queue.Push(function(){b.html(c.html())})})}},filterHtml:function(a,b){a=0<$("#addMspaceIndicator").length?{html:a,addMspace:!0}:
{html:a,addMspace:!1};null!=this.pendingFilterRequest&&this.pendingFilterRequest.abort();this.pendingFilterRequest=$.ajax({type:"POST",url:getBaseURL()+"rest/questions/filter",data:a,dataType:"text",success:function(a){this.pendingFilterRequest=null;b(a)},error:function(){this.pendingFilterRequest=null}})},equationEditorToTextarea:function(){readEquationEditor(this.editorDiv)},unrender:function(){this.remove()},getMathSource:function(){return $(".mathEditorValue",this.el).val()},insertElement:function(){this.equationEditorVisible()?
this.equationEditorToTextarea():this.sourceToTextarea();var a=this.options.editor,b=this.getMathSource();CKMathExpPlugin.isTeX(b)&&(b="\x3cmath\x3e"+b+"\x3c/math\x3e");b=CKEDITOR.dom.element.createFromHtml(b);null!=this.selectedElement?(b.replace(this.selectedElement),a.fire("lockSnapshot"),a.fire("insertElement",b),a.fire("unlockSnapshot")):a.insertElement(b);$(this.modal).modal("hide")},resetTabs:function(){$(".btn-group button",this.el).removeClass("active");$("#equationEditor,#sourceEditor",this.el).hide()},
equationEditorVisible:function(){return $("#equationEditorTab",this.el).hasClass("active")},showEquationEditorTab:function(a){this.equationEditorVisible()||(!1!==a&&this.sourceToTextarea(),this.textAreaToEquationEditor(),this.resetTabs(),$("#paletteSelector",this.el).show(),$("#equationEditorTab",this.el).addClass("active"),$("#equationEditor",this.el).show(),this.resizeChildren())},showSourceTab:function(a){this.equationEditorVisible()&&(!1!==a&&this.equationEditorToTextarea(),this.textAreaToSource(),
this.resetTabs(),$("#paletteSelector",this.el).hide(),$("#sourceTab",this.el).addClass("active"),$("#sourceEditor",this.el).show(),this.updateMathPreview(),this.resizeChildren(),this.sourceEditor.focus())},paletteSelected:function(){this.equationEditorToTextarea();var a=$("select",this.el).val();$("#equationEditor",this.el).data("toolbar",a);MapleEquationEditorOnline.removeMathEditor(this.mathEditorId);initializeEditor(this.editorDiv,!0);this.textAreaToEquationEditor();this.resizeChildren()},handleKeyUp:function(a){if(13==
a.which&&(a.ctrlKey||a.metaKey))return this.insertElement(),!1},setValue:function(a){this.surpressMathUpdate=!0;$(".mathEditorValue",this.el).val(a);this.showContentTab(a,!1);this.equationEditorVisible()?this.textAreaToEquationEditor():this.textAreaToSource();this.surpressMathUpdate=!1},navigateSourceRight:function(a){this.sourceEditor.navigateRight(a)}})});
define("common/js/views/base/sessionTimeout",["common/js/views/dialogs/alertDialog"],function(b){return Backbone.View.extend({initialize:function(){this.ahead=300;this.timedoutAlready=!1},render:function(){"number"===typeof defaultSessionTimeout&&!isNaN(defaultSessionTimeout)&&defaultSessionTimeout>this.ahead&&this.startTimer();return this},startTimer:function(){var b=this;this.warningTimeout=window.setTimeout(function(){b.showDialog()},1E3*(defaultSessionTimeout-this.ahead))},showDialog:function(){if(0<
defaultSessionTimeout){var c=this,a=new b({model:{title:sessionTimeout.warning.title,body:sessionTimeout.warning.body,done:sessionTimeout.warning.button,priority:9007199254740991},onClose:function(){c.dialogClosed()}});a.render();this.expiryTimeout=window.setTimeout(function(){a.setTitle(sessionTimeout.expired.title);a.setBody(sessionTimeout.expired.body);a.setDone(sessionTimeout.expired.button);c.timedoutAlready=!0},1E3*this.ahead)}},dialogClosed:function(){var b=this;this.timedoutAlready?anonymousUser?
location.reload(!0):window.location.href=getBaseURL()+"login":$.ajax({url:getBaseURL()+"ws/tomcatMonitor",cache:!1,dataType:"html",success:function(){b.reset()}})},reset:function(){this.timedoutAlready=!1;window.clearTimeout(this.warningTimeout);window.clearTimeout(this.expiryTimeout);this.startTimer()}})});
define("common/js/views/base/cookiesCheck",[],function(){return{check:function(){$.get(getBaseURL()+"rest/session").done(function(){"function"==typeof cookiesAvailableFunction&&cookiesAvailableFunction()}).fail(function(){$("#main").hide();window.location.replace(getBaseURL()+"static/cookiesError.do")})}}});
define("common/js/views/base/mapleTaPage",["common/js/views/base/sessionTimeout","common/js/views/base/cookiesCheck","i18n!common/js/nls/strings"],function(b,c,a){return Backbone.View.extend({events:{"click .flexListCompact .flexListItem .flexListItemToggle":"toggleFlexListItem","click .ltiClose":"closeLtiPage"},getTimeoutView:function(){return this.timeoutView},render:function(){this.timeoutView=new b;this.timeoutView.render();"undefined"!=typeof checkForCookies&&checkForCookies&&c.check();return this},
toggleFlexListItem:function(b){b=$(b.currentTarget);b.closest(".flexListItem").toggleClass("flexListItemPreview");$("i",b).hasClass("fa-expand")?($("i",b).removeClass("fa-expand").addClass("fa-compress"),b.attr("aria-label",a.systemHomepage.toggleToInstructor),b.attr("title",a.systemHomepage.toggleToInstructor)):($("i",b).removeClass("fa-compress").addClass("fa-expand"),b.attr("aria-label",a.systemHomepage.toggleToStudent),b.attr("title",a.systemHomepage.toggleToStudent))},closeLtiPage:function(){try{null!=
window.opener&&window.opener.postMessage({action:"ltiMappingReload"},"*")}catch(a){console.error(a)}isIframe()&&""!=ltiReturnUrl?window.parent.location.replace(ltiReturnUrl):window.close()}})});
define("common/js/ckutils",[],function(){return{isEmpty:function(b){return b?20<b.length?!1:(b=b.replace(/[\n|\t]*/g,"").toLowerCase())&&"\x3cbr\x3e"!=b&&"\x3cp\x3e\x26nbsp;\x3cbr\x3e\x3c/p\x3e"!=b&&"\x3cp\x3e\x3cbr\x3e\x3c/p\x3e"!=b&&"\x3cp\x3e\x26nbsp;\x3c/p\x3e"!=b&&"\x26nbsp;"!=b&&" "!=b&&"\x26nbsp;\x3cbr\x3e"!=b&&" \x3cbr\x3e"!=b?!1:!0:!0}}});define("text!common/templates/dialogs/errorDialogBody.html",[],function(){return'\x3cp\x3e\n\t\x3c%\x3d model.message %\x3e\n\x3c/p\x3e\n\x3c% if (typeof model.error !\x3d\x3d "undefined" \x26\x26 model.error.trim() !\x3d\x3d "") { %\x3e\n\t\x3ch5\x3e\n\t\t\x3c%\x3d strings.additionalInfoHeader %\x3e\n\t\x3c/h5\x3e\n\t\x3cp\x3e\n\t\t\x3c%\x3d model.error %\x3e\n\t\x3c/p\x3e\n\x3c% } %\x3e'});
define("common/js/views/dialogs/errorDialog",["common/js/views/dialogs/alertDialog","i18n!common/js/nls/strings","text!common/templates/dialogs/errorDialogBody.html"],function(b,c,a){return b.extend({initialize:function(d){"undefined"===typeof this.model.title&&(this.model.title=c.errorDialog.title);"undefined"===typeof this.model.message&&(this.model.message=c.errorDialog.message);this.model.body=_.template(a)({model:this.model,strings:c.errorDialog});b.prototype.initialize.call(this,d)}})});
define("common/js/views/dialogs/ajaxErrorDialog",["common/js/views/dialogs/errorDialog","i18n!common/js/nls/strings"],function(b,c){return b.extend({initialize:function(a){"undefined"===typeof this.model.title&&(this.model.title=c.ajaxErrorDialog.title);"undefined"===typeof this.model.message&&(this.model.message=c.ajaxErrorDialog.message);this.model.error=this.model.request.status+" "+this.model.request.statusText;b.prototype.initialize.call(this,a)}})});
define("user-tours/js/apps/userTourApp",["require","common/js/views/dialogs/ajaxErrorDialog"],function(b,c){function a(a){var b=!1;$.ajax({type:"GET",url:"rest/usertours/"+a+"/"+userTourRole+"/isCompleted",async:!1,contentType:"application/json",dataType:"json",cache:!1,error:f,success:function(a){b=a}});return b}function d(){b(["i18n!"+getClientURL("user-tours/"+userTourName+"/skins/"+userTourSkin+"/nls/strings.js"),"text!common/templates/userTourTemplate.html","i18n!common/js/nls/strings"],function(a,
b,c){var d=g();a=new Tour({name:userTourName,skin:userTourSkin,role:userTourRole,steps:getTourSteps(a,d),storage:!1,debug:!0,autoscroll:!0,keyboard:!1,orphan:!0,backdrop:!0,backdropPadding:5,template:function(a,d){return-1==d.next?_.template(b)({templateStrings:c,nextButtonClass:"hidden",endButtonClass:"btn btn-sm btn-primary",endButtonStyle:"border-radius: 3px"}):_.template(b)({templateStrings:c,nextButtonClass:"btn btn-sm btn-primary",endButtonClass:"btn btn-sm btn-default",endButtonStyle:""})},
onShown:n,onEnd:A});a.init();a.start(!0)})}function g(){var a=null;$.ajax({type:"GET",url:"rest/session/roleprivileges",async:!1,dataType:"json",contentType:"application/json",context:this,error:f,success:function(b){a=b}});return a}function n(a){X(a);p()}function p(){$(".tour").on("focus",function(){setTimeout(function(){$("#tour_area").trigger("focus")},100)});q&&"function"===typeof q.release&&q.release();q=function(a){var b=Object.assign([],document.querySelectorAll('[href], button:not([disabled]), input, select, textarea, svg, area, details, summary, iframe, object, embed, [tabindex]:not([tabindex\x3d"-1"])')).filter(function(b){return!a.some(function(a){return a.contains(b)})});
b.forEach(function(a){a.setAttribute("tabindex","-1");$(a).on("blur",function(){l()});a.blur()});return{release:function(){b.forEach(function(a){a.setAttribute("tabindex","0")})}}}(Object.assign([],document.querySelectorAll(".tour, .tour-step-backdrop")));l()}function l(){0<$(".tour").length&&setTimeout(function(){var a=document.activeElement;"tour_area"==a.id||/^step-/.test(a.id)||$(".tour").trigger("focus")},1E3)}function X(a){$("#disableUserTours").on("click",function(){a.end();$.ajax({type:"POST",
url:getBaseURL()+"rest/usertours/disable",dataType:"html",headers:{accept:"application/json; charset\x3dutf-8"}})})}function A(){$.ajax({type:"POST",url:getBaseURL()+"rest/usertours/"+this.name+"/"+this.role+"/completed",dataType:"html",headers:{accept:"application/json; charset\x3dutf-8"},error:f});q&&"function"===typeof q.release&&q.release()}function f(a){(new c({model:{request:a}})).render()}var q=null;return{initialize:function(){"undefined"===typeof userTourName||"undefined"===typeof userTourSkin||
"undefined"===typeof userTourRole||a(userTourName)||d()}}});
define("common/js/apps/mapleTaApp","require common/js/views/base/mapleTaPage common/js/ckutils common/js/views/dialogs/alertDialog common/js/views/dialogs/confirmDialog common/js/views/dialogs/errorDialog common/js/views/dialogs/ajaxErrorDialog mathEditor/js/views/mathEditorDialog common/js/views/loadingOverlay/loadingOverlay user-tours/js/apps/userTourApp".split(" "),function(b,c,a,d,g,n,p,l,X,A){return{getTimeoutView:function(){return this.pageView.getTimeoutView()},initialize:function(){window.mapleTaAppInitialized||
(this.pageView=new c({el:$("body")}),this.pageView.render(),window.CKUtils=a,window.AlertDialogView=d,window.ConfirmDialogView=g,window.ErrorDialogView=n,window.AjaxErrorDialogView=p,window.mathEditorDialog=l,window.LoadingOverlay=X,window.mapleTaAppInitialized||A.initialize(),debugDiagnostics&&console.log("MapleTaApp initialization completed."),window.mapleTaAppInitialized=!0)}}});
define("questions/html/run/js/runHtmlApp",["require"],function(b){var c=function(a){$(a).data("initialized")||(a.contentWindow.document.body.addEventListener("click",function(){$(a).trigger("questionResponse:changed")}),$(a).data("initialized",!0))};return{initialize:function(){_.each($("iframe[id^\x3dsro_container_response_]"),function(a){c(a)})}}});
define("questions/all/run/js/apps/runQuestionsApp","require questions/slideshow/run/js/app questions/list/run/js/app questions/programming/run/js/runProgrammingApp questions/all/hints/js/views/hintTable questions/sorting/run/js/app questions/html5/run/js/html5JsxGraphQuestionsApp mathEditor/js/views/mathEditorDialog common/js/apps/mapleTaApp questions/html/run/js/runHtmlApp".split(" "),function(b,c,a,d,g,n,p,l,X,A){return{initialize:function(){window.initQuestions=function(){c.initialize();a.initialize();
d.initialize();n.initialize();A.initialize();p.initialize();_.each($(".hintsTable"),function(a){$(a).data("initialized")||((new g({el:$(a)})).render(),$(a).data("initialized",!0))});"undefined"!=typeof openuw&&1==openuw&&"undefined"!=typeof setup&&playInstruction(setup.json,setup.mp3,setup.ogg,setup.quizScript)};window.mathEditorDialog=l;var b=function(){"undefined"!=typeof MathJax&&MathJax.isReady?MathJax.Hub.Queue(initQuestions):setTimeout(b,100)};b()}}});
define("assignments/all/run/js/apps/runAssignmentApp",["assignments/js/views/assignmentNavigation","questions/all/run/js/apps/runQuestionsApp","common/js/apps/mapleTaApp"],function(b,c,a){return{initialize:function(){c.initialize();a.initialize();(new b).render()}}});require.config({paths:setRequireJsPaths()});define("assignments/all/run/js/apps/runAssignmentMain",["./runAssignmentApp"],function(b){b.initialize()});define("assignment",function(){});require(["assignments/all/run/js/apps/runAssignmentMain"]);